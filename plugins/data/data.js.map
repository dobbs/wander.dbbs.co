{
  "version": 3,
  "names": [
    "summary",
    "thumbs",
    "hasProp",
    "hasOwnProperty",
    "window",
    "plugins",
    "data",
    "emit",
    "div",
    "item",
    "$",
    "addClass",
    "appendTo",
    "text",
    "html",
    "wiki",
    "resolveLinks",
    "bind",
    "average",
    "label",
    "lastThumb",
    "readout",
    "refresh",
    "value",
    "find",
    "on",
    "e",
    "offset",
    "thumb",
    "offsetX",
    "pageX",
    "left",
    "Math",
    "floor",
    "length",
    "target",
    "offsetWidth",
    "trigger",
    "dialog",
    "concat",
    "JSON",
    "stringify",
    "textEditor",
    "evt",
    "indexOf",
    "obj",
    "constructor",
    "Number",
    "String",
    "Array",
    "Object",
    "Function",
    "result",
    "values",
    "_",
    "map",
    "reject",
    "isNaN",
    "reduce",
    "m",
    "n",
    "toFixed",
    "field",
    "columns",
    "object",
    "nodes",
    "links",
    "key",
    "ref",
    "results"
  ],
  "sources": [
    "data.coffee"
  ],
  "sourcesContent": [
    "###\n * Federated Wiki : Data Plugin\n *\n * Licensed under the MIT license.\n * https://github.com/fedwiki/wiki-plugin-data/blob/master/LICENSE.txt\n###\n\n# lots of cases, ward will try these\n# http://nmsi.localhost:1111/view/cotton-in-the-field/view/tier-1-material-summary/cotton.localhost:1111/talk-about-wool/view/cotton-fabric\n\nwindow.plugins.data =\n  emit: (div, item) ->\n    $('<p />').addClass('readout').appendTo(div).text(summary(item))\n    $('<p />').addClass('label').appendTo(div).html(wiki.resolveLinks(item.text||'data'))\n  bind: (div, item) ->\n    lastThumb = null\n    div.find('.readout')\n      .on 'mousemove', (e) ->\n        if (e.offsetX == undefined)\n          offset = e.pageX - $(this).offset().left\n        else\n          offset = e.offsetX\n        thumb = thumbs(item)[Math.floor(thumbs(item).length * offset / e.target.offsetWidth)]\n        return if thumb == lastThumb || null == (lastThumb = thumb)\n        refresh thumb\n        $(div).trigger('thumb', thumb)\n      .on 'dblclick', (e) ->\n        wiki.dialog \"JSON for #{item.text}\",  $('<pre/>').text(JSON.stringify(item, null, 2))\n    div.find('.label')\n      .on 'dblclick', () ->\n        wiki.textEditor div, item\n    $(\".main\").on 'thumb', (evt, thumb) ->\n      refresh thumb unless thumb == lastThumb || -1 == (thumbs(item).indexOf thumb)\n\n    value = (obj) ->\n      return NaN unless obj?\n      switch obj.constructor\n        when Number then obj\n        when String then +obj\n        when Array then value(obj[0])\n        when Object then value(obj.value)\n        when Function then obj()\n        else NaN\n\n    average = (thumb) ->\n      values = _.map(item.data, (obj) -> value(obj[thumb]))\n      values = _.reject(values, (obj) -> isNaN obj)\n      result = _.reduce(values, ((m,n) -> m+n), 0) / values.length\n      result.toFixed 2\n\n    readout = (thumb) ->\n      return average(thumb) if item.columns?\n      return summary(item) unless item.data.object?\n      field = item.data[thumb]\n      return \"#{field.value}\" if field.value?\n      return \"#{field.toFixed 2}\" if field.constructor == Number\n      NaN\n\n    label = (thumb) ->\n      return \"Averaged:<br>#{thumb}\" if item.columns? && item.data.length > 1\n      thumb\n\n    refresh = (thumb) ->\n      div.find('.readout').text readout(thumb)\n      div.find('.label').html label(thumb)\n\nsummary = (item) ->\n  return \"#{item.data.length}x#{item.columns.length}\" if item.columns?\n  return \"#{item.data.nodes.length}/#{item.data.links.length}\" if item.data? && item.data.nodes? && item.data.links?\n  return \"1x#{thumbs(item).length}\"\n  \"data\"\n\nthumbs = (item) ->\n  return item.columns if item.columns?\n  (key for own key of item.data)\n"
  ],
  "mappings": "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"
}