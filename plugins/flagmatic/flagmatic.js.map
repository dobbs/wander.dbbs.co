{
  "version": 3,
  "names": [
    "bind",
    "delay",
    "emit",
    "hsltorgb",
    "paint",
    "h",
    "s",
    "l",
    "hue",
    "m1",
    "m2",
    "num",
    "canvas",
    "angle",
    "colprep",
    "cos",
    "ctx",
    "dark",
    "i",
    "light",
    "p",
    "results",
    "scale",
    "sin",
    "x",
    "y",
    "getContext",
    "Math",
    "random",
    "abs",
    "col",
    "floor",
    "results1",
    "j",
    "fillStyle",
    "concat",
    "fillRect",
    "msec",
    "done",
    "setTimeout",
    "$item",
    "item",
    "$flag",
    "$flags",
    "ref",
    "append",
    "find",
    "choices",
    "$",
    "get",
    "on",
    "ajax",
    "data",
    "toDataURL",
    "post",
    "image",
    "reply",
    "text",
    "fail",
    "window",
    "plugins",
    "flagmatic",
    "module",
    "exports"
  ],
  "sources": [
    "flagmatic.coffee"
  ],
  "sourcesContent": [
    "###\n * Federated Wiki : Flagmatic Plugin\n *\n * Copyright Ward Cunningham and other contributors\n * Licensed under the MIT license.\n * https://github.com/fedwiki/wiki-plugin-flagmatic/blob/master/LICENSE.txt\n###\n\n# The Flagmatic plugin offers a choice of new flags\n# item.choices selects how may, 40 by default\n\nhsltorgb = (h, s, l) ->\n  h = (h % 360) / 360\n  m2 = l * (s + 1)\n  m1 = ((l * 2) - m2)\n  hue = (num) ->\n    if num < 0\n      num += 1\n    else if num > 1\n      num -= 1\n    if (num * 6) < 1\n      m1 + (m2 - m1) * num * 6\n    else if (num * 2) < 1\n      m2\n    else if (num * 3) < 2\n      m1 + (m2 - m1) * (2/3 - num) * 6\n    else\n      m1\n  [(hue(h+1/3)*255), (hue(h) * 255), (hue(h - 1/3) * 255)]\n\npaint = (canvas) ->\n  ctx = canvas.getContext('2d')\n  light = hsltorgb(Math.random() * 360, .78, .4)\n  dark = hsltorgb(Math.random() * 360, .78, .55)\n  angle = 2 * (Math.random() - 0.5)\n  sin = Math.sin angle\n  cos = Math.cos angle\n  scale = (Math.abs(sin) + Math.abs(cos))\n  colprep = (col, p) ->\n    Math.floor(light[col]*p + dark[col]*(1-p))%255\n  for x in [0..31]\n    for y in [0..31]\n      p = if sin >= 0 then sin * x + cos * y else -sin * (31 - x) + cos * y\n      p = p / 31 / scale\n      ctx.fillStyle = \"rgba(#{colprep(0, p)}, #{colprep(1, p)}, #{colprep(2, p)}, 1)\"\n      ctx.fillRect(x, y, 1, 1)\n\ndelay = (msec, done) ->\n  setTimeout done, msec\n\nemit = ($item, item) ->\n  $item.append \"\"\"\n    <div style=\"width:93%; background:#eee; padding:.8em; margin-bottom:5px; text-align: center;\">\n      <span class=\"flags\"></span>\n      <p class=\"caption\">choose a new flag</p>\n    </div>\n  \"\"\"\n  $flags = $item.find '.flags'\n  for [1..item.choices || 40]\n    $flags.append $flag = $ '<canvas width=32 height=32 style=\"padding: 3px;\"/>'\n    paint $flag.get(0)\n\nbind = ($item, item) ->\n  $item.find('canvas').on 'click', () ->\n    data = this.toDataURL()\n    ajax = $.post '/favicon.png', {image: data}, (reply) ->\n    ajax.done ->\n      $item.find('.caption').text 'sweet'\n    ajax.fail ->\n      $item.find('.caption').text 'ouch, logged in?'\n    delay 1500, ->\n      $item.find('.caption').text 'choose another flag'\n\n\nwindow.plugins.flagmatic = {emit, bind} if window?\nmodule.exports = {} if module?\n"
  ],
  "mappings": "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"
}