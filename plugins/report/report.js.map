{
  "version": 3,
  "names": [
    "advance",
    "bind",
    "emit",
    "enumerate",
    "explain",
    "hours",
    "human",
    "intervals",
    "months",
    "parse",
    "primAdvance",
    "soon",
    "summarize",
    "wdays",
    "i",
    "j",
    "k",
    "len",
    "obj",
    "_len",
    "arguments",
    "length",
    "keys",
    "Array",
    "_key",
    "text",
    "e",
    "issue",
    "ref",
    "schedule",
    "word",
    "match",
    "push",
    "interval",
    "recipients",
    "offsets",
    "trouble",
    "error",
    "message",
    "msecs",
    "days",
    "hrs",
    "mins",
    "secs",
    "weeks",
    "years",
    "concat",
    "Math",
    "floor",
    "date",
    "count",
    "d",
    "h",
    "m",
    "offset",
    "result",
    "y",
    "_ref",
    "getFullYear",
    "getMonth",
    "getDate",
    "getHours",
    "Date",
    "getDay",
    "_ref2",
    "prim",
    "next",
    "now",
    "getTime",
    "module",
    "exports",
    "results",
    "join",
    "$item",
    "item",
    "append",
    "$",
    "on",
    "wiki",
    "textEditor",
    "window",
    "plugins",
    "report"
  ],
  "sources": [
    "report.coffee"
  ],
  "sourcesContent": [
    "###\n * Federated Wiki : Report Plugin\n *\n * Licensed under the MIT license.\n * https://github.com/fedwiki/wiki-plugin-report/blob/master/LICENSE.txt\n###\n\nenumerate = (keys...) ->\n\tobj = {keys}\n\tobj[k] = i+1 for k,i in keys\n\tobj\n\nintervals = enumerate 'HOURLY','DAILY','WEEKLY','MONTHLY','YEARLY'\nhours = enumerate 'MIDNIGHT','MORNING','NOON','EVENING'\nwdays = enumerate 'SUNDAY','MONDAY','TUESDAY','WEDNESDAY','THURSDAY','FRIDAY','SATURDAY'\nmonths = enumerate 'JANUARY','FEBUARY','MARCH','APRIL','MAY','JUNE','JULY','AUGUST','SEPTEMBER','OCTOBER','NOVEMBER','DECEMBER'\n\nparse = (text) ->\n  schedule = []\n  issue = null\n  for word in text.match(/\\S+/g) or []\n    try\n      if intervals[word]\n        schedule.push issue =\n          interval: word\n          recipients: []\n          offsets: []\n      else if months[word] or wdays[word] or hours[word]\n        issue.offsets.push word\n      else if word.match /@/\n        issue.recipients.push word\n      else\n        schedule.push {trouble: word}\n    catch e\n      schedule.push {trouble: e.message}\n  schedule\n\nhuman = (msecs) ->\n  return \"#{Math.floor msecs} milliseconds\" if (secs = msecs/1000) < 2\n  return \"#{Math.floor secs} seconds\" if (mins = secs/60) < 2\n  return \"#{Math.floor mins} minutes\" if (hrs = mins/60) < 2\n  return \"#{Math.floor hrs} hours\" if (days = hrs/24) < 2\n  return \"#{Math.floor days} days\" if (weeks = days/7) < 2\n  return \"#{Math.floor weeks} weeks\" if (months = days/30.5) < 2\n  return \"#{Math.floor months} months\" if (years = days/365) < 2\n  return \"#{Math.floor years} years\"\n\n\nprimAdvance = (date, issue, count) ->\n\t[y, m, d, h] = [date.getFullYear(), date.getMonth(), date.getDate(), date.getHours()]\n\tresult = switch issue.interval\n\t\twhen 'HOURLY'  then new Date y, m, d, h+count\n\t\twhen 'DAILY'   then new Date y, m, d+count\n\t\twhen 'WEEKLY'  then new Date y, m, d-date.getDay()+7*count\n\t\twhen 'MONTHLY' then new Date y, m+count\n\t\twhen 'YEARLY'  then new Date y+count, 0\n\tfor offset in issue.offsets\n\t\t[y, m, d, h] = [result.getFullYear(), result.getMonth(), result.getDate(), result.getHours()]\n\t\tresult = if months[offset]\n\t\t\tnew Date y, months[offset]-1, d, h\n\t\telse if wdays[offset]\n\t\t\tnew Date y, m, d+(7-result.getDay()+wdays[offset]-1)%7, h\n\t\telse if hours[offset]\n\t\t\tnew Date y, m, d, h+6*(hours[offset]-1)\n\tresult\n\nadvance = (date, issue, count) ->\n\tprim = primAdvance date, issue, 0\n\tif prim > date\n\t\tprimAdvance date, issue, count-1 # when offset passes date\n\telse\n\t\tprimAdvance date, issue, count\n\nsoon = (issue) ->\n\tnow = new Date();\n\tnext = advance now, issue, 1\n\thuman next.getTime() - now.getTime()\n\nexplain = (issue) ->\n\tif issue.interval?\n\t\t\"reporting #{issue.interval} for #{issue.recipients.length} recipients in #{soon issue}\"\n\telse if issue.trouble?\n\t\t\"don't expect: <span class=error>#{issue.trouble}</span>\"\n\telse\n\t\t\"trouble\"\n\nmodule.exports = {intervals, parse, explain, advance} if module?\n\nsummarize = (schedule) ->\n\t(explain issue for issue in schedule).join \"<br>\"\n\nemit = ($item, item) ->\n\t$item.append $ \"\"\"\n\t\t<p>#{summarize parse item.text}</p>\n\t\"\"\"\n\nbind = ($item, item) ->\n\t$item.on 'dblclick', () -> wiki.textEditor $item, item\n\nwindow.plugins.report = {emit, bind} if window?\n"
  ],
  "mappings": "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"
}