/*! wiki-client - v0.23.4 - 2022-04-19
 * Copyright 2022 Ward Cunningham and other contributors;
 * Released under the MIT license */
!function r(o,i,a){function u(t,e){if(!i[t]){if(!o[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(s)return s(t,!0);throw(e=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",e}n=i[t]={exports:{}},o[t][0].call(n.exports,function(e){return u(o[t][1][e]||e)},n,n.exports,r,o,i,a)}return i[t].exports}for(var s="function"==typeof require&&require,e=0;e<a.length;e++)u(a[e]);return u}({1:[function(e,t,n){"use strict";console.log("Window Name: "+window.name),window.name=window.location.host,window.wiki=e("./lib/wiki"),e("./lib/legacy"),e("./lib/bind"),e("./lib/plugins")},{"./lib/bind":5,"./lib/legacy":14,"./lib/plugins":24,"./lib/wiki":38}],2:[function(e,t,n){"use strict";var r={create:"☼",add:"+",edit:"✎",fork:"⚑",move:"↕",remove:"✕"};t.exports={symbols:r,fork:r.fork,add:r.add}},{}],3:[function(e,t,n){"use strict";var s,c,r;t.exports=s={},s.scrollContainer=void 0,c=function(){var e=$("body, html").filter(function(){return 0<$(this).scrollLeft()});return 0<e.length?e:$("body, html").scrollLeft(12).filter(function(){return 0<$(this).scrollLeft()}).scrollTop(0)},r=function(e){var t,n,r,o,i,a,u;if(null!=e.position())return null==s.scrollContainer&&(s.scrollContainer=c()),t=$("body").width(),r=(o=s.scrollContainer.scrollLeft())+t,a=e.position().left,u=e.outerWidth(!0),n=$(".page").outerWidth(!0)*$(".page").length,a<o?i=a:r<a+u?i=a-(t-u):r>$(".pages").outerWidth()&&(i=Math.min(a,n-t)),s.scrollContainer.animate({scrollLeft:i},function(){if(!$.contains(e[0],document.activeElement))return e.focus()})},s.set=function(e,t){if($(".incremental-search").remove(),e=$(e),$(".active").removeClass("active"),e.addClass("active"),!t)return r(e)}},{}],4:[function(e,t,n){"use strict";var i=e("./util"),a=e("./actionSymbols");t.exports=function(e,t){var n,r=e.parents(".page:first"),o="";if(null!=t.site&&(o+="".concat(t.site,"\n")),o+=t.type||"separator",null!=t.date&&(o+=" ".concat(i.formatElapsedTime(t.date))),o=$('<a href="#" /> ').addClass("action").addClass(t.type||"separator").text(t.symbol||a.symbols[t.type]).attr("title",o).attr("data-id",t.id||"0").data("action",t),0<(n=e.children(".control-buttons")).length?o.insertBefore(n):o.appendTo(e),"fork"===t.type&&null!=t.site)return o.css("background-image","url(".concat(wiki.site(t.site).flag())).attr("href","".concat(wiki.site(t.site).getDirectURL(r.attr("id")),".html")).attr("target","".concat(t.site)).data("site",t.site).data("slug",r.attr("id"))}},{"./actionSymbols":2,"./util":37}],5:[function(e,t,n){"use strict";var r=e("./neighborhood"),o=e("./neighbors"),i=e("./searchbox"),a=e("./state"),u=e("./link");$(function(){return i.inject(r),i.bind(),o.inject(r),o.bind(),window.seedNeighbors&&seedNeighbors.split(",").forEach(function(e){return r.registerNeighbor(e.trim())}),a.inject(u)})},{"./link":17,"./neighborhood":18,"./neighbors":19,"./searchbox":31,"./state":34}],6:[function(e,t,n){"use strict";var r=e("./resolve"),o=null;t.exports={emit:function(){return o=$("<div></div>").html("This dialog will show every time!").dialog({autoOpen:!1,title:"Basic Dialog",height:600,width:800})},open:function(e,t){return o.html(t),o.dialog("option","title",r.resolveLinks(e)),o.dialog("open")}}},{"./resolve":28}],7:[function(e,t,n){"use strict";function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,u=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){u=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(u)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(n="Object"===n&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var i=[].indexOf,a=e("url"),u=function(e){return null!=(e=e.originalEvent.dataTransfer)&&0<=i.call(e.types,"Files")?e.files[0]:null},s=function(e){return null!=(e=e.originalEvent.dataTransfer)&&null!=e.types&&(0<=i.call(e.types,"text/uri-list")||0<=i.call(e.types,"text/x-moz-url"))&&null!=(e=e.getData("URL"))&&e.length?e:null},c=function(e){var t,n;return(e=e.match(/^https?:\/\/([a-zA-Z0-9:.-]+)(\/([a-zA-Z0-9:.-]+)\/([a-z0-9-]+(_rev\d+)?))+$/))?(t={},(e=r(e,6))[0],n=e[1],e[2],t.site=e[3],t.slug=e[4],e[5],"view"!==(e=t.site)&&"local"!==e&&"origin"!==e||(t.site=n),t):null},l=function(e){return a.parse(e,!0,!0).pathname.match(/\.(jpg|jpeg|png|svg)$/i)?e:null},f=function(e){var t=a.parse(e,!0,!0);try{"video"===t.query.source&&(t=a.parse(t.query.url,!0,!0))}catch(e){0}switch(t.hostname){case"www.youtube.com":return null!=t.query.list?{text:"YOUTUBE PLAYLIST ".concat(t.query.list)}:{text:"YOUTUBE ".concat(t.query.v)};case"youtu.be":return null!=t.query.list?{text:"YOUTUBE PLAYLIST ".concat(t.query.list)}:{text:"YOUTUBE ".concat(t.pathname.substr(1))};case"vimeo.com":return{text:"VIMEO ".concat(t.pathname.substr(1))};case"archive.org":return{text:"ARCHIVE ".concat(t.pathname.substr(t.pathname.lastIndexOf("/")+1))};case"tedxtalks.ted.com":return{text:"TEDX ".concat(t.pathname.substr(t.pathname.lastIndexOf("/")+1))};case"www.ted.com":return{text:"TED ".concat(t.pathname.substr(t.pathname.lastIndexOf("/")+1))};default:return null}};t.exports={dispatch:function(i){return function(t){var e,n,r,o=function(e){return t.preventDefault(),t.stopPropagation()};if(n=s(t)){if((r=c(n))&&null!=(e=i.page))return o(e(r));if((r=f(n))&&null!=(e=i.video))return o(e(r));if((r=l(n))&&null!=(e=i.image))return o(e(r));r={url:n}}if(n=u(t)){if(null!=(e=i.file))return o(e(n));r={file:n}}if(null!=(e=i.punt))return o(e(r=r||{dt:t.dataTransfer,types:null!=(n=t.dataTransfer)?n.types:void 0}))}}}},{url:54}],8:[function(e,t,n){"use strict";var o=e("./plugin"),f=e("./itemz"),i=e("./pageHandler"),d=e("./link"),a=e("./random"),h=function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},p=function(a,u){var s,c,e,t,n,r,l=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};if(console.log("textEditor",u.id,l),"markdown"===u.type&&(c=0),$(".editEnable").is(":visible")&&(t=function(e){var t,n,r,o,i;return 27===e.which||(e.ctrlKey||e.metaKey)&&83===e.which?(e.preventDefault(),s.focusout(),!1):(e.ctrlKey||e.metaKey)&&73===e.which?(e.preventDefault(),e.shiftKey||(r=$(e.target).parents(".page")),d.doInternalLink("about ".concat(u.type," plugin"),r),!1):(e.ctrlKey||e.metaKey)&&77===e.which?(e.preventDefault(),a.removeClass(u.type).addClass(u.type="factory"),s.focusout(),!1):"paragraph"===u.type||"markdown"===u.type?(r=v(s),e.which===$.ui.keyCode.BACKSPACE&&0===r.start&&r.start===r.end?(t=a.prev(),(i=f.getItem(t)).type!==u.type||(n=i[l.field||"text"].length,o=s.val(),s.val(""),p(t,i,{caret:n,suffix:o})),!1):e.which===$.ui.keyCode.ENTER?!!r&&("markdown"===u.type&&c++,"paragraph"===u.type||"markdown"===u.type&&2===c?(t=a.parents(".page"),n=(i=s.val()).substring(0,r.start),o=i.substring(r.end),""===n?(s.val(o),s.focusout(),g(t,a.prev(),u.type,n)):(s.val(n),s.focusout(),g(t,a,u.type,o)),!1):void 0):"markdown"===u.type?c=0:void 0):void 0},e=function(){var e;if(a.removeClass("textEditing"),s.unbind(),e=a.parents(".page:first"),u[l.field||"text"]=s.val())if(a.removeClass("output-item"),a.removeClass(function(e,t){return(t.match(/\S+-source/)||[]).join(" ")}),o.do(a.empty(),u),l.after){if(""===u[l.field||"text"])return;i.put(e,{type:"add",id:u.id,item:u,after:l.after})}else{if(u[l.field||"text"]===n)return;i.put(e,{type:"edit",id:u.id,item:u})}else l.after||i.put(e,{type:"remove",id:u.id}),e=$(".item").index(a),a.remove(),o.renderFrom(e);return null},!a.hasClass("textEditing")))return a.addClass("textEditing"),a.unbind(),n=null!=(r=u[l.field||"text"])?r:"",s=$("<textarea>".concat(h(n)).concat(h(null!=(r=l.suffix)?r:""),"</textarea>")).focusout(e).bind("keydown",t),a.html(s),l.caret?m(s,l.caret):l.append?(m(s,s.val().length),s.scrollTop(s[0].scrollHeight-s.height())):s.focus()},g=function(e,t,n,r){n={type:n,id:a.itemId(),text:r},r=$('<div class="item '.concat(n.type,'" data-id=').concat(n.id,"></div>"));return r.data("item",n).data("pageElement",e),t.after(r),e=f.getItem(t),p(r,n,{after:null!=e?e.id:void 0})},v=function(e){var t,e=e.get(0);return document.selection?(e.focus(),(t=document.selection.createRange()).moveStart("character",-e.value.length),{start:t=t.text.length,end:t}):{start:e.selectionStart,end:e.selectionEnd}},m=function(e,t){var n,e=e.get(0);if(null!=e)return e.createTextRange?((n=e.createTextRange()).move("character",t),n.select()):e.setSelectionRange(t,t),e.focus()};t.exports={textEditor:p}},{"./itemz":13,"./link":17,"./pageHandler":21,"./plugin":23,"./random":25}],9:[function(e,t,n){"use strict";function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,u=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){u=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(u)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(n="Object"===n&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var c=e("./neighborhood"),l=e("./plugin"),o=e("./resolve"),f=e("./pageHandler"),d=e("./editor"),h=e("./synopsis"),p=e("./drop"),g=e("./active"),i=function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br>")},v=function(e,t){var n,r,o,i;for(t=t||",",o=new RegExp("(\\"+t+'|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\'+t+"\\r\\n]*))","gi"),n=[[]],r=null;r=o.exec(e);)(i=r[1]).length&&i!==t&&n.push([]),i=r[2]?r[2].replace(new RegExp('""',"g"),'"'):r[3],n[n.length-1].push(i);return n},m=function(e){for(var t,u=e.shift(),n=function(e){for(var t={},n=_.zip(u,e),r=0,o=n.length;r<o;r++){var i=s(n[r],2),a=i[0];null!=(i=i[1])&&i.match(/\S/)&&"NULL"!==i&&(t[a]=i)}return t},r=[],o=0,i=e.length;o<i;o++)t=e[o],r.push(n(t));return r},y=function(e){var n=function(e){var t="";return[].slice.call(new Uint8Array(e)).forEach(function(e){return t+=String.fromCharCode(e)}),window.btoa(t)};return fetch(e).then(function(e){if(e.ok)return e;throw new Error("Unable to fetch image")}).then(function(e){return e.arrayBuffer().then(function(e){var t="data:image/jpeg;base64,";return t+=n(e)})}).catch(function(e){return console.log("Unable to fetch remote image")})},b=function(r){var o=new Image,i=void 0,a=void 0,u=function(e){return e.width<=500||e.height<=300};return new Promise(function(e){return o.src=r,o.onload=function(){return e()}}).then(function(){return i=o.naturalWidth,a=o.naturalHeight}).then(function(){var e,t;if(!u(o))return t=Math.max(1,Math.min(i/500,a/300)),e=Math.floor(Math.log2(t)),t=t/Math.pow(2,e),i=Math.round(i/t),a=Math.round(a/t)}).then(function(){return new Promise(function(t){var n=new Image;return n.src=o.src,n.onload=function(){var e;return u(n)?t(r):((e=document.createElement("canvas")).width=i,e.height=a,e.getContext("2d").drawImage(n,0,0,i,a),r=e.toDataURL("image/jpeg",.5),i/=2,a/=2,n.src=r)}})}).then(function(){return r})};t.exports={emit:function(a,u){var n;return a.append("<p>Double-Click to Edit<br>Drop Text or Image to Insert</p>"),n=function(){for(var e,t,n=a.find("p").append('<br>Or Choose a Plugin\n<center>\n<table style="text-align:left;">\n<tr><td><ul id=format><td><ul id=data><td><ul id=other>'),r=window.catalog,o=0,i=r.length;o<i;o++)(t=r[o])&&t.category&&("format"!==(e=t.category)&&"data"!==e&&(e="other"),n.find("#"+e).append('<li><a class="menu" href="#" title="'.concat(t.title,'">').concat(t.name,"</a></li>")));return n.find("a.menu").click(function(t){var n=t.target.text,e=n.toLowerCase();if(a.removeClass("factory").addClass(u.type=e),a.unbind(),t.preventDefault(),g.set(a.parents(".page")),!window.catalog.find(function(e){return n===e.name}).editor)return d.textEditor(a,u);try{return window.plugins[e].editor(a,u)}catch(e){return t=e,console.log("".concat(n," Plugin editor failed: ").concat(t,". Falling back to textEditor")),d.textEditor(a,u)}})},u.prompt?function(){return a.append("<p>".concat(o.resolveLinks(u.prompt,i),"</b>"))}():null!=window.catalog?n():wiki.origin.get("system/factories.json",function(e,t){return console.log("factory",t),window.catalog=t,n()})},bind:function(t,o){var i=function(){var e;t.empty().unbind(),t.removeClass("factory").addClass(o.type),e=t.parents(".page:first");try{t.data("pageElement",e),t.data("item",o),l.getPlugin(o.type,function(e){return e.emit(t,o),e.bind(t,o)})}catch(e){t.append("<p class='error'>".concat(e,"</p>"))}return f.put(e,{type:"edit",id:o.id,item:o})},a=function(e){return o.prompt="Unexpected Item\nWe can't make sense of the drop.\nTry something else or see [[About Factory Plugin]].",e.userAgent=navigator.userAgent,o.punt=e,i()},e=function(n){return wiki.site(n.site).get("".concat(n.slug,".json"),function(e,t){if(!e&&(o.type="reference",o.site=n.site,o.slug=n.slug,o.title=t.title||n.slug,o.text=h(t),i(),null!=o.site))return c.registerNeighbor(o.site)})},n=function(e){return o.type="video",o.text="".concat(e.text,"\n(double-click to edit caption)\n"),i()},r=function(t){return document.documentElement.style.cursor="wait",y(t).then(function(e){return b(e)}).then(function(e){return document.documentElement.style.cursor="default",o.type="image",o.url=e,o.source=t,o.caption||(o.caption="Remote image"),i()})},u=function(n){var e,r,t;if(null!=n)return e=(t=s(n.type.split("/"),2))[0],r=t[1],t=new FileReader,"image"===e?(t.onload=function(e){return b(e.target.result).then(function(e){return o.type="image",o.url=e,o.caption||(o.caption="Uploaded image"),i()})},t.readAsDataURL(n)):"text"===e?(t.onload=function(e){var t,e=e.target.result;return"csv"===r?(o.type="data",o.columns=(t=v(e))[0],o.data=m(t),o.text=n.fileName):(o.type="paragraph",o.text=e),i()},t.readAsText(n)):a({name:n.name,type:n.type,size:n.size,fileName:n.fileName,lastModified:n.lastModified})};return t.dblclick(function(e){return e.shiftKey?d.textEditor(t,o,{field:"prompt"}):(t.removeClass("factory").addClass(o.type="paragraph"),t.unbind(),d.textEditor(t,o))}),t.bind("dragenter",function(e){return e.preventDefault()}),t.bind("dragover",function(e){return e.preventDefault()}),t.bind("drop",p.dispatch({page:e,file:u,video:n,image:r,punt:a}))}}},{"./active":3,"./drop":7,"./editor":8,"./neighborhood":18,"./pageHandler":21,"./plugin":23,"./resolve":28,"./synopsis":35}],10:[function(e,t,n){"use strict";var u=e("./resolve"),s=e("./neighborhood"),i=e("./lineup"),a=e("./refresh");t.exports={emit:function(e,t){var n,r,o,i,a;if(e.append("".concat(t.text,'<br><br><button class="create">create</button> new blank page')),(a=null!=(a=t.create)&&null!=(a=a.source)?a.transport:void 0)&&(e.append('<br><button class="transport" data-slug='.concat(t.slug,">create</button> transport from ").concat(a)),e.append("<p class=caption> unavailable</p>"),$.get("//localhost:4020",function(){return e.find(".caption").text("ready")})),null!=(a=s.sites[location.host])&&null!=a.sitemap){for(i=[],n=0,r=(o=a.sitemap).length;n<r;n++)(t=o[n]).slug.match(/-template$/)?i.push(e.append('<br><button class="create" data-slug='.concat(t.slug,">create</button> from ").concat(u.resolveLinks("[[".concat(t.title,"]]"))))):i.push(void 0);return i}},bind:function(o,n){return o.find("button.transport").click(function(e){var t;return o.find(".caption").text("waiting"),t={title:o.parents(".page").data("data").title,create:n.create},t={type:"POST",url:n.create.source.transport,dataType:"json",contentType:"application/json",data:JSON.stringify(t)},$.ajax(t).done(function(e){var t,n,r;return o.find(".caption").text("ready"),r=wiki.newPage(e),t=o.parents(".page"),(n=i.atKey(t.data("key"))).become(r,r),e=n.getRawPage(),a.rebuildPage(n,t.empty())})})}}},{"./lineup":16,"./neighborhood":18,"./refresh":27,"./resolve":28}],11:[function(e,t,n){"use strict";var r=e("./dialog"),o=e("./editor"),i=e("./resolve"),a=!1,u=!1,s=function(){return u=!0,$.ajax("".concat("http://127.0.0.1:8080","/ipfs/Qmb1oS3TaS8vekxXqogoYsixe47sXcVxQ22kPWH8VSd7yQ"),{timeout:3e4,success:function(e){return a="wiki\n"===e},complete:function(e,t){return console.log("ipfs gateway ".concat(t))}})};t.exports={emit:function(e,t){return t.text||(t.text=t.caption),e.append('<img class=thumbnail src="'.concat(t.url,'"> <p>').concat(i.resolveLinks(t.text),"</p>"))},bind:function(e,t){return e.dblclick(function(){return o.textEditor(e,t)}),t.ipfs&&!u&&s(),e.find("img").dblclick(function(e){return e.stopPropagation(),e=a&&null!=t.ipfs?"".concat(gateway,"/ipfs/").concat(t.ipfs):null!=t.source?t.source:t.url,r.open(t.text,'<img style="width:100%" src="'.concat(e,'">'))})}}},{"./dialog":6,"./editor":8,"./resolve":28}],12:[function(e,t,n){"use strict";var a=e("./util"),o=e("./link"),i=e("./page").newPage,u=function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")};t.exports={emit:function(e,t){return e.append('<p style="background-color:#eee;padding:15px;">\n  '.concat(function(e){var t,n,r,o,i=[];for(o in e)r=e[o],n="<a href=".concat(o,">").concat(u(r.title)||o,"</a>"),r.journal&&((t=r.journal[r.journal.length-1].date)?n+=" &nbsp; from ".concat(a.formatElapsedTime(t)):n+=" &nbsp; from revision ".concat(r.journal.length-1)),i.push(n);return i.join("<br>")}(t.pages),"\n</p>"))},bind:function(e,r){return e.find("a").click(function(e){var t,n=$(e.target).attr("href");return e.shiftKey||(t=$(e.target).parents(".page")),e=i(r.pages[n]),o.showResult(e,{$page:t,rev:e.getRevision()}),!1})}}},{"./link":17,"./page":20,"./util":37}],13:[function(e,t,n){"use strict";var i=e("./pageHandler"),a=e("./plugin"),u=e("./random"),s=function(e,t){return setTimeout(t,e)},c=function(e){if(0<$(e).length)return $(e).data("item")||$(e).data("staticItem")};t.exports={createItem:function(e,t,n){var r,o;return null==e&&(e=t.parents(".page")),n.id=u.itemId(),(r=$('<div class="item '.concat(n.type,'" data-id=""</div>'))).data("item",n).data("pageElement",e),null!=t?t.after(r):e.find(".story").append(r),a.do(r,n),o=c(t),s(500,function(){return i.put(e,{item:n,id:n.id,type:"add",after:null!=o?o.id:void 0})}),r},removeItem:function(e,t){return i.put(e.parents(".page:first"),{type:"remove",id:t.id}),e.remove()},getItem:c,replaceItem:function(t,e,n){var r=$.extend({},n);t.empty().unbind(),t.removeClass(e).addClass(r.type),e=t.parents(".page:first");try{t.data("pageElement",e),t.data("item",r),a.getPlugin(n.type,function(e){return e.emit(t,r),e.bind(t,r)})}catch(e){t.append("<p class='error'>".concat(e,"</p>"))}return i.put(e,{type:"edit",id:r.id,item:r})}}},{"./pageHandler":21,"./plugin":23,"./random":25}],14:[function(e,t,n){"use strict";var s=e("./pageHandler"),c=e("./state"),f=e("./active"),d=e("./refresh"),h=e("./lineup"),o=e("./drop"),p=e("./dialog"),g=e("./link"),v=e("./target"),m=e("./license"),y=e("./plugin"),b=e("./page").asSlug,w=e("./page").newPage,r=function(e){return e.filter(function(e){return e.editor}).forEach(function(t){return console.log("".concat(t.name," Plugin declares an editor, so pre-loading the plugin")),wiki.getPlugin(t.name.toLowerCase(),function(e){if(!e.editor||"function"!=typeof e.editor)return console.log("".concat(t.name,' Plugin ERROR.\nCannot find `editor` function in plugin. Set `"editor": false` in factory.json or\nCorrect the plugin to include all three of `{emit, bind, editor}`'))})})};wiki.origin.get("system/factories.json",function(e,t){return window.catalog=t,r(t)}),$(function(){var i,r,a,l,e,u,t;return p.emit(),$(document).keydown(function(e){var t,n=function(){switch(e.which){case 37:return-1;case 39:return 1}}();if(n&&!$(e.target).is(":input")&&0<=(n=(t=$(".page")).index($(".active"))+n)&&n<t.length&&f.set(t.eq(n)),(e.ctrlKey||e.metaKey)&&83===e.which)return e.preventDefault(),$("input.search").focus()}),$(window).on("popstate",c.show),$(document).ajaxError(function(e,t,n){if(0!==t.status&&404!==t.status)return console.log("ajax error",e,t,n)}),i=function(e){return"".concat(e).replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")},t=function(o){var e;if("application/json"===(null!=o?o.type:void 0))return(e=new FileReader).onload=function(e){var t,n,e=e.target.result,e=JSON.parse(e),r=w();return r.setTitle("Import from ".concat(o.name)),null!=e.title&&null!=e.story&&null!=e.journal?(n=b(e.title),t=e,(e={})[n]=t,r.addParagraph("Import of one page\n(".concat(i(o.size)," bytes)\nfrom a page-json file dated ").concat(o.lastModifiedDate,"."))):r.addParagraph("Import of ".concat(Object.keys(e).length," pages\n(").concat(i(o.size)," bytes)\nfrom an export file dated ").concat(o.lastModifiedDate,".")),r.addItem({type:"importer",pages:e}),g.showResult(r)},e.readAsText(o)},r=function(t,n){return console.log("fork to delete"),s.delete(t,n,function(e){if(null==e)return console.log("server delete successful"),t.isRecycler()||(e=d.newFuturePage(t.getTitle(),t.getCreate()),t.become(e),n.attr("id",e.getSlug()),d.rebuildPage(t,n)),n.addClass("ghost")})},e=function(e,n){return e?(console.log("getTemplate",e),s.get({whenGotten:function(e,t){return n(e)},whenNotGotten:function(){return n(null)},pageInformation:{slug:e}})):n(null)},a=function(e,t){var n;return e.preventDefault(),e.shiftKey||(n=$(e.target).parents(".page")),g.doInternalLink(t,n,$(e.target).data("site")),!1},u=null,$(".main").sortable({handle:".page-handle",cursor:"grabbing"}).on("sortstart",function(e,t){if(t.item.hasClass("page"))return f.set(t.item,!0),u=$(".page").index(t.item[0])}).on("sort",function(e,t){if(t.item.hasClass("page"))return t=t.item,e.pageY<0&&2<$(".page").length?t.addClass("pending-remove"):t.removeClass("pending-remove")}).on("sortstop",function(e,t){var n,r,o;if(t.item.hasClass("page")){if(t=t.item,o=(n=$(".page")).index($(".active")),r=$(".item").index(t.find(".item")[0]),t.hasClass("pending-remove")){if(1===n.length)return;h.removeKey(t.data("key")),t.remove(),f.set($(".page")[o])}else h.changePageIndex(t.data("key"),o),f.set($(".active")),u<o&&(o=u,r=$(".item").index($($(".page")[o]).find(".item")[0]));return y.renderFrom(r),c.setUrl(),c.debugStates()}}).delegate(".show-page-license","click",function(e){var t;return e.preventDefault(),t=(e=$(this).parents(".page")).find("h1").text().trim(),p.open("License for ".concat(t),m.info(e))}).delegate(".show-page-source","click",function(e){return e.preventDefault(),e=$(this).parents(".page"),e=h.atKey(e.data("key")).getRawPage(),p.open("JSON for ".concat(e.title),$("<pre/>").text(JSON.stringify(e,null,2)))}).delegate(".page","click",function(e){if(!$(e.target).is("a"))return f.set(this)}).delegate(".internal","click",function(e){var t=$(e.target),t=t.text()||t.data("pageName");return t="".concat(t),s.context=$(e.target).attr("title").split(" => "),a(e,t)}).delegate("img.remote","click",function(e){var t;return $(e.target).attr("src").startsWith("data:image/png")?(e.preventDefault(),t=$(e.target).data("site"),wiki.site(t).refresh(function(){})):(t=$(e.target).data("slug"),s.context=[$(e.target).data("site")],a(e,t))}).delegate(".revision","dblclick",function(e){var t,n;return e.preventDefault(),e=$(this).parents(".page"),n=(e=h.atKey(e.data("key")).getRawPage()).journal.length-1,e=e.journal[n],t=JSON.stringify(e,null,2),p.open("Revision ".concat(n,", ").concat(e.type," action"),$("<pre/>").text(t))}).delegate(".action","click",function(e){var t,n,r,o;return e.preventDefault(),(r=$(e.target)).is(".fork")&&null!=(n=r.data("slug"))?(s.context=[r.data("site")],a(e,n.split("_")[0])):(t=(n=$(this).parents(".page")).data("key"),o=h.atKey(t).getSlug(),(r=$(this).parent().children().not(".separator").index(r))<0?void 0:(e.shiftKey||n.nextAll().remove(),e.shiftKey||h.removeAllAfterKey(t),g.createPage("".concat(o,"_rev").concat(r),n.data("site")).appendTo($(".main")).each(function(e,t){return d.cycle($(t))}),f.set($(".page").last())))}).delegate(".fork-page","click",function(e){var t,n,e=$(e.target).parents(".page");if(!e.find(".future").length){if(n=h.atKey(e.data("key")),e.attr("id").match(/_rev0$/))return r(n,e);if(t={type:"fork"},e.hasClass("local")){if(s.useLocalStorage())return;e.removeClass("local")}else n.isRecycler()?e.removeClass("recycler"):n.isRemote()&&(t.site=n.getRemoteSite());return null!=e.data("rev")&&e.find(".revision").remove(),e.removeClass("ghost"),s.put(e,t)}}).delegate("button.create","click",function(r){return e($(r.target).data("slug"),function(e){var t,n=$(r.target).parents(".page:first");return n.removeClass("ghost"),(t=h.atKey(n.data("key"))).become(e),e=t.getRawPage(),d.rebuildPage(t,n.empty()),s.put(n,{type:"create",id:e.id,item:{title:e.title,story:e.story}})})}).delegate(".score","mouseenter mouseleave",function(e){return console.log("in .score..."),$(".main").trigger("thumb",$(e.target).data("thumb"))}).delegate("a.search","click",function(e){var o,t=$(e.target).parents(".page"),n=t.data("key"),i=h.atKey(n),r=w();return r.setTitle("Search from '".concat(i.getTitle(),"'")),r.addParagraph("Search for pages related to '".concat(i.getTitle(),"'.\nEach search on this page will find pages related in a different way.\nChoose the search of interest. Be patient.")),r.addParagraph("Find pages with links to this title."),r.addItem({type:"search",text:"SEARCH LINKS ".concat(i.getSlug())}),r.addParagraph("Find pages with titles similar to this title."),r.addItem({type:"search",text:"SEARCH SLUGS ".concat(i.getSlug())}),r.addParagraph("Find pages neighboring  this site."),r.addItem({type:"search",text:"SEARCH SITES ".concat(i.getRemoteSite(location.host))}),r.addParagraph("Find pages sharing any of these items."),r.addItem({type:"search",text:"SEARCH ANY ITEMS ".concat(function(){for(var e=i.getRawPage().story,t=[],n=0,r=e.length;n<r;n++)o=e[n],t.push(o.id);return t}().join(" "))}),e.shiftKey||t.nextAll().remove(),e.shiftKey||h.removeAllAfterKey(n),g.showResult(r)}).bind("dragenter",function(e){return e.preventDefault()}).bind("dragover",function(e){return e.preventDefault()}).bind("drop",o.dispatch({page:function(e){return g.doInternalLink(e.slug,null,e.site)},file:t})),$(".provider input").click(function(){return $("footer input:first").val($(this).attr("data-provider")),$("footer form").submit()}),$("body").on("new-neighbor-done",function(e,t){return $(".page").each(function(e,t){return d.emitTwins($(t))})}),l=function(o){return new Promise(function(n,e){var r=b(o);return wiki.origin.get("".concat(r,".json"),function(e,t){return n({title:o,slug:r,type:"reference",text:(e?e.msg:null!=t?t.story[0].text:void 0)||""})})})},$("<span>&nbsp; ☰ </span>").css({cursor:"pointer"}).appendTo("footer").click(function(){var e,t,n,r,o,i,a,u,s,c=w();if(c.setTitle("Selected Plugin Pages"),c.addParagraph("Installed plugins offer these utility pages:"),window.catalog){for(s=[],e=0,r=(i=window.catalog).length;e<r;e++)if((t=i[e]).pages)for(n=0,o=(a=t.pages).length;n<o;n++)u=a[n],s.push(u);return Promise.all(s.map(l)).then(function(e){return e.forEach(function(e){return c.addItem(e)}),g.showResult(c)})}}),$("<span>&nbsp; wiki <span class=editEnable>✔︎</span> &nbsp; </span>").css({cursor:"pointer"}).appendTo("footer").click(function(){return $(".editEnable").toggle(),$(".page").each(function(){var e=$(this),t=h.atKey(e.data("key"));return d.rebuildPage(t,e.empty())})}),isAuthenticated||$(".editEnable").toggle(),v.bind(),$(function(){var e,n;return c.first(),e=$(".page").toArray(),(n=function(e){var t;if(0!==e.length)return t=$(e.shift()),d.cycle(t).then(function(){return n(e)});f.set($(".page").last())})(e)})})},{"./active":3,"./dialog":6,"./drop":7,"./license":15,"./lineup":16,"./link":17,"./page":20,"./pageHandler":21,"./plugin":23,"./refresh":27,"./state":34,"./target":36}],15:[function(e,t,n){"use strict";var r=e("./resolve"),o=e("./lineup"),i=function(){return'<p>\n  <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">\n  <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a>\n</p><p>\n  This work is licensed under a\n  <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">\n    Creative Commons Attribution-ShareAlike 4.0 International License\n  </a>.\n</p><p>\n  This license applies uniformly to all contributions\n  by all authors. Where authors quote other sources\n  they do so within the terms of fair use or other\n  compatiable terms.\n</p>'},a=function(e,t){var n,r,o,i,a,u,s;if(null==e.journal)return"";for(n={},i=[],o=(a=e.journal.slice(r=0).reverse()).length;r<o;r++)null!=(s=a[r]).site&&(t=s.site),"fork"!==s.type&&null==n[t]&&(s=wiki.site(t).getDirectURL(""),u=wiki.site(t).flag(),i.push('<a href="'.concat(s,'" target="_blank"><img class="remote" title="').concat(t,'" src="').concat(u,'"> ').concat(t,"</a>")),n[t]=!0);return 0<i.length?"<p>\n  Author's Sites:\n</p><p>\n  ".concat(i.join("<br>"),"\n</p>"):""},u=function(e){return null==(null!=e?e.provenance:void 0)?"":"<p>\n  Created From:\n</p><p>\n  ".concat(r.resolveLinks(e.provenance),"\n</p>")};t.exports={info:function(e){var e=o.atKey(e.data("key")),t=e.getRawPage(),e=e.getRemoteSite(location.hostname);return i()+a(t,e)+u(t.journal[0])}}},{"./lineup":16,"./resolve":28}],16:[function(e,t,n){"use strict";var r=[].indexOf,o=e("./random"),i={},a=[],u=function(e){return i[e]},s=function(e){return u(e).getTitle()},c=function(e){e=a.indexOf(e);return e<1?null:a[e-1]};t.exports={addPage:function(e){var t=o.randomBytes(4);return i[t]=e,a.push(t),t},changePageIndex:function(e,t){var n=a.indexOf(e);return a.splice(n,1),a.splice(t,0,e)},removeKey:function(t){return r.call(a,t)<0?null:(a=a.filter(function(e){return t!==e}),delete i[t],t)},removeAllAfterKey:function(e){var t,n=[];if(r.call(a,e)<0)return n;for(;a[a.length-1]!==e;)t=a.pop(),n.unshift(t),delete i[t];return n},atKey:u,titleAtKey:s,bestTitle:function(){return a.length?s(a[a.length-1]):"Wiki"},debugKeys:function(){return a},debugReset:function(){return i={},a=[]},crumbs:function(e,t){var n=i[e],r=n.getRemoteSite(t),o=["view",n=n.getSlug()];return"welcome-visitors"!==n&&o.unshift("view","welcome-visitors"),r===t||null==(n=c(e))||(e=i[n]).isRemote()||o.push(t,e.getSlug()),o.unshift(r),o},debugSelfCheck:function(e){if("".concat(a)!=="".concat(e)&&(console.log("The lineup is out of sync with the dom."),console.log(".pages:",e),console.log("lineup:",a),"".concat(Object.keys(a).sort())==="".concat(Object.keys(e).sort())))return console.log("It looks like an ordering problem we can fix."),e}}},{"./random":25}],17:[function(e,t,n){"use strict";var o=e("./lineup"),i=e("./active"),r=e("./refresh"),e=e("./page"),a=e.asTitle,u=e.asSlug,e=e.pageEmitter,s=function(e,t){var n,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;return t&&"view"!==t&&(n=t),r=r||a(e),t=$('<div class="page" id="'.concat(e,'" tabindex="-1">\n  <div class="paper">\n    <div class="twins"> <p> </p> </div>\n    <div class="header">\n      <h1> <img class="favicon" src="').concat(wiki.site(n).flag(),'" height="32px"> ').concat(r," </h1>\n    </div>\n  </div>\n</div>")),n&&t.data("site",n),t},c=function(e,t){return s(e,t,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null).appendTo(".main").each(function(e,t){return r.cycle($(t))})},l=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,r=u(e);return null!=t&&$(t).nextAll().remove(),null!=t&&o.removeAllAfterKey($(t).data("key")),c(r,n,e),i.set($(".page").last())},f=function(e){var t,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return null!=n.$page&&$(n.$page).nextAll().remove(),null!=n.$page&&o.removeAllAfterKey($(n.$page).data("key")),t=e.getSlug(),null!=n.rev&&(t+="_rev".concat(n.rev)),(n=s(t).addClass("ghost")).appendTo($(".main")),r.buildPage(e,n),i.set($(".page").last())};e.on("show",function(e){return console.log("pageEmitter handling",e),f(e)}),t.exports={createPage:s,doInternalLink:l,showPage:c,showResult:f}},{"./active":3,"./lineup":16,"./page":20,"./refresh":27}],18:[function(e,t,n){"use strict";var i,h,a,r,p={}.hasOwnProperty,o=e("underscore"),g=e("minisearch");t.exports=h={},h.sites={},a=0,r=function(n,r){var e,t,o;if(!r.sitemapRequestInflight)return r.sitemapRequestInflight=!0,o=function(e,t,n){return $('.neighbor[data-site="'.concat(e,'"]')).find("div").removeClass(t).addClass(n)},e=function(){return o(n,"wait","fetch"),wiki.site(n).get("system/sitemap.json",function(e,t){return r.sitemapRequestInflight=!1,e?(o(n,"fetch","fail"),wiki.site(n).refresh(function(){})):(r.sitemap=t,o(n,"fetch","done"),$("body").trigger("new-neighbor-done",n))}),wiki.site(n).getIndex("system/site-index.json",function(e,t){if(e)return console.log("error loading index",n,e);try{return r.siteIndex=g.loadJSON(t,{fields:["title","content"]}),console.log(n,"index loaded")}catch(e){return console.log("error loading index - not a valid index",n)}})},t=Date.now(),a<t?(a=t+500,setTimeout(e,100)):(setTimeout(e,a-t),a+=500)},h.retryNeighbor=function(e){var t;return console.log("retrying neighbor"),h.sites[e]=t={},r(e,t)},h.registerNeighbor=function(e){var t;if(null==h.sites[e])return h.sites[e]=t={},r(e,t),$("body").trigger("new-neighbor",e)},h.updateSitemap=function(e){var t,n,r,o,i,a=location.host;if((n=h.sites[a])&&!n.sitemapRequestInflight)return r=e.getSlug(),t=e.getDate(),i=e.getTitle(),o=e.getSynopsis(),e=e.getLinks(),t={slug:r,date:t,title:i,synopsis:o,links:e},0<=(o=(i=n.sitemap).findIndex(function(e){return e.slug===r}))?i[o]=t:i.push(t),$("body").trigger("new-neighbor-done",a)},h.deleteFromSitemap=function(e){var t,n,r,o,i=location.host;if((n=h.sites[i])&&!n.sitemapRequestInflight&&(o=e.getSlug(),0<=(t=(r=n.sitemap).findIndex(function(e){return e.slug===o}))))return r.splice(t),$("body").trigger("delete-neighbor-done",i)},h.listNeighbors=function(){return o.keys(h.sites)},i=function(e,t){var n,r,o,i;switch(t.type){case"paragraph":case"markdown":e+=" "+t.text.replace(/\[{2}|\[(?:[\S]+)|\]{1,2}/g,"");break;case"html":e+=" "+t.text.replace(/<[^>]*>/g,"");break;default:if(null!=t.text)for(n=0,r=(i=t.text.split(/\r\n?|\n/)).length;n<r;n++)(o=i[n]).match(/^[A-Z]+[ ].*/)||(e+=" "+o.replace(/\[{2}|\[(?:[\S]+)|\]{1,2}/g,""))}return e},h.updateIndex=function(e,t){var n,r,o;if(console.log("updating ".concat(e.getSlug()," in index")),n=location.host,n=h.sites[n]){t=t.reduce(i,""),r=e.getSlug(),o=e.getTitle(),e=e.getRawPage().story.reduce(i,"");try{n.siteIndex.remove({id:r,title:o,content:t})}catch(e){(t=e).message.includes("not in the index")||console.log("removing ".concat(r," from index failed"),t)}return n.siteIndex.add({id:r,title:o,content:e})}},h.deleteFromIndex=function(e){var t,n,r=location.host;if(r=h.sites[r]){t=e.getSlug(),n=e.getTitle(),e=e.getRawPage().story.reduce(i,"");try{return r.siteIndex.remove({id:t,title:n,content:e})}catch(e){if(!(r=e).message.includes("not in the index"))return console.log("removing ".concat(t," from index failed"),r)}}},h.search=function(e){var t,o,n,r,i,a,u=[],s={},c=function(e){return null!=s[e]?s[e]++:s[e]=1},l=function(e,t){var n,r="indexing sitemap ( ".concat(e," )");return console.time(r),console.log("indexing sitemap:",e),n=new g({fields:["title","content"]}),o.sitemap.forEach(function(e){n.add({id:e.slug,title:e.title,content:e.synopsis})}),console.timeEnd(r),n},f=Date.now(),d=h.sites;for(n in d)p.call(d,n)&&(o=d[n]).sitemap&&null==o.siteIndex&&(o.siteIndex=l(n));for(n in r=location.host,i=h.sites)if(p.call(i,n)&&(o=i[n]).siteIndex){c("sites");try{null!=s.pages?s.pages+=o.sitemap.length:s.pages=o.sitemap.length}catch(e){console.info("+++ sitemap not valid for ",n),o.sitemap=[]}t=n===r?(a=20,2):(a=10,1),o.siteIndex.search(e,{boost:{title:a,content:t},prefix:!0,combineWith:"AND"}).forEach(function(t){return c("finds"),u.push({page:o.sitemap.find(function(e){return e.slug===t.id}),site:n,rank:t.score})})}return u.sort(function(e,t){return t.rank-e.rank}),s.msec=Date.now()-f,{finds:u,tally:s}},h.backLinks=function(n){var e,r,t,o=[],i=h.sites;for(r in i)p.call(i,r)&&(e=i[r]).sitemap&&e.sitemap.forEach(function(e,t){if(null!=e.links&&0<Object.keys(e.links).length&&Object.keys(e.links).includes(n))return o.push({slug:e.slug,title:e.title,site:r,itemId:e.links[n],date:e.date})});return t={},o.forEach(function(e){return n=e.slug,t[n]=t[n]||{},t[n].title=e.title,t[n].sites=t[n].sites||[],t[n].sites.push({site:e.site,date:e.date,itemId:e.itemId})}),t}},{minisearch:57,underscore:58}],19:[function(e,t,n){"use strict";var o,r=e("./link"),i=e("./wiki"),a=e("./neighborhood"),u=null,s=function(e){return e.hasOwnProperty("links")},c=function(e){return console.log("neighbor - flag"),'<span class="neighbor" data-site="'.concat(e,'">\n  <div class="wait">\n    <img src="').concat(i.site(e).flag(),'" title="').concat(e,'">\n  </div>\n</span>')};t.exports={inject:function(e){return u=e.sites},bind:function(){var n=$(".neighborhood");return $("body").on("new-neighbor",function(e,t){return n.append(c(t))}).on("new-neighbor-done",function(e,t){var n,r;try{r=u[t].sitemap.length}catch(e){r=0}n=$('.neighborhood .neighbor[data-site="'.concat(t,'"]')).find("img");try{u[t].sitemap.some(s)?n.attr("title","".concat(t,"\n ").concat(r," pages with 2-way links")):n.attr("title","".concat(t,"\n ").concat(r," pages"))}catch(e){console.info("+++ sitemap not valid for ",t),u[t].sitemap=[]}return o=Object.values(a.sites).reduce(function(e,t){return t.sitemap.length},0),$(".searchbox .pages").text("".concat(o," pages"))}).delegate(".neighbor img","click",function(e){var t;return $(e.target).parent().hasClass("fail")?($(e.target).parent().removeClass("fail").addClass("wait"),t=$(e.target).attr("title"),i.site(t).refresh(function(){return console.log("about to retry neighbor"),a.retryNeighbor(t)})):r.doInternalLink("welcome-visitors",null,this.title.split("\n")[0])})}}},{"./link":17,"./neighborhood":18,"./wiki":38}],20:[function(e,t,n){"use strict";var u=e("./util").formatDate,s=e("./random"),c=e("./revision"),h=e("./synopsis"),p=e("underscore"),e=new(e("events").EventEmitter),g=function(e){return e.replace(/\s/g,"-").replace(/[^A-Za-z0-9-]/g,"").toLowerCase()},v=function(e){return[{symbol:"❄",date:e-316224e5,period:"a Year"},{symbol:"⚘",date:e-80352e5,period:"a Season"},{symbol:"⚪",date:e-26784e5,period:"a Month"},{symbol:"☽",date:e-6048e5,period:"a Week"},{symbol:"☀",date:e-864e5,period:"a Day"},{symbol:"⌚",date:e-36e5,period:"an Hour"}]},m=function(e,l){var t,n,r,o,i,f,a,d=e||{};return d.title||(d.title="empty"),d.story||(d.story=[]),d.journal||(d.journal=[]),a=function(e,t){for(var n,r=0,o=e.length;r<o;r++)if((n=e[r]).id===t.id&&n.date===t.date)return!1;return!0},{getRawPage:function(){return d},getContext:function(){var e,t,n,r,o,i=["view"];for(f()&&i.push(l),t=function(e){if(null!=e&&!p.include(i,e))return i.push(e)},r=(o=d.journal.slice(n=0).reverse()).length;n<r;n++)t(null!=(e=o[n])?e.site:void 0);return i},isPlugin:i=function(){return null!=d.plugin},isRemote:f=function(){return!(null==l||"view"===l||"origin"===l||"local"===l||"recycler"===l)},isLocal:function(){return"local"===l},isRecycler:function(){return"recycler"===l},getRemoteSite:n=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;return f()?l:e},getRemoteSiteDetails:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=[];return(e||f())&&t.push(n(e)),i()&&t.push("".concat(d.plugin," plugin")),t.join("\n")},getSlug:o=function(){return g(d.title)},getNeighbors:function(e){var t,n,r,o,i,a,u,s,c=[];for(f()?c.push(l):null!=e&&c.push(e),r=0,i=(u=d.story).length;r<i;r++)null!=(null!=(n=u[r])?n.site:void 0)&&c.push(n.site);for(o=0,a=(s=d.journal).length;o<a;o++)null!=(null!=(t=s[o])?t.site:void 0)&&c.push(t.site);return p.uniq(c)},getTitle:function(){return d.title},getLinks:function(){var e,t=function(e,t,n,r){var o,i,a;try{for(i=/\[\[([^\]]+)\]\]/g,0;null!==(a=i.exec(t.text));)e.has(g(a[1]))||e.set(g(a[1]),t.id);"reference"!==t.type||e.has(t.slug)||e.set(t.slug,t.id)}catch(e){o=e,console.log("*** Error extracting links from ".concat(n," of ").concat(JSON.stringify(r)),o.message)}return e};try{e=d.story.reduce(t,new Map)}catch(e){t=e,console.log("+++ Extract links on ".concat(d.slug," fails"),t)}return 0<e.size?Object.fromEntries(e):{}},setTitle:function(e){return d.title=e},getRevision:r=function(){return d.journal.length-1},getDate:function(){var e=d.journal[r()];if(null!=e&&null!=e.date)return e.date},getTimestamp:function(){var e=d.journal[r()];return null!=e?null!=e.date?u(e.date):"Revision ".concat(r()):"Unrecorded Date"},getSynopsis:function(){return h(d)},addItem:t=function(e){return e=p.extend({},{id:s.itemId()},e),d.story.push(e)},getItem:function(e){for(var t,n=d.story,r=0,o=n.length;r<o;r++)if((t=n[r]).id===e)return t;return null},addParagraph:function(e){return t({type:"paragraph",text:e})},seqItems:function(r){return new Promise(function(t,e){var n=function(e){return e>=d.story.length?t():r(d.story[e]||{text:"null"},function(){return n(e+1)})};return n(0)})},seqActions:function(u){var s=0,c=v((new Date).getTime()),l=function(e){var t,n,r,o,i,a;if(!(e>=d.journal.length)){for(n=(t=d.journal[e]||{}).date||0,a=null,r=0,o=c.length;r<o;r++)(i=c[r]).date>s&&i.date<n&&(a=i);return s=n,u({action:t,separator:a},function(){return l(e+1)})}};return l(0)},become:function(e,t){if(d.story=(null!=e?e.getRawPage().story:void 0)||[],null!=t)return d.journal=null!=t?t.getRawPage().journal:void 0},siteLineup:function(){var e=o(),e="welcome-visitors"===e?"view/welcome-visitors":"view/welcome-visitors/view/".concat(e);return f()?wiki.site(l).getDirectURL(e):"/".concat(e)},merge:function(e){for(var o,t=function(){for(var e=d.journal,t=[],n=0,r=e.length;n<r;n++)o=e[n],t.push(o);return t}(),n=e.getRawPage().journal,r=0,i=n.length;r<i;r++)o=n[r],a(d.journal,o)&&t.push(o);return t.push({type:"fork",site:e.getRemoteSite(),date:(new Date).getTime()}),m(c.create(999,{title:d.title,journal:t}),l)},apply:function(e){if(c.apply(d,e),e.site)return l=null},getCreate:function(){var e=function(e){return"create"===e.type};return d.journal.reverse().find(e)}}};t.exports={newPage:m,asSlug:g,asTitle:function(e){return e.replace(/-/g," ")},pageEmitter:e}},{"./random":25,"./revision":29,"./synopsis":35,"./util":37,events:47,underscore:58}],21:[function(e,t,n){"use strict";var s,i,o,c,a,l,u=e("underscore"),f=e("./state"),d=e("./revision"),h=e("./addToJournal"),p=e("./page").newPage,g=(e("./random"),e("./lineup")),v=e("./neighborhood");t.exports=o={},s=function(e){return JSON.parse(JSON.stringify(e))},o.useLocalStorage=function(){return 0<$(".login").length},i=function(e){if(e=localStorage.getItem(e))return JSON.parse(e)},l=function(e){var r=e.pageInformation,o=e.whenGotten,i=e.whenNotGotten,a=e.localContext,e=r.slug,u=r.rev,s=r.site,t={get:function(n,r){return wiki.local.get(n,function(e,t){return console.log([e,t]),null!=e?wiki.origin.get(n,r):(s="local",r(null,t))})}};return s?a=[]:s=a.shift(),null===(s=s===window.location.host?"origin":s)&&(s="view"),function(){switch(s){case"local":return wiki.local;case"origin":return wiki.origin;case"recycler":return wiki.recycler;case"view":return t;default:return wiki.site(s)}}().get("".concat(e,".json"),function(e,t){var n;return e?404===e.xhr.status||0===e.xhr.status?0<a.length?l({pageInformation:r,whenGotten:o,whenNotGotten:i,localContext:a}):i():(n="The page handler has run into problems with this request.\n<pre class=error>".concat(JSON.stringify(r),"</pre>\nThe requested url.\n<pre class=error>").concat(url,"</pre>\nThe server reported status.\n<pre class=error>").concat(null!=(n=e.xhr)?n.status:void 0,"</pre>\nThe error message.\n<pre class=error>").concat(e.msg,"</pre>\nThese problems are rarely solved by reporting issues.\nThere could be additional information reported in the browser's console.log.\nMore information might be accessible by fetching the page outside of wiki.\n<a href=\"").concat(url,'" target="_blank">try-now</a>'),(e=p({title:"Trouble: Can't Get Page"},null)).addItem({type:"html",text:n}),o(e)):(console.log("got",s,t),u&&(t=d.create(u,t)),o(p(t,s)))})},o.get=function(e){var t,n=e.whenGotten,r=e.whenNotGotten,e=e.pageInformation;return!e.site&&(t=i(e.slug))?(e.rev&&(t=d.create(e.rev,t)),n(p(t,"local"))):(o.context.length||(o.context=["view"]),l({pageInformation:e,whenGotten:n,whenNotGotten:r,localContext:u.clone(o.context)}))},o.context=[],c=function(e,t,n){var r,o;return"create"===n.type?r={title:n.item.title,story:[],journal:[]}:(null==(r=(r=i(t.slug))||g.atKey(e.data("key")).getRawPage()).journal&&(r.journal=[]),null!=(o=n.fork)&&(r.journal=r.journal.concat({type:"fork",site:o,date:(new Date).getTime()}),delete n.fork)),d.apply(r,n),wiki.local.put(t.slug,r,function(){return h(e.find(".journal"),n),e.addClass("local")})},a=function(r,o,i){var a=s(i),u=g.atKey(r.data("key"));return"fork"===i.type&&(a.item=s(u.getRawPage())),wiki.origin.get("".concat(o.slug,".json"),function(e,t){var n=!e&&t.story||[];return wiki.origin.put(o.slug,a,function(e){return e?(i.error={type:e.type,msg:e.msg,response:e.xhr.responseText},c(r,o,i)):(null!=u&&u.apply&&u.apply(i),v.updateSitemap(u),v.updateIndex(u,n),h(r.find(".journal"),i),"fork"===i.type?wiki.local.delete(r.attr("id")):void 0)})})},o.put=function(t,e){var n=function(){var e;switch(e=t.data("site")){case"origin":case"local":case"view":case location.host:return null;default:return e}},n={slug:t.attr("id").split("_rev")[0],rev:t.attr("id").split("_rev")[1],site:n(),local:t.hasClass("local")},r=n.site;return console.log("pageHandler.put",e,n),o.useLocalStorage()&&(null!=n.site?console.log("remote => local"):n.local||(console.log("origin => local"),e.site=r=location.host)),e.date=(new Date).getTime(),"origin"===e.site&&delete e.site,t.removeClass("plugin"),r&&(t.find("h1").prop("title",location.host),t.find("h1 img").attr("src","/favicon.png"),t.find("h1 a").attr("href","/view/welcome-visitors/view/".concat(n.slug)).attr("target",location.host),t.data("site",null),t.removeClass("remote"),f.setUrl(),"fork"!==e.type&&(e.fork=r,h(t.find(".journal"),{type:"fork",site:r,date:e.date}))),(o.useLocalStorage()||"local"===n.site?c:a)(t,n,e)},o.delete=function(t,e,n){return console.log("delete server-side"),console.log("pageObject:",t),t.isRecycler()?wiki.recycler.delete("".concat(t.getSlug(),".json"),function(e){return setTimeout(function(){return n(e)},300)}):wiki.origin.delete("".concat(t.getSlug(),".json"),function(e){return setTimeout(function(){return null==e&&v.deleteFromSitemap(t),null==e&&v.deleteFromIndex(t),n(e)},300)})}},{"./addToJournal":4,"./lineup":16,"./neighborhood":18,"./page":20,"./random":25,"./revision":29,"./state":34,underscore:58}],22:[function(e,t,n){"use strict";var r=e("./editor"),u=e("./resolve"),o=e("./itemz"),i=function(e){return e.match(/<(i|b|p|a|h\d|hr|br|li|img|div|span|table|blockquote)\b.*?>/i)?"html":"markdown"};t.exports={emit:function(e,t){for(var n,r=t.text.split(/\n\n+/),o=[],i=0,a=r.length;i<a;i++)(n=r[i]).match(/\S/)?o.push(e.append("<p>".concat(u.resolveLinks(n),"</p>"))):o.push(void 0);return o},bind:function(t,n){return t.dblclick(function(e){return e.shiftKey?(n.type=i(n.text),o.replaceItem(t,"paragraph",n)):r.textEditor(t,n,{append:!0})})}}},{"./editor":8,"./itemz":13,"./resolve":28}],23:[function(e,t,n){"use strict";var r,o,u,i,a,s,c,l,f=[].indexOf;t.exports=c={},u=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},a=function(e,t){return console.log("loading url:",e),t=$.extend(t||{},{dataType:"script",cache:!0,url:e}),$.ajax(t)},l=[],s={},i=c.getScript=function(r){var o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};return 0<=f.call(l,r)?o():a(r).done(function(){return l.push(r),o()}).fail(function(e,t,n){return console.log("getScript: Failed to load:",r,n),o()})},c.renderFrom=function(e){var o,i,t=$(".item").slice(e);return console.log("notifIndex",e,"about to render",t.toArray()),i=Promise.resolve(),i=(i=(o=function(e){var n,r,t;return 0===e.length?i:(t=e.shift(),(n=$(t)).hasClass("textEditing")||(r=n.data("item"),i=i.then(function(){return new Promise(function(e,t){return n.off(),c.emit(n.empty(),r,function(){return e()})})})),o(e))})(t.toArray())).then(function(){var o;return i=Promise.resolve(),(o=function(e){var n,r,t;return 0===e.length?i:(t=e.shift(),n=$(t),r=n.data("item"),i=i.then(function(){return new Promise(function(t,e){return c.getPlugin(r.type,function(e){return e.bind(n,r),t()})})}),o(e))})(t.toArray())})},o=function(n){return function(e,t){return e.addClass("emit"),n(e,t)}},r=function(u,s){return function(o,t,e){var n,i,r,a;return o[0].consuming=[],r=$(".item").index(o),n=window.plugins[u].consumes,a=Promise.resolve(),n&&(i=[],n.forEach(function(e){var t=$(".item:lt(".concat(r,")")).filter(e);return console.log(u,"consumes",e),console.log(t,"produce",e),t&&0!==t.length||console.log("warn: no items in lineup that produces",e),console.log("there are ".concat(t.length," instances of ").concat(e)),t.each(function(e,t){var n=$(t).parents(".page").data("key"),r=$(t).attr("data-id");return o[0].consuming.push("".concat(n,"/").concat(r)),i.push(t.promise)})}),a=Promise.all(i)),a.then(function(){var e;return o.removeClass("emit"),(e=s(o,t))&&"function"!=typeof e.then||(e=Promise.resolve(e)),o[0].promise=e}).catch(function(e){return console.log("plugin emit: unexpected error",e)})}},c.wrap=function(e,t){return t.emit=o(t.emit),t.bind=r(e,t.bind),t},c.get=c.getPlugin=function(n,t){return s[n]?s[n].then(t):(s[n]=new Promise(function(t,e){return window.plugins[n]?t(window.plugins[n]):i("/plugins/".concat(n,"/").concat(n,".js"),function(){var e=window.plugins[n];return e?(c.wrap(n,e),t(e)):i("/plugins/".concat(n,".js"),function(){return(e=window.plugins[n])&&c.wrap(n,e),t(e)})})}),s[n].then(function(e){return delete s[n],t(e)}),s[n])},c.do=c.doPlugin=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(){};return e.data("item",t),c.renderFrom($(".item").index(e)).then(function(){return n()})},c.emit=function(r,o){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(){},a=function(e,t){return r.append('<div class="error">\n  '.concat(u(o.text||""),"\n  <button>help</button><br>\n</div>")),null!=o.text&&r.find(".error").dblclick(function(e){return wiki.textEditor(r,o)}),r.find("button").on("click",function(){return wiki.dialog(e.toString(),'<p> This "'.concat(o.type,'" plugin won\'t show.</p>\n<li> Is it available on this server?\n<li> Is its markup correct?\n<li> Can it find necessary data?\n<li> Has network access been interrupted?\n<li> Has its code been tested?\n<p> Developers may open debugging tools and retry the plugin.</p>\n<button class="retry">retry</button>\n<p> Learn more\n  <a class="external" target="_blank" rel="nofollow"\n  href="http://plugins.fed.wiki.org/about-plugins.html"\n  title="http://plugins.fed.wiki.org/about-plugins.html">\n    About Plugins\n    <img src="/images/external-link-ltr-icon.png">\n  </a>\n</p>')),$(".retry").on("click",function(){return 2<t.emit.length?t.emit(r,o,function(){return i()}):(t.emit(r,o),i())})})};return r.data("pageElement",r.parents(".page")),r.data("item",o),c.get(o.type,function(t){var n;try{if(null==t)throw TypeError("Can't find plugin for '".concat(o.type,"'"));return 2<t.emit.length?t.emit(r,o,function(){return t.bind(r,o),i()}):(t.emit(r,o),i())}catch(e){return n=e,console.log("plugin error",n),a(n,t),i()}})},c.registerPlugin=function(e,t){return window.plugins[e]=t($)}},{}],24:[function(e,t,n){"use strict";var r=e("./plugin");window.plugins={reference:r.wrap("reference",e("./reference")),factory:r.wrap("factory",e("./factory")),paragraph:r.wrap("paragraph",e("./paragraph")),image:r.wrap("image",e("./image")),future:r.wrap("future",e("./future")),importer:r.wrap("importer",e("./importer"))}},{"./factory":9,"./future":10,"./image":11,"./importer":12,"./paragraph":22,"./plugin":23,"./reference":26}],25:[function(e,t,n){"use strict";var o=function(){return(256*(1+Math.random())|0).toString(16).substring(1)},r=function(r){return function(){for(var e=[],t=1,n=r;1<=n?t<=n:n<=t;1<=n?t++:t--)e.push(o());return e}().join("")};t.exports={randomByte:o,randomBytes:r,itemId:function(){return r(8)}}},{}],26:[function(e,t,n){"use strict";var r=e("./editor"),o=e("./resolve"),i=e("./page");t.exports={emit:function(e,t){var n,r=t.slug;return r=(r=null!=t.title?r||i.asSlug(t.title):r)||"welcome-visitors",n=t.site,o.resolveFrom(n,function(){return e.append("<p>\n  <img class='remote'\n    src='".concat(wiki.site(n).flag(),"'\n    title='").concat(n,"'\n    data-site=\"").concat(n,'"\n    data-slug="').concat(r,'"\n  >\n  ').concat(o.resolveLinks("[[".concat(t.title||r,"]]")),"\n  —\n  ").concat(o.resolveLinks(t.text),"\n</p>"))})},bind:function(e,t){return e.dblclick(function(){return r.textEditor(e,t)})}}},{"./editor":8,"./page":20,"./resolve":28}],27:[function(e,t,P){"use strict";function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,u=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){u=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(u)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(n="Object"===n&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var d=e("underscore"),h=e("./pageHandler"),p=e("./plugin"),o=e("./state"),y=e("./neighborhood"),g=e("./addToJournal"),n=e("./actionSymbols"),v=e("./lineup"),m=e("./resolve"),i=e("./random"),e=e("./page"),b=e.newPage,w=e.asSlug,a=e.pageEmitter,x=function(e){if(0<$(e).length)return $(e).data("item")||$(e).data("staticItem")},k=function(e,t,n){n=$.extend({},n);return t.data("item",n),null!=(e=v.atKey(e.data("key"))).getItem(n.id)?(n.alias||(n.alias=n.id),n.id=i.itemId(),t.attr("data-id",n.id),t.data("id",n.id),t.data("item").id=n.id):null!=n.alias&&null==e.getItem(n.alias)&&(n.id=n.alias,delete n.alias,t.attr("data-id",n.id)),n},_=function(e,t){return e&&t&&e.get(0)===t.get(0)},j=function(e){return e.children().map(function(e,t){return $(t).attr("data-id")}).get()},s=function(e,t,n,r){var o,t=t.item,i=x(t),a=t.data("pageElement"),u=a.hasClass("ghost")||a.hasClass("remote"),s=t.parents(".page:first"),c=s.hasClass("ghost"),l=_(a,s),f=!l&&a.attr("id")===s.attr("id");if(!c&&!f)return l?(c=j(t.parents(".story:first")),void(d.isEqual(c,r)||($(".shadow-copy").remove(),t.empty(),o=$(".item").index(t),p.renderFrom(o=n<o?n:o),h.put(s,{id:i.id,type:"move",order:c})))):(u||e.shiftKey?$(".shadow-copy").removeClass("shadow-copy").data(t.data()).attr({"data-id":t.attr("data-id")}):h.put(a,{id:i.id,type:"remove"}),t.data("pageElement",s),f=t.prev(".item"),l=x(f),i=k(s,t,i),h.put(s,{id:i.id,type:"add",item:i,after:null!=l?l.id:void 0}),$(".shadow-copy").remove(),t.empty(),f.after(t),o=$(".item").index(t),p.renderFrom(o=n<o?n:o));$(e.target).sortable("cancel")},c=function(e,t){var n=t.item.data("pageElement"),r=n.hasClass("ghost")||n.hasClass("remote"),t=t.placeholder.parents(".page:first"),o=t.hasClass("ghost"),i=_(n,t),n=!i&&n.attr("id")===t.attr("id"),t=r||e.shiftKey&&!i;return o||n?($("body").css("cursor","no-drop"),$(".shadow-copy").hide()):t?($("body").css("cursor","copy"),$(".shadow-copy").show()):($("body").css("cursor","move"),$(".shadow-copy").hide())},u=function(e){var n=$("body").css("cursor"),t={connectWith:".page .story",placeholder:"item-placeholder",forcePlaceholderSize:!0,delay:150},r=e.find(".story"),o=null,i=null,a=null,u=function(e){if(27===e.which)return a=!0,r.sortable("cancel")};return r.sortable(t).on("sortstart",function(e,t){var n=t.item;return o=j(r),i=$(".item").index(n),a=!1,$("body").on("keydown",u),n.clone().insertAfter(t.placeholder).hide().addClass("shadow-copy").css({width:"",height:"",position:"",zIndex:""}).removeAttr("data-id")}).on("sort",c).on("sortstop",function(e,t){return $("body").css("cursor",n).off("keydown",u),a||s(e,t,i,o),$(".shadow-copy").remove()})},l=function(e){e=$(e).parents(".page:first");return v.atKey(e.data("key"))},I=function(e,t){t=l(t.draggable),e=l(e.target);return a.emit("show",e.merge(t))},S=function(e){e=e.find(".journal");return e.draggable({revert:!0,appendTo:".main",scroll:!1,helper:"clone"}),e.droppable({hoverClass:"ui-state-hover",drop:I,accept:".journal"})},E=function(t){return t.find(".add-factory").on("click",function(e){if(!t.hasClass("ghost"))return e.preventDefault(),A(t)})},A=function(e){var t={type:"factory",id:i.itemId()},n=$("<div />",{class:"item factory"}).data("item",t).attr("data-id",t.id);return n.data("pageElement",e),e.find(".story").append(n),p.do(n,t),n=n.prev(".item"),n=x(n),h.put(e,{item:t,id:t.id,type:"add",after:null!=n?n.id:void 0})},C=function(e){e.preventDefault(),v.debugSelfCheck(function(){for(var e=$(".page"),t=[],n=0,r=e.length;n<r;n++)o=e[n],t.push($(o).data("key"));return t}()),e=$(e.target).parents(".page:first"),e=v.crumbs(e.data("key"),location.host);var o,t=f(e,1)[0],n=f(wiki.site(t).getDirectURL("").split("/"),1)[0];return""===n&&(n=window.location.protocol),window.open("".concat(n,"//").concat(e.join("/")),t).focus()},O=function(e,t,n){var r=n.isRecycler()?"recycler":n.getRemoteSite(location.host),o=n.getRemoteSiteDetails(location.host);return e.append('<h1 title="'.concat(o,'">\n  <span>\n    <a href="').concat(n.siteLineup(),'" target="').concat(r,'">\n      <img src="').concat(wiki.site(r).flag(),'" height="32px" class="favicon"></a>\n    ').concat(m.escape(n.getTitle()),"\n  </span>\n</h1>")),e.find("a").on("click",C)},F=function(e,t,n){if(t.attr("id").match(/_rev/))return t.addClass("ghost"),t.data("rev",n.getRevision()),e.append($('<h2 class="revision">\n  <span>\n    '.concat(n.getTimestamp(),"\n  </span>\n</h2>")))},N=function(e){return e.append('<div class="control-buttons">\n  <a href="#" class="button fork-page" title="fork this page">'.concat(n.fork,'</a>\n  <a href="#" class="button add-factory" title="add paragraph">').concat(n.add,"</a>\n</div>"))},M=function(e,t){var n,r,o,i,a,u,s,c,l,f,d,t=t.getSlug(),h=y.backLinks(t);if(0<Object.keys(h).length){for(s in c=[],h){for((n=h[s]).sites.sort(function(e,t){return(e.date||0)<(t.date||0)}),r=[],o=i=0,a=(l=n.sites).length;i<a;o=++i)d=l[o],o<10?(f=(null!=(f=n.sites[o-1])?f.date:void 0)===d.date?"":" ",r.unshift(f),r.unshift('<img class="remote"\n    src="'.concat(wiki.site(d.site).flag(),'"\n    data-slug="').concat(s,'"\n    data-site="').concat(d.site,'"\n    data-id="').concat(d.itemId,'"\n    title="').concat(d.site,"\n").concat(wiki.util.formatElapsedTime(d.date),'">'))):10===o&&r.unshift(" ⋯ ");u=m.resolveLinks("[[".concat(n.title,"]]")),c.push('<div style="clear: both;">\n  <div style="float: left;">'.concat(u,'</div>\n  <div style="text-align: right;"> ').concat(r.join("")," </div>\n</div>"))}if(c)return e.append("<details>\n  <summary>".concat(c.length," pages link here:</summary>\n  ").concat(c.join("\n"),"\n</details>"))}},B=function(e,t){var n=t.getRemoteSite(location.host),t=t.getSlug();return e.append('<a class="show-page-license" href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank">CC BY-SA 4.0</a> .\n<a class="show-page-source" href="'.concat(wiki.site(n).getDirectURL(t),'.json" title="source">JSON</a> .\n<a href= "').concat(wiki.site(n).getDirectURL(t),'.html" date-slug="').concat(t,'" target="').concat(n,'">').concat(n,' </a> .\n<a href= "#" class=search>search</a>'))},z=function(e){for(var t,n=e||[],r=n.length-1;0<=r;r+=-1)if((t=n[r]).date&&"fork"!==t.type)return t.date},T=function(e){var o,t,n,i,r,a,u,s,c,l,f,d,h,p,g,v,m=e.data("data");if(m&&("view"!==(h=e.data("site")||window.location.host)&&"origin"!==h||(h=window.location.host),p=w(m.title),v=z(m.journal))){for(d in t={newer:[],same:[],older:[]},l=y.sites)if(r=l[d],d!==h&&null!=r.sitemap)for(u=0,c=(f=r.sitemap).length;u<c;u++)(a=f[u]).slug===p&&(o=a.date>v?t.newer:a.date<v?t.older:t.same).push({remoteSite:d,item:a});for(s in g=[],t)(o=t[s]).length&&(o.sort(function(e,t){return e.item.date<t.item.date}),n=function(){var e,t,n=[];for(i=e=0,t=o.length;e<t;i=++e){var r=o[i];if(d=r.remoteSite,a=r.item,8<=i)break;n.push('<img class="remote"\nsrc="'.concat(wiki.site(d).flag(),'"\ndata-slug="').concat(p,'"\ndata-site="').concat(d,'"\ntitle="').concat(d,'">'))}return n}(),g.push("".concat(n.join("&nbsp;")," ").concat(s)));if(g)return e.find(".twins").html("<p><span>".concat(g.join(", "),"</span></p>"))}},U=function(e,t){var n,o;t.data("data",e.getRawPage()),e.isRemote()&&t.data("site",e.getRemoteSite()),console.log(".page keys ",function(){for(var e=$(".page"),t=[],n=0,r=e.length;n<r;n++)o=e[n],t.push($(o).data("key"));return t}()),console.log("lineup keys",v.debugKeys()),m.resolutionContext=e.getContext(),t.empty(),n=$("<div class='paper' />"),t.append(n);var r=f(["handle-parent","twins","header","story","backlinks","journal","footer"].map(function(e){if("journal"!==e||$(".editEnable").is(":visible"))return $("<div />").addClass(e).appendTo(n)}),7),i=r[0],a=(r[1],r[2]),u=r[3],s=r[4],c=r[5],r=r[6],l=$("<div />").addClass("page-handle").appendTo(i);return O(a,0,e),F(a,t,e),a=(a=e.seqItems(function(e,t){var n=$('<div class="item '.concat(e.type,'" data-id="').concat(e.id,'">'));return u.append(n),n.data("item",e),t()})).then(function(){var e=$(".page").index(t[0]),e=$(".item").index($($(".page")[e]).find(".item"));return p.renderFrom(e)}).then(function(){return t}),$(".editEnable").is(":visible")&&e.seqActions(function(e,t){return e.separator&&g(c,e.separator),g(c,e.action),t()}),T(t),M(s,e),$(".editEnable").is(":visible")&&N(c),B(r,e),l.css({height:"".concat(u.position().top-i.position().top-5,"px")}),a},q=function(e,t){if(!t.isRemote())return $("img.favicon",e).on("error",function(){return p.get("favicon",function(e){return e.create()})})},L=function(e,t){var n;return e.isLocal()&&t.addClass("local"),e.isRecycler()&&t.addClass("recycler"),e.isRemote()&&t.addClass("remote"),e.isPlugin()&&t.addClass("plugin"),n=U(e,t),q(t,e),o.setUrl(),$(".editEnable").is(":visible")&&(u(t),S(t),E(t)),n},R=function(e,t){return t.data("key",v.addPage(e)),L(e,t)},D=function(e,t){var n,r,o,i,a,u,s,c=w(e),l=b();for(s in l.setTitle(e),r=[],a=y.sites)null!=(u=a[s]).sitemap&&null!=(u=d.find(u.sitemap,function(e){return e.slug===c}))&&r.push({type:"reference",site:s,slug:c,title:u.title||c,text:u.synopsis||""});if(0<r.length)for(l.addItem({type:"future",text:"We could not find this page in the expected context.",title:e,create:t}),l.addItem({type:"paragraph",text:"We did find the page in your current neighborhood."}),o=0,i=r.length;o<i;o++)n=r[o],l.addItem(n);else l.addItem({type:"future",text:"We could not find this page.",title:e,create:t});return l};t.exports={cycle:function(a){var u=new Promise(function(i,e){var t=f(a.attr("id").split("_rev"),2),n=t[0],t=t[1],r=a.find(".header h1").text().trim(),t={slug:n,rev:t,site:a.data("site")};return h.get({whenGotten:function(e){var t,n,r,o;for(u=R(e,a),t=0,n=(r=e.getNeighbors(location.host)).length;t<n;t++)o=r[t],y.registerNeighbor(o);return i(u)},whenNotGotten:function(){var e=$('a.internal[href="/'.concat(n,'.html"]:last'));return r=r||e.text()||n,e=e.parents(".page").data("key"),null!=(e=v.atKey(e))&&e.getCreate(),e=D(r),(u=R(e,a)).then(function(e){return e.addClass("ghost")}),i(u)},pageInformation:t})});return u},emitTwins:T,buildPage:R,rebuildPage:L,newFuturePage:D}},{"./actionSymbols":2,"./addToJournal":4,"./lineup":16,"./neighborhood":18,"./page":20,"./pageHandler":21,"./plugin":23,"./random":25,"./resolve":28,"./state":34,underscore:58}],28:[function(e,t,n){"use strict";var a,u,s=e("./page").asSlug;t.exports=u={},u.resolutionContext=[],u.escape=a=function(e){return(e||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},u.resolveFrom=function(e,t){u.resolutionContext.push(e);try{return t()}finally{u.resolutionContext.pop()}},u.resolveLinks=function(e){var n=[],o=function(e){var t=n.length;return n.push(e),"〖".concat(t,"〗")},t=function(e,t){return n[+t]},r=function(e,t){var n=s(t);return n.length?o('<a class="internal" href="/'.concat(n,'.html" data-page-name="').concat(n,'" title="').concat(u.resolutionContext.join(" => "),'">').concat(a(t),"</a>")):e},i=function(e,t,n,r){return o('<a class="external" target="_blank" href="'.concat(t,'" title="').concat(t,'" rel="nofollow">').concat(a(r),' <img src="/images/external-link-ltr-icon.png"></a>'))};return(1<arguments.length&&void 0!==arguments[1]?arguments[1]:a)(e=(e||"").replace(/〖(\d+)〗/g,"〖 $1 〗").replace(/\[\[([^\]]+)\]\]/gi,r).replace(/\[((http|https|ftp):.*?) (.*?)\]/gi,i)).replace(/〖(\d+)〗/g,t)}},{"./page":20}],29:[function(e,t,n){"use strict";var u=function(i,t){var e,n,r=function(){for(var e,t=i.story||[],n=[],r=0,o=t.length;r<o;r++)e=t[r],n.push(null!=e?e.id:void 0);return n},o=function(e,t){e=r().indexOf(e)+1;return i.story.splice(e,0,t)},a=function(){var e;if(-1!==(e=r().indexOf(t.id)))return i.story.splice(e,1)};switch(i.story||(i.story=[]),t.type){case"create":null!=t.item&&(null!=t.item.title&&(i.title=t.item.title),null!=t.item.story&&(i.story=t.item.story.slice()));break;case"add":o(t.after,t.item);break;case"edit":-1!==(e=r().indexOf(t.id))?i.story.splice(e,1,t.item):i.story.push(t.item);break;case"move":e=t.order.indexOf(t.id),e=t.order[e-1],n=i.story[r().indexOf(t.id)],a(),o(e,n);break;case"remove":a()}return i.journal||(i.journal=[]),i.journal.push(t)};t.exports={create:function(e,t){for(var n,r=t.journal.slice(0,+(e=+e)+1||9e9),o={title:t.title,story:[]},i=0,a=r.length;i<a;i++)n=r[i],u(o,n||{});return o},apply:u}},{}],30:[function(e,t,n){"use strict";var g=e("./pageHandler"),v=e("./random"),s=e("./link"),c=(e("./active"),e("./page").newPage),o=e("./resolve"),i=e("./page"),m=function(e,t){var n,r=t.slug;return r=(r=null!=t.title?r||i.asSlug(t.title):r)||"welcome-visitors",n=t.site,o.resolveFrom(n,function(){return e.append("<p>\n  <img class='remote'\n    src='".concat(wiki.site(n).flag(),"'\n    title='").concat(n,"'\n    data-site=\"").concat(n,'"\n    data-slug="').concat(r,'"\n  >\n  ').concat(o.resolveLinks("[[".concat(t.title||r,"]]")),"\n  —\n  ").concat(o.resolveLinks(t.text),"\n</p>"))})},y=function(e,t){return e.preventDefault(),e.shiftKey||(i=$(e.target).parents(".page")),s.doInternalLink(t,i,$(e.target).data("site")),!1};t.exports=function(e){var p=e.neighborhood;return{incrementalSearch:function(e){var t,n,r,o,i,a,u,s,c,l,f,d,h;if(!(e.length<2)){for(0===$(".incremental-search").length&&(u=$(".searchbox").position(),$("<div/>").css("left","".concat(u.left,"px")).css("bottom","".concat(u.top+$(".searchbox").height(),"px")).addClass("incremental-search").delegate(".internal","click",function(e){var t;return"SPAN"===e.target.nodeName&&(e.target=$(e.target).parent()[0]),t=$(e.target).data("pageName"),t="".concat(t),g.context=$(e.target).attr("title").split(" => "),y(e,t)}).delegate("img.remote","click",function(e){var t;return $(e.target).attr("src").startsWith("data:image/png")?(e.preventDefault(),t=$(e.target).data("site"),wiki.site(t).refresh(function(){})):(t=$(e.target).data("slug"),g.context=[$(e.target).data("site")],y(e,t))}).appendTo($(".searchbox"))),d=p.search(e),h=e.split(" ").map(function(e){return e.toLowerCase()}).filter(String),f=new RegExp("\\b("+e.split(" ").map(function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}).filter(String).join("|")+")","i"),o=function(e){return e.split(f).map(function(e){return h.includes(e.toLowerCase())?"{{".concat(e,"}}"):e}).join("")},n=$(".incremental-search").empty(),d.finds&&0!==d.finds.length||$("<div/>").text("No results found").addClass("no-results").appendTo(n),l=[],i=r=0,a=(s=d.finds).length;i<a;i++)c=s[i],101===(r+=1)&&$("<div/>").text("".concat(d.finds.length-100," results omitted")).addClass("omitted-results").appendTo(n),100<r||(t=$("<div/>").appendTo(n),c={id:v.itemId(),type:"reference",site:c.site,slug:c.page.slug,title:o(c.page.title),text:o(c.page.synopsis)},m(t,c),l.push(t.html(t.html().split(new RegExp("({{.*?}})","i")).map(function(e){return 0===e.indexOf("{{")?"<span class='search-term'>".concat(e.substring(2,e.length-2),"</span>"):e}).join(""))));return l}$(".incremental-search").remove()},performSearch:function(e){var t,n,r,o,i,a,u=p.search(e);if(u.finds&&1===u.finds.length)return $(".incremental-search").find(".internal").click(),void $(".incremental-search").remove();for($(".incremental-search").remove(),a=u.tally,(i=c()).setTitle("Search for '".concat(e,"'")),i.addParagraph("String '".concat(e,"' found on ").concat(a.finds||"none"," of ").concat(a.pages||"no"," pages from ").concat(a.sites||"no"," sites.\nText matched on ").concat(a.title||"no"," titles, ").concat(a.text||"no"," paragraphs, and ").concat(a.slug||"no"," slugs.\nElapsed time ").concat(a.msec," milliseconds.")),t=0,n=(r=u.finds).length;t<n;t++)o=r[t],i.addItem({type:"reference",site:o.site,slug:o.page.slug,title:o.page.title,text:o.page.synopsis||""});return s.showResult(i)}}}},{"./active":3,"./link":17,"./page":20,"./pageHandler":21,"./random":25,"./resolve":28}],31:[function(e,t,n){"use strict";var r=e("./search"),o=null;t.exports={inject:function(e){return o=r({neighborhood:e})},bind:function(){return $("input.search").attr("autocomplete","off"),$("input.search").on("keydown",function(e){if(27===e.keyCode)return $(".incremental-search").remove()}),$("input.search").on("keypress",function(e){if(13===e.keyCode)return e=$(this).val(),o.performSearch(e),$(this).val("")}),$("input.search").on("focus",function(e){var t=$(this).val();return o.incrementalSearch(t)}),$("input.search").on("input",function(e){var t=$(this).val();return o.incrementalSearch(t)})}}},{"./search":30}],32:[function(e,t,n){"use strict";var r;t.exports={},r=e("./plugin"),t.exports=function(e){return r.getScript("/security/security.js",function(){return window.plugins.security.setup(e)})}},{"./plugin":23}],33:[function(e,t,n){"use strict";var u,s,i,c,r,l,f,o,d,a=e("async/queue"),e=e("localforage");t.exports=r={},l={},u={},f={},console.log("siteAdapter: loading data"),(c=e.createInstance({name:"routes"})).iterate(function(e,t,n){l[t]=e}).then(function(){return console.log("siteAdapter: data loaded")}).catch(function(e){return console.log("siteAdapter: error loading data ",e)}),(d=e.createInstance({name:"withCredentials"})).iterate(function(e,t,n){u[t]=e}).then(function(){return console.log("siteAdapter: withCredentials data loaded")}).catch(function(e){return console.log("siteAdapter: error loading withCredentials data ",e)}),o=function(n,e,t){var r=new Promise(function(e,t){var n;return n=setTimeout(function(){return clearTimeout(n),t()},3e3)}),o=new Promise(function(e,t){return $.ajax({type:"GET",url:n,success:function(){return e()},error:function(){return t()}})});return Promise.race([r,o]).then(function(){return e()}).catch(function(){return t()})},i=a(function(e,t){var n,r=e.site;return null!=l[r]&&t(l[r]),n="//".concat(r,"/favicon.png"),o(n,function(){return l[r]="//".concat(r),t("//".concat(r))},function(){switch(location.protocol){case"http:":return n="https://".concat(r,"/favicon.png"),o(n,function(){return l[r]="https://".concat(r),t("https://".concat(r))},function(){return l[r]="",t("")});case"https:":return n="/proxy/".concat(r,"/favicon.png"),o(n,function(){return l[r]="/proxy/".concat(r),t("/proxy/".concat(r))},function(){return l[r]="",t("")});default:return l[r]="",t("")}})},8),s=function(n,r){return c.getItem(n).then(function(e){return console.log("findAdapter: ",n,e),null==e?i.push({site:n},function(t){return l[n]=t,c.setItem(n,t).then(function(e){return r(t)}).catch(function(e){return console.log("findAdapter setItem error: ",n,e),r(t)})}):(l[n]=e,r(e))}).catch(function(e){return console.log("findAdapter error: ",n,e),l[n]="",r("")})},r.local={flag:function(){return"/favicon.png"},getURL:function(e){return"/".concat(e)},getDirectURL:function(e){return"/".concat(e)},get:function(e,n){var t,r=function(e,t){if(n)return n(e,t)};if(console.log("wiki.local.get ".concat(e)),t=localStorage.getItem(e.replace(/\.json$/,""))){if(r(null,t=JSON.parse(t)),!n)return Promise.resolve(t)}else if(r(t={msg:"no page named '".concat(e,"' in browser local storage")},null),console.log("tried to local fetch a page that isn't local"),!n)return Promise.reject(t)},put:function(e,t,n){return console.log("wiki.local.put ".concat(e)),localStorage.setItem(e,JSON.stringify(t)),n()},delete:function(e){return console.log("wiki.local.delete ".concat(e)),localStorage.removeItem(e)}},r.origin={flag:function(){return"/favicon.png"},getURL:function(e){return"/".concat(e)},getDirectURL:function(e){return"/".concat(e)},get:function(e,n){var r=function(e,t){if(n)return n(e,t)};return console.log("wiki.origin.get ".concat(e)),$.ajax({type:"GET",dataType:"json",url:"/".concat(e),success:function(e){return r(null,e)},error:function(e,t,n){return r({msg:n,xhr:e},null)}})},getIndex:function(e,n){var r=function(e,t){if(n)return n(e,t)};return console.log("wiki.origin.get ".concat(e)),$.ajax({type:"GET",dataType:"text",url:"/".concat(e),success:function(e){return r(null,e)},error:function(e,t,n){return r({msg:n,xhr:e},null)}})},put:function(e,t,r){return console.log("wiki.orgin.put ".concat(e)),$.ajax({type:"PUT",url:"/page/".concat(e,"/action"),data:{action:JSON.stringify(t)},success:function(){return r(null)},error:function(e,t,n){return r({xhr:e,type:t,msg:n})}})},delete:function(e,r){return console.log("wiki.origin.delete ".concat(e)),$.ajax({type:"DELETE",url:"/".concat(e),success:function(){return r(null)},error:function(e,t,n){return r({xhr:e,type:t,msg:n})}})}},r.recycler={flag:function(){return"/recycler/favicon.png"},getURL:function(e){return"/recycler/".concat(e)},getDirectURL:function(e){return"/recycler/".concat(e)},get:function(e,n){var r=function(e,t){if(n)return n(e,t)};return console.log("wiki.recycler.get ".concat(e)),$.ajax({type:"GET",dataType:"json",url:"/recycler/".concat(e),success:function(e){return r(null,e)},error:function(e,t,n){return r({msg:n,xhr:e},null)}})},delete:function(e,r){return console.log("wiki.recycler.delete ".concat(e)),$.ajax({type:"DELETE",url:"/recycler/".concat(e),success:function(){return r(null)},error:function(e,t,n){return r({xhr:e,type:t,msg:n})}})}},r.site=function(a){var t;return a&&a!==window.location.host?"recycler"===a?r.recycler:(t=function(e){var t,n,r,o,i,a,u;return console.log("creating temp flag for ".concat(e)),(e=document.createElement("canvas")).width=32,e.height=32,r=e.getContext("2d"),a=o=32*Math.random(),i=32-(u=32*Math.random()),t="#"+(t=(255*Math.random()<<0).toString(16))+t+t,n="#"+(n=(255*Math.random()<<0).toString(16))+n+n,(o=r.createRadialGradient(o,a,32,i,u,0)).addColorStop(0,t),o.addColorStop(1,n),r.fillStyle=o,r.fillRect(0,0,32,32),e.toDataURL()},{flag:function(){var e;return null!=l[a]?""===l[a]?null!=f[a]?f[a]:f[a]=t(a):l[a]+"/favicon.png":null!=f[a]?f[a]:(s(a,function(e){var t;return""===e?console.log("Prefix for ".concat(a," is undetermined...")):(console.log("Prefix for ".concat(a," is ").concat(e)),e=f[a],t=l[a]+"/favicon.png",$('img[src="'+e+'"]').attr("src",t),$('a[target="'+a+'"]').attr("style","background-image: url("+t+")"),f[a]=null)}),e=t(a),f[a]=e)},getURL:function(e){return null!=l[a]?""===l[a]?(console.log("".concat(a," is unreachable, can't link to ").concat(e)),""):"".concat(l[a],"/").concat(e):(s(a,function(t){return""===t?console.log("".concat(a," is unreachable")):(console.log("Prefix for ".concat(a," is ").concat(t,", about to fixup links")),$('a[target="'+a+'"]').each(function(){var e=/proxy/.test(t)?(e=t.substring(7),"http://".concat(e)):t;return $(this).attr("href","".concat(e,"/").concat($(this).data("slug"),".html"))}))}),"")},getDirectURL:function(e){var t,n;return null!=l[a]?""===l[a]?(console.log("".concat(a," is unreachable, can't link to ").concat(e)),""):(t=/proxy/.test(l[a])?(n=l[a].substring(7),"http://".concat(n)):l[a],"".concat(t,"/").concat(e)):(s(a,function(e){return""===e?console.log("".concat(a," is unreachable")):(console.log("Prefix for ".concat(a," is ").concat(e,", about to fixup links")),$('a[target="'+a+'"]').each(function(){return t=/proxy/.test(e)?(n=e.substring(7),"http://".concat(n)):e,$(this).attr("href","".concat(t,"/").concat($(this).data("slug"),".html"))}))}),"")},get:function(t,o){var n,r=function(e,t){if(o)return o(e,t)},i=function(t,r){var n="".concat(l[a],"/").concat(t),e=u[a]||!1;return $.ajax({type:"GET",dataType:"json",url:n,xhrFields:{withCredentials:e},success:function(e){return"Login Required"!==e.title||n.includes("login-required")||!0===u[a]?(r(null,e),o?void 0:Promise.resolve(e)):(u[a]=!0,i(t,function(e,t){return e?u[a]=!1:d.setItem(a,!0),r(e,t)}))},error:function(e,t,n){if(r({msg:n,xhr:e},null),!o)return Promise.reject(n)}})};return null!=l[a]?""!==l[a]?i(t,r):(console.log("".concat(a," is unreachable")),n={msg:"".concat(a," is unreachable"),xhr:{status:0}},r(n,null),o?void 0:Promise.reject(n)):s(a,function(e){return""!==e?i(t,r):(console.log("".concat(a," is unreachable")),n={msg:"".concat(a," is unreachable"),xhr:{status:0}},r(n,null),o?void 0:Promise.reject(n))})},getIndex:function(t,o){var n,r=function(e,t){if(o)return o(e,t)},i=function(t,r){var n="".concat(l[a],"/").concat(t),e=u[a]||!1;return $.ajax({type:"GET",dataType:"text",url:n,xhrFields:{withCredentials:e},success:function(e){return"Login Required"!==e.title||n.includes("login-required")||!0===u[a]?(r(null,e),o?void 0:Promise.resolve(e)):(u[a]=!0,i(t,function(e,t){return e?u[a]=!1:d.setItem(a,!0),r(e,t)}))},error:function(e,t,n){if(r({msg:n,xhr:e},null),!o)return Promise.reject(n)}})};return null!=l[a]?""!==l[a]?i(t,r):(console.log("".concat(a," is unreachable")),n={msg:"".concat(a," is unreachable"),xhr:{status:0}},r(n,null),o?void 0:Promise.reject(n)):s(a,function(e){return""!==e?i(t,r):(console.log("".concat(a," is unreachable")),n={msg:"".concat(a," is unreachable"),xhr:{status:0}},r(n,null),o?void 0:Promise.reject(n))})},refresh:function(n){var r,o;return console.log("Refreshing ".concat(a)),null==f[a]&&(o=t(a),f[a]=o,r=l[a]+"/favicon.png",$('img[src="'+r+'"]').attr("src",o),$('a[target="'+a+'"]').attr("style","background-image: url("+o+")")),l[a]=null,c.removeItem(a).then(function(){return i.push({site:a},function(t){return c.setItem(a,t).then(function(e){return""===t?console.log("Refreshed prefix for ".concat(a," is undetermined...")):(console.log("Refreshed prefix for ".concat(a," is ").concat(t)),o=f[a],r=l[a]+"/favicon.png",$('img[src="'+o+'"]').attr("src",r),$('a[target="'+a+'"]').attr("style","background-image: url("+r+")")),n()}).catch(function(e){return console.log("findAdapter setItem error: ",a,e),l[a]="",n()})})}).catch(function(e){return console.log("refresh error ",a,e),n()})}}):r.origin}},{"async/queue":46,localforage:56}],34:[function(e,t,n){"use strict";var d,s=[].indexOf,h=e("./active"),p=e("./lineup"),g=null;t.exports=d={},d.inject=function(e){return g=e},d.pagesInDom=function(){return $.makeArray($(".page").map(function(e,t){return t.id}))},d.urlPages=function(){var o;return function(){for(var e=$(location).attr("pathname").split("/"),t=[],n=0,r=e.length;n<r;n+=2)o=e[n],t.push(o);return t}().slice(1)},d.locsInDom=function(){return $.makeArray($(".page").map(function(e,t){return $(t).data("site")||"view"}))},d.urlLocs=function(){for(var e,t=$(location).attr("pathname").split("/").slice(1),n=[],r=0,o=t.length;r<o;r+=2)e=t[r],n.push(e);return n},d.setUrl=function(){var r,o,i,a,e;if(document.title=p.bestTitle(),history&&history.pushState&&(o=d.locsInDom(),a=d.pagesInDom(),(e=function(){var e,t,n=[];for(r=e=0,t=a.length;e<t;r=++e)i=a[r],n.push("/".concat((null!=o?o[r]:void 0)||"view","/").concat(i));return n}().join(""))!==$(location).attr("pathname")))return history.pushState(null,null,e)},d.debugStates=function(){var o;return console.log("a .page keys ",function(){for(var e=$(".page"),t=[],n=0,r=e.length;n<r;n++)o=e[n],t.push($(o).data("key"));return t}()),console.log("a lineup keys",p.debugKeys())},d.show=function(e){var t,n,r,o,i,a,u,s,c=d.pagesInDom(),l=d.urlPages(),f=(d.locsInDom(),d.urlLocs());if(location.pathname&&"/"!==location.pathname){for(a=!0,t=n=0,o=c.length;n<o;t=++n)u=c[t],(a=a&&u===l[t])||(s=$(".page:last"),p.removeKey(s.data("key")),s.remove());for(a=!0,t=r=0,i=l.length;r<i;t=++r)u=l[t],(a=a&&u===c[t])||(console.log("push",t,u),g.showPage(u,f[t]));return d.debugStates(),h.set($(".page").last()),document.title=p.bestTitle()}},d.first=function(){var e,t,n,r,o,i,a,u;for(d.setUrl(),t=d.urlPages(),e=d.urlLocs(),i=d.pagesInDom(),a=[],n=r=0,o=t.length;r<o;n=++r)u=t[n],s.call(i,u)<0&&(""!==u?a.push(g.createPage(u,e[n])):a.push(void 0));return a}},{"./active":3,"./lineup":16}],35:[function(e,t,n){"use strict";t.exports=function(e){var t,n,r=e.synopsis;return(r=(r=null!=e&&null!=e.story?(t=e.story[0],n=e.story[1],t&&"paragraph"===t.type&&(r=r||t.text),n&&"paragraph"===n.type&&(r=r||n.text),t&&null!=t.text&&(r=r||t.text),(r=n&&null!=n.text?r||n.text:r)||null!=e.story&&"A page with ".concat(e.story.length," items.")):"A page with no story.").trim().split(/\r|\n/,1)[0]).substring(0,560)}},{}],36:[function(e,t,n){"use strict";function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,u=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){u=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(u)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(n="Object"===n&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var i=!1,a=null,u=null,s=null,c=null,l=function(e){if((i=e.shiftKey)&&($(".emit").addClass("highlight"),(e=a||s)&&$("[data-id=".concat(e,"]")).addClass("target"),u&&(c=u.consuming)))return c.forEach(function(e){return h(e).addClass("consumed")})},f=function(e){if(!(i=e.shiftKey))return $(".emit").removeClass("highlight"),$(".item, .action").removeClass("target"),$(".item").removeClass("consumed")},d=function(n){var e=$(".page").filter(function(e,t){return $(t).data("key")===n});return 0===e.length?null:(1<e.length&&console.log("warning: more than one page found for",key,e),e)},h=function(e){var t=r(e.split("/"),2),n=t[0],t=t[1],n=d(n);return!n||0===(n=n.find(".item[data-id=".concat(t,"]"))).length?null:(1<n.length&&console.log("warning: more than one item found for",e,n),n)},p=function(e){var t,n;if(a=(n=$(this)).attr("data-id"),u=n[0],i&&($("[data-id=".concat(a,"]")).addClass("target"),t=$(this).parents(".page:first").data("key"),n=n.offset().top,$(".page").trigger("align-item",{key:t,id:a,place:n}),c=u.consuming))return c.forEach(function(e){return h(e).addClass("consumed")})},g=function(e){return i&&($(".item, .action").removeClass("target"),$(".item").removeClass("consumed")),u=a=null},v=function(e){var t;if(s=$(this).data("id"),i)return $("[data-id=".concat(s,"]")).addClass("target"),t=$(this).parents(".page:first").data("key"),$(".page").trigger("align-item",{key:t,id:s})},m=function(e){return i&&$("[data-id=".concat(s,"]")).removeClass("target"),s=null},y=function(e){var t,n;if(a=(n=$(this)).attr("data-id"),u=n[0],i)return $("[data-id=".concat(a,"]")).addClass("target"),t=$(this).parents(".page:first").data("key"),n=n.offset().top,$(".page").trigger("align-item",{key:t,id:a,place:n})},b=function(e){return i&&$(".item, .action").removeClass("target"),u=a=null},w=function(e,t){var n,r=$(this);if(r.data("key")!==t.key&&(n=r.find(".item[data-id=".concat(t.id,"]"))).length)return t=t.place||r.height()/2,n=n.offset().top+r.scrollTop()-t,r.stop().animate({scrollTop:n},"slow")};t.exports={bind:function(){return $(document).keydown(function(e){if(16===e.keyCode)return l(e)}).keyup(function(e){if(16===e.keyCode)return f(e)}),$(".main").delegate(".item","mouseenter",p).delegate(".item","mouseleave",g).delegate(".action","mouseenter",v).delegate(".action","mouseleave",m).delegate(".page","align-item",w).delegate(".backlinks .remote","mouseenter",y).delegate(".backlinks .remote","mouseleave",b)}}},{}],37:[function(e,t,n){"use strict";t.exports=t={},t.formatTime=function(e){var t,e=new Date(1e10<e?e:1e3*e),n=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e.getMonth()],r=e.getHours(),o=r<12?"AM":"PM";return r=0===r?12:12<r?r-12:r,t=(e.getMinutes()<10?"0":"")+e.getMinutes(),"".concat(r,":").concat(t," ").concat(o,"<br>").concat(e.getDate()," ").concat(n," ").concat(e.getFullYear())},t.formatDate=function(e){var t,e=new Date(e),n=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][e.getDay()],r=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e.getMonth()],o=e.getDate(),i=e.getFullYear(),a=e.getHours(),u=a<12?"AM":"PM";return a=0===a?12:12<a?a-12:a,t=(e.getMinutes()<10?"0":"")+e.getMinutes(),e=(e.getSeconds()<10?"0":"")+e.getSeconds(),"".concat(n," ").concat(r," ").concat(o,", ").concat(i,"<br>").concat(a,":").concat(t,":").concat(e," ").concat(u)},t.formatElapsedTime=function(e){var t,n,e=(new Date).getTime()-e;return(n=e/1e3)<2?"".concat(Math.floor(e)," milliseconds ago"):(e=n/60)<2?"".concat(Math.floor(n)," seconds ago"):(n=e/60)<2?"".concat(Math.floor(e)," minutes ago"):(e=n/24)<2?"".concat(Math.floor(n)," hours ago"):(n=e/7)<2?"".concat(Math.floor(e)," days ago"):(t=e/31)<2?"".concat(Math.floor(n)," weeks ago"):(n=e/365)<2?"".concat(Math.floor(t)," months ago"):"".concat(Math.floor(n)," years ago")}},{}],38:[function(e,t,n){"use strict";var r={},o=e("./siteAdapter");r.local=o.local,r.origin=o.origin,r.recycler=o.recycler,r.site=o.site,r.asSlug=e("./page").asSlug,r.newPage=e("./page").newPage,o=e("./itemz"),r.removeItem=o.removeItem,r.createItem=o.createItem,r.getItem=o.getItem,o=e("./dialog"),r.dialog=o.open,o=e("./link"),r.createPage=o.createPage,r.doInternalLink=o.doInternalLink,r.showResult=o.showResult,o=e("./plugin"),r.getScript=o.getScript,r.getPlugin=o.getPlugin,r.doPlugin=o.doPlugin,r.registerPlugin=o.registerPlugin,r.getData=function(e){var t;return e?(e=$(".item").index(e),null!=(t=$(".item:lt(".concat(e,")")).filter(".chart,.data,.calculator").last())?t.data("item").data:{}):null!=(t=$(".chart,.data,.calculator").last())?t.data("item").data:{}},r.getDataNodes=function(e){e=e?(e=$(".item").index(e),$(".item:lt(".concat(e,")")).filter(".chart,.data,.calculator").toArray().reverse()):$(".chart,.data,.calculator").toArray().reverse();return $(e)},r.log=function(){var e;if(null!=("undefined"!=typeof console&&null!==console?console.log:void 0))return(e=console).log.apply(e,arguments)},o=e("./neighborhood"),r.neighborhood=o.sites,r.neighborhoodObject=o,o=e("./pageHandler"),r.pageHandler=o,r.useLocalStorage=o.useLocalStorage,o=e("./resolve"),r.resolveFrom=o.resolveFrom,r.resolveLinks=o.resolveLinks,r.resolutionContext=o.resolutionContext,o=e("./editor"),r.textEditor=o.textEditor,r.util=e("./util"),r.security=e("./security"),r.createSynopsis=e("./synopsis"),r.lineup=e("./lineup"),t.exports=r},{"./dialog":6,"./editor":8,"./itemz":13,"./lineup":16,"./link":17,"./neighborhood":18,"./page":20,"./pageHandler":21,"./plugin":23,"./resolve":28,"./security":32,"./siteAdapter":33,"./synopsis":35,"./util":37}],39:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(r){if((0,i.isAsync)(r))return function(...e){var t=e.pop();return u(r.apply(this,e),t)};return(0,o.default)(function(e,t){var n;try{n=r.apply(this,e)}catch(e){return t(e)}if(n&&"function"==typeof n.then)return u(n,t);t(null,n)})};var o=a(e("./internal/initialParams.js")),r=a(e("./internal/setImmediate.js")),i=e("./internal/wrapAsync.js");function a(e){return e&&e.__esModule?e:{default:e}}function u(e,t){return e.then(e=>{s(t,null,e)},e=>{s(t,e&&e.message?e:new Error(e))})}function s(e,t,n){try{e(t,n)}catch(e){(0,r.default)(e=>{throw e},e)}}t.exports=n.default},{"./internal/initialParams.js":41,"./internal/setImmediate.js":44,"./internal/wrapAsync.js":45}],40:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});class r{constructor(){this.head=this.tail=null,this.length=0}removeLink(e){return e.prev?e.prev.next=e.next:this.head=e.next,e.next?e.next.prev=e.prev:this.tail=e.prev,e.prev=e.next=null,--this.length,e}empty(){for(;this.head;)this.shift();return this}insertAfter(e,t){t.prev=e,t.next=e.next,e.next?e.next.prev=t:this.tail=t,e.next=t,this.length+=1}insertBefore(e,t){t.prev=e.prev,(t.next=e).prev?e.prev.next=t:this.head=t,e.prev=t,this.length+=1}unshift(e){this.head?this.insertBefore(this.head,e):o(this,e)}push(e){this.tail?this.insertAfter(this.tail,e):o(this,e)}shift(){return this.head&&this.removeLink(this.head)}pop(){return this.tail&&this.removeLink(this.tail)}toArray(){return[...this]}*[Symbol.iterator](){for(var e=this.head;e;)yield e.data,e=e.next}remove(e){for(var t=this.head;t;){var n=t["next"];e(t)&&this.removeLink(t),t=n}return this}}function o(e,t){e.length=1,e.head=e.tail=t}n.default=r,t.exports=n.default},{}],41:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(n){return function(...e){var t=e.pop();return n.call(this,e,t)}},t.exports=n.default},{}],42:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(n){return function(...e){if(null===n)throw new Error("Callback was already called.");var t=n;n=null,t.apply(this,e)}},t.exports=n.default},{}],43:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e,t,n){if(null==t)t=1;else if(0===t)throw new RangeError("Concurrency must not be zero");var a=(0,m.default)(e),u=0,s=[];const c={error:[],drain:[],saturated:[],unsaturated:[],empty:[]};function l(e,t){return e?t?void(c[e]=c[e].filter(e=>e!==t)):c[e]=[]:Object.keys(c).forEach(e=>c[e]=[])}function f(e,...t){c[e].forEach(e=>e(...t))}var d=!1;function r(e,t,n,r){if(null!=r&&"function"!=typeof r)throw new Error("task callback must be a function");var o,i;function a(e,...t){return e?n?i(e):o():t.length<=1?o(t[0]):void o(t)}p.started=!0;e={data:e,callback:!n&&r||a};if(t?p._tasks.unshift(e):p._tasks.push(e),d||(d=!0,(0,v.default)(()=>{d=!1,p.process()})),n||!r)return new Promise((e,t)=>{o=e,i=t})}function o(e){return 0===e.length&&p.idle()&&((0,v.default)(()=>f("drain")),1)}e=a=>e=>{if(!e)return new Promise((n,r)=>{{var t=a,o=(e,t)=>{if(e)return r(e);n(t)};const i=(...e)=>{l(t,i),o(...e)};return void c[t].push(i)}});var t;l(a),t=a,e=e,c[t].push(e)};var h=!1,p={_tasks:new i.default,*[Symbol.iterator](){yield*p._tasks[Symbol.iterator]()},concurrency:t,payload:n,buffer:t/4,started:!1,paused:!1,push(e,t){return Array.isArray(e)?o(e)?void 0:e.map(e=>r(e,!1,!1,t)):r(e,!1,!1,t)},pushAsync(e,t){return Array.isArray(e)?o(e)?void 0:e.map(e=>r(e,!1,!0,t)):r(e,!1,!0,t)},kill(){l(),p._tasks.empty()},unshift(e,t){return Array.isArray(e)?o(e)?void 0:e.map(e=>r(e,!0,!1,t)):r(e,!0,!1,t)},unshiftAsync(e,t){return Array.isArray(e)?o(e)?void 0:e.map(e=>r(e,!0,!0,t)):r(e,!0,!0,t)},remove(e){p._tasks.remove(e)},process(){if(!h){for(h=!0;!p.paused&&u<p.concurrency&&p._tasks.length;){var e=[],t=[],n=p._tasks.length;p.payload&&(n=Math.min(n,p.payload));for(var r=0;r<n;r++){var o=p._tasks.shift();e.push(o),s.push(o),t.push(o.data)}u+=1,0===p._tasks.length&&f("empty"),u===p.concurrency&&f("saturated");var i=(0,g.default)(function(a){return function(e,...t){--u;for(var n=0,r=a.length;n<r;n++){var o=a[n],i=s.indexOf(o);0===i?s.shift():0<i&&s.splice(i,1),o.callback(e,...t),null!=e&&f("error",e,o.data)}u<=p.concurrency-p.buffer&&f("unsaturated"),p.idle()&&f("drain"),p.process()}}(e));a(t,i)}h=!1}},length(){return p._tasks.length},running(){return u},workersList(){return s},idle(){return p._tasks.length+u===0},pause(){p.paused=!0},resume(){!1!==p.paused&&(p.paused=!1,v.default)(p.process)}};return Object.defineProperties(p,{saturated:{writable:!1,value:e("saturated")},unsaturated:{writable:!1,value:e("unsaturated")},empty:{writable:!1,value:e("empty")},drain:{writable:!1,value:e("drain")},error:{writable:!1,value:e("error")}}),p};var g=r(e("./onlyOnce.js")),v=r(e("./setImmediate.js")),i=r(e("./DoublyLinkedList.js")),m=r(e("./wrapAsync.js"));function r(e){return e&&e.__esModule?e:{default:e}}t.exports=n.default},{"./DoublyLinkedList.js":40,"./onlyOnce.js":42,"./setImmediate.js":44,"./wrapAsync.js":45}],44:[function(e,t,u){!function(i,a){!function(){"use strict";Object.defineProperty(u,"__esModule",{value:!0}),u.fallback=r,u.wrap=o;var e=u.hasQueueMicrotask="function"==typeof queueMicrotask&&queueMicrotask,t=u.hasSetImmediate="function"==typeof a&&a,n=u.hasNextTick="object"==typeof i&&"function"==typeof i.nextTick;function r(e){setTimeout(e,0)}function o(n){return(e,...t)=>n(()=>e(...t))}e=e?queueMicrotask:t?a:n?i.nextTick:r,u.default=o(e)}.call(this)}.call(this,e("_process"),e("timers").setImmediate)},{_process:48,timers:53}],45:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.isAsyncIterable=n.isAsyncGenerator=n.isAsync=void 0;var e=e("../asyncify.js"),r=(e=e)&&e.__esModule?e:{default:e};function o(e){return"AsyncFunction"===e[Symbol.toStringTag]}n.default=function(e){if("function"!=typeof e)throw new Error("expected a function");return o(e)?(0,r.default)(e):e},n.isAsync=o,n.isAsyncGenerator=function(e){return"AsyncGenerator"===e[Symbol.toStringTag]},n.isAsyncIterable=function(e){return"function"==typeof e[Symbol.asyncIterator]}},{"../asyncify.js":39}],46:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e,t){var n=(0,o.default)(e);return(0,r.default)((e,t)=>{n(e[0],t)},t,1)};var r=i(e("./internal/queue.js")),o=i(e("./internal/wrapAsync.js"));function i(e){return e&&e.__esModule?e:{default:e}}t.exports=n.default},{"./internal/queue.js":43,"./internal/wrapAsync.js":45}],47:[function(e,t,n){"use strict";var r="object"==typeof Reflect?Reflect:null,s=r&&"function"==typeof r.apply?r.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};var o=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)},i=Number.isNaN||function(e){return e!=e};function a(){a.init.call(this)}t.exports=a,t.exports.once=function(u,s){return new Promise(function(e,t){function n(e){u.removeListener(s,r),t(e)}function r(){"function"==typeof u.removeListener&&u.removeListener("error",n),e([].slice.call(arguments))}var o,i,a;v(u,s,r,{once:!0}),"error"!==s&&(i=n,a={once:!0},"function"==typeof(o=u).on&&v(o,"error",i,a))})},(a.EventEmitter=a).prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var u=10;function c(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function l(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function f(e,t,n,r){var o,i;return c(n),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener||n),o=e._events),i=o[t]),void 0===i?(i=o[t]=n,++e._eventsCount):("function"==typeof i?i=o[t]=r?[n,i]:[i,n]:r?i.unshift(n):i.push(n),0<(o=l(e))&&i.length>o&&!i.warned&&(i.warned=!0,(r=new Error("Possible EventEmitter memory leak detected. "+i.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit")).name="MaxListenersExceededWarning",r.emitter=e,r.type=t,r.count=i.length,n=r,console&&console.warn&&console.warn(n))),e}function d(e,t,n){e={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},t=function(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}.bind(e);return t.listener=n,e.wrapFn=t}function h(e,t,n){e=e._events;if(void 0===e)return[];e=e[t];{if(void 0===e)return[];if("function"==typeof e)return n?[e.listener||e]:[e];if(n){for(var r=e,o=new Array(r.length),i=0;i<o.length;++i)o[i]=r[i].listener||r[i];return o}return g(e,e.length)}}function p(e){var t=this._events;if(void 0!==t){t=t[e];if("function"==typeof t)return 1;if(void 0!==t)return t.length}return 0}function g(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function v(n,r,o,i){if("function"==typeof n.on)i.once?n.once(r,o):n.on(r,o);else{if("function"!=typeof n.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof n);n.addEventListener(r,function e(t){i.once&&n.removeEventListener(r,e),o(t)})}}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");u=e}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return l(this)},a.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,o=this._events;if(void 0!==o)r=r&&void 0===o.error;else if(!r)return!1;if(r){if((i=0<t.length?t[0]:i)instanceof Error)throw i;r=new Error("Unhandled error."+(i?" ("+i.message+")":""));throw r.context=i,r}var i=o[e];if(void 0===i)return!1;if("function"==typeof i)s(i,this,t);else for(var a=i.length,u=g(i,a),n=0;n<a;++n)s(u[n],this,t);return!0},a.prototype.on=a.prototype.addListener=function(e,t){return f(this,e,t,!1)},a.prototype.prependListener=function(e,t){return f(this,e,t,!0)},a.prototype.once=function(e,t){return c(t),this.on(e,d(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){return c(t),this.prependListener(e,d(this,e,t)),this},a.prototype.off=a.prototype.removeListener=function(e,t){var n,r,o,i,a;if(c(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(o=-1,i=n.length-1;0<=i;i--)if(n[i]===t||n[i].listener===t){a=n[i].listener,o=i;break}if(o<0)return this;if(0===o)n.shift();else{for(var u=n,s=o;s+1<u.length;s++)u[s]=u[s+1];u.pop()}1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,a||t)}return this},a.prototype.removeAllListeners=function(e){var t,n=this._events;if(void 0===n)return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){for(var r,o=Object.keys(n),i=0;i<o.length;++i)"removeListener"!==(r=o[i])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;0<=i;i--)this.removeListener(e,t[i]);return this},a.prototype.listeners=function(e){return h(this,e,!0)},a.prototype.rawListeners=function(e){return h(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):p.call(e,t)},a.prototype.listenerCount=p,a.prototype.eventNames=function(){return 0<this._eventsCount?o(this._events):[]}},{}],48:[function(e,t,n){var r,o,t=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}try{r="function"==typeof setTimeout?setTimeout:i}catch(e){r=i}try{o="function"==typeof clearTimeout?clearTimeout:a}catch(e){o=a}function u(t){if(r===setTimeout)return setTimeout(t,0);if((r===i||!r)&&setTimeout)return(r=setTimeout)(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}var s,c=[],l=!1,f=-1;function d(){l&&s&&(l=!1,s.length?c=s.concat(c):f=-1,c.length&&h())}function h(){if(!l){for(var e=u(d),t=(l=!0,c.length);t;){for(s=c,c=[];++f<t;)s&&s[f].run();f=-1,t=c.length}s=null,l=!1,!function(t){if(o===clearTimeout)return clearTimeout(t);if((o===a||!o)&&clearTimeout)return(o=clearTimeout)(t);try{o(t)}catch(e){try{return o.call(null,t)}catch(e){return o.call(this,t)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function g(){}t.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new p(e,t)),1!==c.length||l||u(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={},t.on=g,t.addListener=g,t.once=g,t.off=g,t.removeListener=g,t.removeAllListeners=g,t.emit=g,t.prependListener=g,t.prependOnceListener=g,t.listeners=function(e){return[]},t.binding=function(e){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(e){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}},{}],49:[function(e,A,$){!function(E){!function(){var e=this,t="object"==typeof $&&$&&!$.nodeType&&$,n="object"==typeof A&&A&&!A.nodeType&&A,r="object"==typeof E&&E;r.global!==r&&r.window!==r&&r.self!==r||(e=r);var o,i,v=2147483647,m=36,y=26,a=38,u=700,s=/^xn--/,c=/[^\x20-\x7E]/,l=/[\x2E\u3002\uFF0E\uFF61]/g,f={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},d=m-1,b=Math.floor,w=String.fromCharCode;function x(e){throw new RangeError(f[e])}function h(e,t){for(var n=e.length,r=[];n--;)r[n]=t(e[n]);return r}function p(e,t){var n=e.split("@"),r="",n=(1<n.length&&(r=n[0]+"@",e=n[1]),(e=e.replace(l,".")).split("."));return r+h(n,t).join(".")}function k(e){for(var t,n,r=[],o=0,i=e.length;o<i;)55296<=(t=e.charCodeAt(o++))&&t<=56319&&o<i?56320==(64512&(n=e.charCodeAt(o++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),o--):r.push(t);return r}function g(e){return h(e,function(e){var t="";return 65535<e&&(t+=w((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=w(e)}).join("")}function _(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function j(e,t,n){var r=0;for(e=n?b(e/u):e>>1,e+=b(e/t);d*y>>1<e;r+=m)e=b(e/d);return b(r+(d+1)*e/(e+a))}function I(e){var t,n,r,o,i,a,u,s=[],c=e.length,l=0,f=128,d=72,h=e.lastIndexOf("-");for(h<0&&(h=0),n=0;n<h;++n)128<=e.charCodeAt(n)&&x("not-basic"),s.push(e.charCodeAt(n));for(r=0<h?h+1:0;r<c;){for(o=l,i=1,a=m;c<=r&&x("invalid-input"),u=e.charCodeAt(r++),(m<=(u=u-48<10?u-22:u-65<26?u-65:u-97<26?u-97:m)||u>b((v-l)/i))&&x("overflow"),l+=u*i,!(u<(u=a<=d?1:d+y<=a?y:a-d));a+=m)i>b(v/(u=m-u))&&x("overflow"),i*=u;d=j(l-o,t=s.length+1,0==o),b(l/t)>v-f&&x("overflow"),f+=b(l/t),l%=t,s.splice(l++,0,f)}return g(s)}function S(e){for(var t,n,r,o,i,a,u,s,c,l,f=[],d=(e=k(e)).length,h=128,p=72,g=t=0;g<d;++g)(u=e[g])<128&&f.push(w(u));for(n=r=f.length,r&&f.push("-");n<d;){for(o=v,g=0;g<d;++g)h<=(u=e[g])&&u<o&&(o=u);for(o-h>b((v-t)/(s=n+1))&&x("overflow"),t+=(o-h)*s,h=o,g=0;g<d;++g)if((u=e[g])<h&&++t>v&&x("overflow"),u==h){for(i=t,a=m;!(i<(c=a<=p?1:p+y<=a?y:a-p));a+=m)f.push(w(_(c+(l=i-c)%(c=m-c),0))),i=b(l/c);f.push(w(_(i,0))),p=j(t,s,n==r),t=0,++n}++t,++h}return f.join("")}if(o={version:"1.4.1",ucs2:{decode:k,encode:g},decode:I,encode:S,toASCII:function(e){return p(e,function(e){return c.test(e)?"xn--"+S(e):e})},toUnicode:function(e){return p(e,function(e){return s.test(e)?I(e.slice(4).toLowerCase()):e})}},"function"==typeof define&&"object"==typeof define.amd&&define.amd)define("punycode",function(){return o});else if(t&&n)if(A.exports==t)n.exports=o;else for(i in o)o.hasOwnProperty(i)&&(t[i]=o[i]);else e.punycode=o}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],50:[function(e,t,n){"use strict";t.exports=function(e,t,n,r){n=n||"=";var o={};if("string"!=typeof e||0===e.length)return o;var i=/\+/g,t=(e=e.split(t=t||"&"),1e3),a=(r&&"number"==typeof r.maxKeys&&(t=r.maxKeys),e.length);0<t&&t<a&&(a=t);for(var u=0;u<a;++u){var s,c=e[u].replace(i,"%20"),l=c.indexOf(n),l=0<=l?(s=c.substr(0,l),c.substr(l+1)):(s=c,""),c=decodeURIComponent(s),l=decodeURIComponent(l);Object.prototype.hasOwnProperty.call(o,c)?f(o[c])?o[c].push(l):o[c]=[o[c],l]:o[c]=l}return o};var f=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},{}],51:[function(e,t,n){"use strict";function i(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}}t.exports=function(n,r,o,e){return r=r||"&",o=o||"=","object"==typeof(n=null===n?void 0:n)?u(s(n),function(e){var t=encodeURIComponent(i(e))+o;return a(n[e])?u(n[e],function(e){return t+encodeURIComponent(i(e))}).join(r):t+encodeURIComponent(i(n[e]))}).join(r):e?encodeURIComponent(i(e))+o+encodeURIComponent(i(n)):""};var a=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function u(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r));return n}var s=Object.keys||function(e){var t,n=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.push(t);return n}},{}],52:[function(e,t,n){"use strict";n.decode=n.parse=e("./decode"),n.encode=n.stringify=e("./encode")},{"./decode":50,"./encode":51}],53:[function(s,e,c){!function(n,u){!function(){var r=s("process/browser.js").nextTick,e=Function.prototype.apply,o=Array.prototype.slice,i={},a=0;function t(e,t){this._id=e,this._clearFn=t}c.setTimeout=function(){return new t(e.call(setTimeout,window,arguments),clearTimeout)},c.setInterval=function(){return new t(e.call(setInterval,window,arguments),clearInterval)},c.clearTimeout=c.clearInterval=function(e){e.close()},t.prototype.unref=t.prototype.ref=function(){},t.prototype.close=function(){this._clearFn.call(window,this._id)},c.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},c.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},c._unrefActive=c.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;0<=t&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},c.setImmediate="function"==typeof n?n:function(e){var t=a++,n=!(arguments.length<2)&&o.call(arguments,1);return i[t]=!0,r(function(){i[t]&&(n?e.apply(null,n):e.call(null),c.clearImmediate(t))}),t},c.clearImmediate="function"==typeof u?u:function(e){delete i[e]}}.call(this)}.call(this,s("timers").setImmediate,s("timers").clearImmediate)},{"process/browser.js":48,timers:53}],54:[function(e,t,n){"use strict";var _=e("punycode"),j=e("./util");function x(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}n.parse=o,n.resolve=function(e,t){return o(e,!1,!0).resolve(t)},n.resolveObject=function(e,t){return e?o(e,!1,!0).resolveObject(t):t},n.format=function(e){j.isString(e)&&(e=o(e));return e instanceof x?e.format():x.prototype.format.call(e)},n.Url=x;var I=/^([a-z0-9.+-]+:)/i,r=/:[0-9]*$/,S=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,n=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),E=["'"].concat(n),A=["%","/","?",";","#"].concat(E),$=["/","?","#"],C=/^[+a-z0-9A-Z_-]{0,63}$/,O=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,F={javascript:!0,"javascript:":!0},T={javascript:!0,"javascript:":!0},L={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},R=e("querystring");function o(e,t,n){if(e&&j.isObject(e)&&e instanceof x)return e;var r=new x;return r.parse(e,t,n),r}x.prototype.parse=function(e,t,n){if(!j.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var r=e.indexOf("?"),r=-1!==r&&r<e.indexOf("#")?"?":"#",o=e.split(r);o[0]=o[0].replace(/\\/g,"/");var i=(i=e=o.join(r)).trim();if(!n&&1===e.split("#").length){o=S.exec(i);if(o)return this.path=i,this.href=i,this.pathname=o[1],o[2]?(this.search=o[2],this.query=t?R.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var a,r=I.exec(i);if(r&&(a=(r=r[0]).toLowerCase(),this.protocol=a,i=i.substr(r.length)),!(n||r||i.match(/^\/\/[^@\/]+@[^@\/]+/))||!(w="//"===i.substr(0,2))||r&&T[r]||(i=i.substr(2),this.slashes=!0),!T[r]&&(w||r&&!L[r])){for(var u=-1,s=0;s<$.length;s++)-1!==(c=i.indexOf($[s]))&&(-1===u||c<u)&&(u=c);-1!==(e=-1===u?i.lastIndexOf("@"):i.lastIndexOf("@",u))&&(o=i.slice(0,e),i=i.slice(e+1),this.auth=decodeURIComponent(o));for(var c,u=-1,s=0;s<A.length;s++)-1!==(c=i.indexOf(A[s]))&&(-1===u||c<u)&&(u=c);-1===u&&(u=i.length),this.host=i.slice(0,u),i=i.slice(u),this.parseHost(),this.hostname=this.hostname||"";n="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!n)for(var l=this.hostname.split(/\./),s=0,f=l.length;s<f;s++){var d=l[s];if(d&&!d.match(C)){for(var h="",p=0,g=d.length;p<g;p++)127<d.charCodeAt(p)?h+="x":h+=d[p];if(!h.match(C)){var v=l.slice(0,s),m=l.slice(s+1),y=d.match(O);y&&(v.push(y[1]),m.unshift(y[2])),m.length&&(i="/"+m.join(".")+i),this.hostname=v.join(".");break}}}255<this.hostname.length?this.hostname="":this.hostname=this.hostname.toLowerCase(),n||(this.hostname=_.toASCII(this.hostname));var b=this.port?":"+this.port:"",w=this.hostname||"";this.host=w+b,this.href+=this.host,n&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==i[0]&&(i="/"+i))}if(!F[a])for(s=0,f=E.length;s<f;s++){var x,k=E[s];-1!==i.indexOf(k)&&((x=encodeURIComponent(k))===k&&(x=escape(k)),i=i.split(k).join(x))}r=i.indexOf("#"),-1!==r&&(this.hash=i.substr(r),i=i.slice(0,r)),e=i.indexOf("?");return-1!==e?(this.search=i.substr(e),this.query=i.substr(e+1),t&&(this.query=R.parse(this.query)),i=i.slice(0,e)):t&&(this.search="",this.query={}),i&&(this.pathname=i),L[a]&&this.hostname&&!this.pathname&&(this.pathname="/"),(this.pathname||this.search)&&(b=this.pathname||"",o=this.search||"",this.path=b+o),this.href=this.format(),this},x.prototype.format=function(){var e=this.auth||"",t=(e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@"),this.protocol||""),n=this.pathname||"",r=this.hash||"",o=!1,i="",e=(this.host?o=e+this.host:this.hostname&&(o=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&j.isObject(this.query)&&Object.keys(this.query).length&&(i=R.stringify(this.query)),this.search||i&&"?"+i||"");return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||L[t])&&!1!==o?(o="//"+(o||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):o=o||"",r&&"#"!==r.charAt(0)&&(r="#"+r),e&&"?"!==e.charAt(0)&&(e="?"+e),t+o+(n=n.replace(/[?#]/g,function(e){return encodeURIComponent(e)}))+(e=e.replace("#","%23"))+r},x.prototype.resolve=function(e){return this.resolveObject(o(e,!1,!0)).format()},x.prototype.resolveObject=function(e){j.isString(e)&&((d=new x).parse(e,!1,!0),e=d);for(var t=new x,n=Object.keys(this),r=0;r<n.length;r++){var o=n[r];t[o]=this[o]}if(t.hash=e.hash,""===e.href)return t.href=t.format(),t;if(e.slashes&&!e.protocol){for(var i=Object.keys(e),a=0;a<i.length;a++){var u=i[a];"protocol"!==u&&(t[u]=e[u])}return L[t.protocol]&&t.hostname&&!t.pathname&&(t.path=t.pathname="/"),t.href=t.format(),t}if(e.protocol&&e.protocol!==t.protocol){if(!L[e.protocol]){for(var s=Object.keys(e),c=0;c<s.length;c++){var l=s[c];t[l]=e[l]}return t.href=t.format(),t}if(t.protocol=e.protocol,e.host||T[e.protocol])t.pathname=e.pathname;else{for(var f=(e.pathname||"").split("/");f.length&&!(e.host=f.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==f[0]&&f.unshift(""),f.length<2&&f.unshift(""),t.pathname=f.join("/")}return t.search=e.search,t.query=e.query,t.host=e.host||"",t.auth=e.auth,t.hostname=e.hostname||e.host,t.port=e.port,(t.pathname||t.search)&&(d=t.pathname||"",h=t.search||"",t.path=d+h),t.slashes=t.slashes||e.slashes,t.href=t.format(),t}var d=t.pathname&&"/"===t.pathname.charAt(0),h=e.host||e.pathname&&"/"===e.pathname.charAt(0),d=h||d||t.host&&e.pathname,p=d,g=t.pathname&&t.pathname.split("/")||[],f=e.pathname&&e.pathname.split("/")||[],v=t.protocol&&!L[t.protocol];if(v&&(t.hostname="",t.port=null,t.host&&(""===g[0]?g[0]=t.host:g.unshift(t.host)),t.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===f[0]?f[0]=e.host:f.unshift(e.host)),e.host=null),d=d&&(""===f[0]||""===g[0])),h)t.host=(e.host||""===e.host?e:t).host,t.hostname=(e.hostname||""===e.hostname?e:t).hostname,t.search=e.search,t.query=e.query,g=f;else if(f.length)(g=g||[]).pop(),g=g.concat(f),t.search=e.search,t.query=e.query;else if(!j.isNullOrUndefined(e.search))return v&&(t.hostname=t.host=g.shift(),(w=!!(t.host&&0<t.host.indexOf("@"))&&t.host.split("@"))&&(t.auth=w.shift(),t.host=t.hostname=w.shift())),t.search=e.search,t.query=e.query,j.isNull(t.pathname)&&j.isNull(t.search)||(t.path=(t.pathname||"")+(t.search||"")),t.href=t.format(),t;if(!g.length)return t.pathname=null,t.search?t.path="/"+t.search:t.path=null,t.href=t.format(),t;for(var m=g.slice(-1)[0],h=(t.host||e.host||1<g.length)&&("."===m||".."===m)||""===m,y=0,b=g.length;0<=b;b--)"."===(m=g[b])?g.splice(b,1):".."===m?(g.splice(b,1),y++):y&&(g.splice(b,1),y--);if(!d&&!p)for(;y--;)g.unshift("..");!d||""===g[0]||g[0]&&"/"===g[0].charAt(0)||g.unshift(""),h&&"/"!==g.join("/").substr(-1)&&g.push("");var w,p=""===g[0]||g[0]&&"/"===g[0].charAt(0);return v&&(t.hostname=t.host=!p&&g.length?g.shift():"",(w=!!(t.host&&0<t.host.indexOf("@"))&&t.host.split("@"))&&(t.auth=w.shift(),t.host=t.hostname=w.shift())),(d=d||t.host&&g.length)&&!p&&g.unshift(""),g.length?t.pathname=g.join("/"):(t.pathname=null,t.path=null),j.isNull(t.pathname)&&j.isNull(t.search)||(t.path=(t.pathname||"")+(t.search||"")),t.auth=e.auth||t.auth,t.slashes=t.slashes||e.slashes,t.href=t.format(),t},x.prototype.parseHost=function(){var e=this.host,t=r.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},{"./util":55,punycode:49,querystring:52}],55:[function(e,t,n){"use strict";t.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},{}],56:[function(c,t,n){!function(r){!function(){!function(e){"object"==typeof n&&void 0!==t?t.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:void 0!==r?r:"undefined"!=typeof self?self:this).localforage=e()}(function(){return function r(o,i,a){function u(n,e){if(!i[n]){if(!o[n]){var t="function"==typeof c&&c;if(!e&&t)return t(n,!0);if(s)return s(n,!0);e=new Error("Cannot find module '"+n+"'");throw e.code="MODULE_NOT_FOUND",e}t=i[n]={exports:{}};o[n][0].call(t.exports,function(e){var t=o[n][1][e];return u(t||e)},t,t.exports,r,o,i,a)}return i[n].exports}for(var s="function"==typeof c&&c,e=0;e<a.length;e++)u(a[e]);return u}({1:[function(e,c,t){!function(t){"use strict";var e,n,r,o,i=t.MutationObserver||t.WebKitMutationObserver,a=i?(e=0,i=new i(s),n=t.document.createTextNode(""),i.observe(n,{characterData:!0}),function(){n.data=e=++e%2}):t.setImmediate||void 0===t.MessageChannel?"document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var e=t.document.createElement("script");e.onreadystatechange=function(){s(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},t.document.documentElement.appendChild(e)}:function(){setTimeout(s,0)}:((r=new t.MessageChannel).port1.onmessage=s,function(){r.port2.postMessage(0)}),u=[];function s(){o=!0;for(var e,t,n=u.length;n;){for(t=u,u=[],e=-1;++e<n;)t[e]();n=u.length}o=!1}c.exports=function(e){1!==u.push(e)||o||a()}}.call(this,void 0!==r?r:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,n){"use strict";var o=e(1);function s(){}var c={},i=["REJECTED"],a=["FULFILLED"],r=["PENDING"];function u(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=r,this.queue=[],this.outcome=void 0,e!==s&&h(this,e)}function l(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function f(t,n,r){o(function(){var e;try{e=n(r)}catch(e){return c.reject(t,e)}e===t?c.reject(t,new TypeError("Cannot resolve promise with itself")):c.resolve(t,e)})}function d(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function h(t,e){var n=!1;function r(e){n||(n=!0,c.reject(t,e))}function o(e){n||(n=!0,c.resolve(t,e))}var i=p(function(){e(o,r)});"error"===i.status&&r(i.value)}function p(e,t){var n={};try{n.value=e(t),n.status="success"}catch(e){n.status="error",n.value=e}return n}(t.exports=u).prototype.catch=function(e){return this.then(null,e)},u.prototype.then=function(e,t){if("function"!=typeof e&&this.state===a||"function"!=typeof t&&this.state===i)return this;var n=new this.constructor(s);return this.state!==r?f(n,this.state===a?e:t,this.outcome):this.queue.push(new l(n,e,t)),n},l.prototype.callFulfilled=function(e){c.resolve(this.promise,e)},l.prototype.otherCallFulfilled=function(e){f(this.promise,this.onFulfilled,e)},l.prototype.callRejected=function(e){c.reject(this.promise,e)},l.prototype.otherCallRejected=function(e){f(this.promise,this.onRejected,e)},c.resolve=function(e,t){var n=p(d,t);if("error"===n.status)return c.reject(e,n.value);n=n.value;if(n)h(e,n);else{e.state=a,e.outcome=t;for(var r=-1,o=e.queue.length;++r<o;)e.queue[r].callFulfilled(t)}return e},c.reject=function(e,t){e.state=i,e.outcome=t;for(var n=-1,r=e.queue.length;++n<r;)e.queue[n].callRejected(t);return e},u.resolve=function(e){if(e instanceof this)return e;return c.resolve(new this(s),e)},u.reject=function(e){var t=new this(s);return c.reject(t,e)},u.all=function(e){var n=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,o=!1;if(!r)return this.resolve([]);var i=new Array(r),a=0,t=-1,u=new this(s);for(;++t<r;)!function(e,t){n.resolve(e).then(function(e){i[t]=e,++a!==r||o||(o=!0,c.resolve(u,i))},function(e){o||(o=!0,c.reject(u,e))})}(e[t],t);return u},u.race=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);var o=-1,i=new this(s);for(;++o<n;)!function(e){t.resolve(e).then(function(e){r||(r=!0,c.resolve(i,e))},function(e){r||(r=!0,c.reject(i,e))})}(e[o]);return i}},{1:1}],3:[function(t,e,n){!function(e){"use strict";"function"!=typeof e.Promise&&(e.Promise=t(2))}.call(this,void 0!==r?r:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(e,D,P){"use strict";var N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var u=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){return}}();function i(t,n){t=t||[],n=n||{};try{return new Blob(t,n)}catch(e){if("TypeError"!==e.name)throw e;for(var r=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),o=0;o<t.length;o+=1)r.append(t[o]);return r.getBlob(n.type)}}"undefined"==typeof Promise&&e(3);var h=Promise;function p(e,t){t&&e.then(function(e){t(null,e)},function(e){t(e)})}function s(e,t,n){"function"==typeof t&&e.then(t),"function"==typeof n&&e.catch(n)}function l(e){return"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function c(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var a="local-forage-detect-blob-support",t=void 0,f={},M=Object.prototype.toString,n="readonly",d="readwrite";function B(e){return"boolean"==typeof t?h.resolve(t):(r=e,new h(function(n){var e=r.transaction(a,d),t=i([""]);e.objectStore(a).put(t,"key"),e.onabort=function(e){e.preventDefault(),e.stopPropagation(),n(!1)},e.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),t=navigator.userAgent.match(/Edge\//);n(t||!e||43<=parseInt(e[1],10))}}).catch(function(){return!1}).then(function(e){return t=e}));var r}function g(e){var e=f[e.name],n={};n.promise=new h(function(e,t){n.resolve=e,n.reject=t}),e.deferredOperations.push(n),e.dbReady?e.dbReady=e.dbReady.then(function(){return n.promise}):e.dbReady=n.promise}function v(e){e=f[e.name].deferredOperations.pop();e&&(e.resolve(),e.promise)}function m(e,t){e=f[e.name].deferredOperations.pop();if(e)return e.reject(t),e.promise}function r(o,i){return new h(function(t,n){if(f[o.name]=f[o.name]||K(),o.db){if(!i)return t(o.db);g(o),o.db.close()}var e=[o.name],r=(i&&e.push(o.version),u.open.apply(u,e));i&&(r.onupgradeneeded=function(t){var e=r.result;try{e.createObjectStore(o.storeName),t.oldVersion<=1&&e.createObjectStore(a)}catch(e){if("ConstraintError"!==e.name)throw e;console.warn('The database "'+o.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+o.storeName+'" already exists.')}}),r.onerror=function(e){e.preventDefault(),n(r.error)},r.onsuccess=function(){var e=r.result;e.onversionchange=function(e){e.target.close()},t(e),v(o)}})}function y(e){return r(e,!1)}function b(e){return r(e,!0)}function w(e,t){if(!e.db)return 1;var n=!e.db.objectStoreNames.contains(e.storeName),r=e.version<e.db.version,o=e.version>e.db.version;return r&&(e.version!==t&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),(o||n)&&(n&&(r=e.db.version+1)>e.version&&(e.version=r),1)}function z(e){return i([function(e){for(var t=e.length,n=new ArrayBuffer(t),r=new Uint8Array(n),o=0;o<t;o++)r[o]=e.charCodeAt(o);return n}(atob(e.data))],{type:e.type})}function U(e){return e&&e.__local_forage_encoded_blob}function q(e){var t=this,n=t._initReady().then(function(){var e=f[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady});return s(n,e,e),n}function x(t,n,r,o){void 0===o&&(o=1);try{var e=t.db.transaction(t.storeName,n);r(null,e)}catch(e){if(0<o&&(!t.db||"InvalidStateError"===e.name||"NotFoundError"===e.name))return h.resolve().then(function(){if(!t.db||"NotFoundError"===e.name&&!t.db.objectStoreNames.contains(t.storeName)&&t.version<=t.db.version)return t.db&&(t.version=t.db.version+1),b(t)}).then(function(){return function(n){g(n);for(var r=f[n.name],o=r.forages,e=0;e<o.length;e++){var t=o[e];t._dbInfo.db&&(t._dbInfo.db.close(),t._dbInfo.db=null)}return n.db=null,y(n).then(function(e){return n.db=e,w(n)?b(n):e}).then(function(e){n.db=r.db=e;for(var t=0;t<o.length;t++)o[t]._dbInfo.db=e}).catch(function(e){throw m(n,e),e})}(t).then(function(){x(t,n,r,o-1)})}).catch(r);r(e)}}function K(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}e={_driver:"asyncStorage",_initStorage:function(e){var r=this,o={db:null};if(e)for(var t in e)o[t]=e[t];var i=f[o.name],n=(i||(i=K(),f[o.name]=i),i.forages.push(r),r._initReady||(r._initReady=r.ready,r.ready=q),[]);function a(){return h.resolve()}for(var u=0;u<i.forages.length;u++){var s=i.forages[u];s!==r&&n.push(s._initReady().catch(a))}var c=i.forages.slice(0);return h.all(n).then(function(){return o.db=i.db,y(o)}).then(function(e){return o.db=e,w(o,r._defaultConfig.version)?b(o):e}).then(function(e){o.db=i.db=e,r._dbInfo=o;for(var t=0;t<c.length;t++){var n=c[t];n!==r&&(n._dbInfo.db=o.db,n._dbInfo.version=o.version)}})},_support:function(){try{if(!u||!u.open)return!1;var e="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!e||t)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}(),iterate:function(a,e){var u=this,t=new h(function(o,i){u.ready().then(function(){x(u._dbInfo,n,function(e,t){if(e)return i(e);try{var n=t.objectStore(u._dbInfo.storeName).openCursor(),r=1;n.onsuccess=function(){var e,t=n.result;t?(U(e=t.value)&&(e=z(e)),void 0!==(e=a(e,t.key,r++))?o(e):t.continue()):o()},n.onerror=function(){i(n.error)}}catch(e){i(e)}})}).catch(i)});return p(t,e),t},getItem:function(i,e){var a=this,t=(i=l(i),new h(function(r,o){a.ready().then(function(){x(a._dbInfo,n,function(e,t){if(e)return o(e);try{var n=t.objectStore(a._dbInfo.storeName).get(i);n.onsuccess=function(){var e=n.result;U(e=void 0===e?null:e)&&(e=z(e)),r(e)},n.onerror=function(){o(n.error)}}catch(e){o(e)}})}).catch(o)}));return p(t,e),t},setItem:function(u,t,e){var s=this,n=(u=l(u),new h(function(i,a){var e;s.ready().then(function(){return e=s._dbInfo,"[object Blob]"===M.call(t)?B(e.db).then(function(e){return e?t:(r=t,new h(function(t,e){var n=new FileReader;n.onerror=e,n.onloadend=function(e){e=btoa(e.target.result||"");t({__local_forage_encoded_blob:!0,data:e,type:r.type})},n.readAsBinaryString(r)}));var r}):t}).then(function(o){x(s._dbInfo,d,function(e,t){if(e)return a(e);try{var n=t.objectStore(s._dbInfo.storeName),r=(null===o&&(o=void 0),n.put(o,u));t.oncomplete=function(){i(o=void 0===o?null:o)},t.onabort=t.onerror=function(){var e=r.error||r.transaction.error;a(e)}}catch(e){a(e)}})}).catch(a)}));return p(n,e),n},removeItem:function(i,e){var a=this,t=(i=l(i),new h(function(r,o){a.ready().then(function(){x(a._dbInfo,d,function(e,t){if(e)return o(e);try{var n=t.objectStore(a._dbInfo.storeName).delete(i);t.oncomplete=function(){r()},t.onerror=function(){o(n.error)},t.onabort=function(){var e=n.error||n.transaction.error;o(e)}}catch(e){o(e)}})}).catch(o)}));return p(t,e),t},clear:function(e){var i=this,t=new h(function(r,o){i.ready().then(function(){x(i._dbInfo,d,function(e,t){if(e)return o(e);try{var n=t.objectStore(i._dbInfo.storeName).clear();t.oncomplete=function(){r()},t.onabort=t.onerror=function(){var e=n.error||n.transaction.error;o(e)}}catch(e){o(e)}})}).catch(o)});return p(t,e),t},length:function(e){var i=this,t=new h(function(r,o){i.ready().then(function(){x(i._dbInfo,n,function(e,t){if(e)return o(e);try{var n=t.objectStore(i._dbInfo.storeName).count();n.onsuccess=function(){r(n.result)},n.onerror=function(){o(n.error)}}catch(e){o(e)}})}).catch(o)});return p(t,e),t},key:function(u,e){var s=this,t=new h(function(i,a){u<0?i(null):s.ready().then(function(){x(s._dbInfo,n,function(e,t){if(e)return a(e);try{var n=t.objectStore(s._dbInfo.storeName),r=!1,o=n.openKeyCursor();o.onsuccess=function(){var e=o.result;e?0===u||r?i(e.key):(r=!0,e.advance(u)):i(null)},o.onerror=function(){a(o.error)}}catch(e){a(e)}})}).catch(a)});return p(t,e),t},keys:function(e){var a=this,t=new h(function(o,i){a.ready().then(function(){x(a._dbInfo,n,function(e,t){if(e)return i(e);try{var n=t.objectStore(a._dbInfo.storeName).openKeyCursor(),r=[];n.onsuccess=function(){var e=n.result;e?(r.push(e.key),e.continue()):o(r)},n.onerror=function(){i(n.error)}}catch(e){i(e)}})}).catch(i)});return p(t,e),t},dropInstance:function(a,e){e=c.apply(this,arguments);var t=this.config();return(a="function"!=typeof a&&a||{}).name||(a.name=a.name||t.name,a.storeName=a.storeName||t.storeName),p(t=a.name?(t=a.name===t.name&&this._dbInfo.db?h.resolve(this._dbInfo.db):y(a).then(function(e){var t=f[a.name],n=t.forages;t.db=e;for(var r=0;r<n.length;r++)n[r]._dbInfo.db=e;return e}),a.storeName?t.then(function(e){if(e.objectStoreNames.contains(a.storeName)){var o=e.version+1,r=(g(a),f[a.name]),i=r.forages;e.close();for(var t=0;t<i.length;t++){var n=i[t];n._dbInfo.db=null,n._dbInfo.version=o}return new h(function(t,n){var r=u.open(a.name,o);r.onerror=function(e){r.result.close(),n(e)},r.onupgradeneeded=function(){r.result.deleteObjectStore(a.storeName)},r.onsuccess=function(){var e=r.result;e.close(),t(e)}}).then(function(e){r.db=e;for(var t=0;t<i.length;t++){var n=i[t];n._dbInfo.db=e,v(n._dbInfo)}}).catch(function(e){throw(m(a,e)||h.resolve()).catch(function(){}),e})}}):t.then(function(e){g(a);var n=f[a.name],r=n.forages;e.close();for(var t=0;t<r.length;t++)r[t]._dbInfo.db=null;return new h(function(t,n){var r=u.deleteDatabase(a.name);r.onerror=function(){var e=r.result;e&&e.close(),n(r.error)},r.onblocked=function(){console.warn('dropInstance blocked for database "'+a.name+'" until all open connections are closed')},r.onsuccess=function(){var e=r.result;e&&e.close(),t(e)}}).then(function(e){n.db=e;for(var t=0;t<r.length;t++)v(r[t]._dbInfo)}).catch(function(e){throw(m(a,e)||h.resolve()).catch(function(){}),e})})):h.reject("Invalid arguments"),e),t}};var k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",W=/^~~local_forage_type~([^~]+)~/,_="__lfsc__:",j=_.length,I="arbf",S="blob",H=j+I.length,J=Object.prototype.toString;function G(e){for(var t,n,r,o,i=.75*e.length,a=e.length,u=0,i=("="===e[e.length-1]&&(i--,"="===e[e.length-2]&&i--),new ArrayBuffer(i)),s=new Uint8Array(i),c=0;c<a;c+=4)t=k.indexOf(e[c]),n=k.indexOf(e[c+1]),r=k.indexOf(e[c+2]),o=k.indexOf(e[c+3]),s[u++]=t<<2|n>>4,s[u++]=(15&n)<<4|r>>2,s[u++]=(3&r)<<6|63&o;return i}function E(e){for(var t=new Uint8Array(e),n="",r=0;r<t.length;r+=3)n=(n=(n=(n+=k[t[r]>>2])+k[(3&t[r])<<4|t[r+1]>>4])+k[(15&t[r+1])<<2|t[r+2]>>6])+k[63&t[r+2]];return t.length%3==2?n=n.substring(0,n.length-1)+"=":t.length%3==1&&(n=n.substring(0,n.length-2)+"=="),n}var A={serialize:function(t,n){var e="";if(t&&(e=J.call(t)),t&&("[object ArrayBuffer]"===e||t.buffer&&"[object ArrayBuffer]"===J.call(t.buffer))){var r,o=_;t instanceof ArrayBuffer?(r=t,o+=I):(r=t.buffer,"[object Int8Array]"===e?o+="si08":"[object Uint8Array]"===e?o+="ui08":"[object Uint8ClampedArray]"===e?o+="uic8":"[object Int16Array]"===e?o+="si16":"[object Uint16Array]"===e?o+="ur16":"[object Int32Array]"===e?o+="si32":"[object Uint32Array]"===e?o+="ui32":"[object Float32Array]"===e?o+="fl32":"[object Float64Array]"===e?o+="fl64":n(new Error("Failed to get type for BinaryArray"))),n(o+E(r))}else if("[object Blob]"===e){o=new FileReader;o.onload=function(){var e="~~local_forage_type~"+t.type+"~"+E(this.result);n(_+S+e)},o.readAsArrayBuffer(t)}else try{n(JSON.stringify(t))}catch(e){console.error("Couldn't convert value into a JSON string: ",t),n(null,e)}},deserialize:function(e){if(e.substring(0,j)!==_)return JSON.parse(e);var t,n=e.substring(H),r=e.substring(j,H),o=(r===S&&W.test(n)&&(t=(e=n.match(W))[1],n=n.substring(e[0].length)),G(n));switch(r){case I:return o;case S:return i([o],{type:t});case"si08":return new Int8Array(o);case"ui08":return new Uint8Array(o);case"uic8":return new Uint8ClampedArray(o);case"si16":return new Int16Array(o);case"ur16":return new Uint16Array(o);case"si32":return new Int32Array(o);case"ui32":return new Uint32Array(o);case"fl32":return new Float32Array(o);case"fl64":return new Float64Array(o);default:throw new Error("Unkown type: "+r)}},stringToBuffer:G,bufferToString:E};function V(e,t,n,r){e.executeSql("CREATE TABLE IF NOT EXISTS "+t.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],n,r)}function $(e,r,o,i,a,u){e.executeSql(o,i,a,function(e,n){n.code===n.SYNTAX_ERR?e.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[r.storeName],function(e,t){t.rows.length?u(e,n):V(e,r,function(){e.executeSql(o,i,a,u)},u)},u):u(e,n)},u)}function Y(a,e,u,s){var c=this,t=(a=l(a),new h(function(o,i){c.ready().then(function(){var n=e=void 0===e?null:e,r=c._dbInfo;r.serializer.serialize(e,function(t,e){e?i(e):r.db.transaction(function(e){$(e,r,"INSERT OR REPLACE INTO "+r.storeName+" (key, value) VALUES (?, ?)",[a,t],function(){o(n)},function(e,t){i(t)})},function(e){e.code===e.QUOTA_ERR&&(0<s?o(Y.apply(c,[a,n,u,s-1])):i(e))})})}).catch(i)}));return p(t,u),t}var o={_driver:"webSQLStorage",_initStorage:function(e){var r=this,o={db:null};if(e)for(var t in e)o[t]="string"!=typeof e[t]?e[t].toString():e[t];var n=new h(function(t,n){try{o.db=openDatabase(o.name,String(o.version),o.description,o.size)}catch(e){return n(e)}o.db.transaction(function(e){V(e,o,function(){r._dbInfo=o,t()},function(e,t){n(t)})},n)});return o.serializer=A,n},_support:"function"==typeof openDatabase,iterate:function(c,e){var t=this,n=new h(function(s,n){t.ready().then(function(){var u=t._dbInfo;u.db.transaction(function(e){$(e,u,"SELECT * FROM "+u.storeName,[],function(e,t){for(var n=t.rows,r=n.length,o=0;o<r;o++){var i=n.item(o),a=(a=i.value)&&u.serializer.deserialize(a);if(void 0!==(a=c(a,i.key,o+1)))return void s(a)}s()},function(e,t){n(t)})})}).catch(n)});return p(n,e),n},getItem:function(t,e){var i=this,n=(t=l(t),new h(function(r,o){i.ready().then(function(){var n=i._dbInfo;n.db.transaction(function(e){$(e,n,"SELECT * FROM "+n.storeName+" WHERE key = ? LIMIT 1",[t],function(e,t){t=(t=t.rows.length?t.rows.item(0).value:null)&&n.serializer.deserialize(t);r(t)},function(e,t){o(t)})})}).catch(o)}));return p(n,e),n},setItem:function(e,t,n){return Y.apply(this,[e,t,n,1])},removeItem:function(o,e){var i=this,t=(o=l(o),new h(function(n,r){i.ready().then(function(){var t=i._dbInfo;t.db.transaction(function(e){$(e,t,"DELETE FROM "+t.storeName+" WHERE key = ?",[o],function(){n()},function(e,t){r(t)})})}).catch(r)}));return p(t,e),t},clear:function(e){var o=this,t=new h(function(n,r){o.ready().then(function(){var t=o._dbInfo;t.db.transaction(function(e){$(e,t,"DELETE FROM "+t.storeName,[],function(){n()},function(e,t){r(t)})})}).catch(r)});return p(t,e),t},length:function(e){var o=this,t=new h(function(n,r){o.ready().then(function(){var t=o._dbInfo;t.db.transaction(function(e){$(e,t,"SELECT COUNT(key) as c FROM "+t.storeName,[],function(e,t){t=t.rows.item(0).c;n(t)},function(e,t){r(t)})})}).catch(r)});return p(t,e),t},key:function(o,e){var i=this,t=new h(function(n,r){i.ready().then(function(){var t=i._dbInfo;t.db.transaction(function(e){$(e,t,"SELECT key FROM "+t.storeName+" WHERE id = ? LIMIT 1",[o+1],function(e,t){t=t.rows.length?t.rows.item(0).key:null;n(t)},function(e,t){r(t)})})}).catch(r)});return p(t,e),t},keys:function(e){var r=this,t=new h(function(o,n){r.ready().then(function(){var t=r._dbInfo;t.db.transaction(function(e){$(e,t,"SELECT key FROM "+t.storeName,[],function(e,t){for(var n=[],r=0;r<t.rows.length;r++)n.push(t.rows.item(r).key);o(n)},function(e,t){n(t)})})}).catch(n)});return p(t,e),t},dropInstance:function(n,e){e=c.apply(this,arguments);var r=this.config(),o=((n="function"!=typeof n&&n||{}).name||(n.name=n.name||r.name,n.storeName=n.storeName||r.storeName),this),t=n.name?new h(function(e){var i,t=n.name===r.name?o._dbInfo.db:openDatabase(n.name,"","",0);n.storeName?e({db:t,storeNames:[n.storeName]}):e((i=t,new h(function(o,n){i.transaction(function(e){e.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(e,t){for(var n=[],r=0;r<t.rows.length;r++)n.push(t.rows.item(r).name);o({db:i,storeNames:n})},function(e,t){n(t)})},function(e){n(e)})})))}).then(function(a){return new h(function(o,i){a.db.transaction(function(r){for(var e=[],t=0,n=a.storeNames.length;t<n;t++)e.push(function(t){return new h(function(e,n){r.executeSql("DROP TABLE IF EXISTS "+t,[],function(){e()},function(e,t){n(t)})})}(a.storeNames[t]));h.all(e).then(function(){o()}).catch(function(e){i(e)})},function(e){i(e)})})}):h.reject("Invalid arguments");return p(t,e),t}};function Q(e,t){var n=e.name+"/";return e.storeName!==t.storeName&&(n+=e.storeName+"/"),n}function X(){return!function(){var e="_localforage_support_test";try{return localStorage.setItem(e,!0),localStorage.removeItem(e),0}catch(e){return 1}}()||0<localStorage.length}function Z(e,t){for(var n,r,o=e.length,i=0;i<o;){if((n=e[i])===(r=t)||"number"==typeof n&&"number"==typeof r&&isNaN(n)&&isNaN(r))return 1;i++}}var ee={_driver:"localStorageWrapper",_initStorage:function(e){var t={};if(e)for(var n in e)t[n]=e[n];return t.keyPrefix=Q(e,this._defaultConfig),X()?((this._dbInfo=t).serializer=A,h.resolve()):h.reject()},_support:function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}(),iterate:function(s,e){var c=this,t=c.ready().then(function(){for(var e=c._dbInfo,t=e.keyPrefix,n=t.length,r=localStorage.length,o=1,i=0;i<r;i++){var a=localStorage.key(i);if(0===a.indexOf(t)){var u=(u=localStorage.getItem(a))&&e.serializer.deserialize(u);if(void 0!==(u=s(u,a.substring(n),o++)))return u}}});return p(t,e),t},getItem:function(n,e){var r=this,t=(n=l(n),r.ready().then(function(){var e=r._dbInfo,t=localStorage.getItem(e.keyPrefix+n);return t=t&&e.serializer.deserialize(t)}));return p(t,e),t},setItem:function(a,e,t){var u=this,n=(a=l(a),u.ready().then(function(){var i=e=void 0===e?null:e;return new h(function(n,r){var o=u._dbInfo;o.serializer.serialize(e,function(e,t){if(t)r(t);else try{localStorage.setItem(o.keyPrefix+a,e),n(i)}catch(e){"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||r(e),r(e)}})})}));return p(n,t),n},removeItem:function(t,e){var n=this,r=(t=l(t),n.ready().then(function(){var e=n._dbInfo;localStorage.removeItem(e.keyPrefix+t)}));return p(r,e),r},clear:function(e){var r=this,t=r.ready().then(function(){for(var e=r._dbInfo.keyPrefix,t=localStorage.length-1;0<=t;t--){var n=localStorage.key(t);0===n.indexOf(e)&&localStorage.removeItem(n)}});return p(t,e),t},length:function(e){var t=this.keys().then(function(e){return e.length});return p(t,e),t},key:function(n,e){var r=this,t=r.ready().then(function(){var t,e=r._dbInfo;try{t=localStorage.key(n)}catch(e){t=null}return t=t&&t.substring(e.keyPrefix.length)});return p(t,e),t},keys:function(e){var i=this,t=i.ready().then(function(){for(var e=i._dbInfo,t=localStorage.length,n=[],r=0;r<t;r++){var o=localStorage.key(r);0===o.indexOf(e.keyPrefix)&&n.push(o.substring(e.keyPrefix.length))}return n});return p(t,e),t},dropInstance:function(t,e){e=c.apply(this,arguments),(t="function"!=typeof t&&t||{}).name||(r=this.config(),t.name=t.name||r.name,t.storeName=t.storeName||r.storeName);var n=this,r=t.name?new h(function(e){t.storeName?e(Q(t,n._defaultConfig)):e(t.name+"/")}).then(function(e){for(var t=localStorage.length-1;0<=t;t--){var n=localStorage.key(t);0===n.indexOf(e)&&localStorage.removeItem(n)}}):h.reject("Invalid arguments");return p(r,e),r}},te=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},C={},ne={},O={INDEXEDDB:e,WEBSQL:o,LOCALSTORAGE:ee},e=[O.INDEXEDDB._driver,O.WEBSQL._driver,O.LOCALSTORAGE._driver],F=["dropInstance"],T=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(F),re={description:"",driver:e.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function L(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];if(n)for(var r in n)n.hasOwnProperty(r)&&(te(n[r])?e[r]=n[r].slice():e[r]=n[r])}return e}function R(e){var t,n,r;if(!(this instanceof R))throw new TypeError("Cannot call a class as a function");for(t in O)O.hasOwnProperty(t)&&(r=(n=O[t])._driver,this[t]=r,C[r]||this.defineDriver(n));this._defaultConfig=L({},re),this._config=L({},this._defaultConfig,e),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}R.prototype.config=function(e){if("object"!==(void 0===e?"undefined":N(e)))return"string"==typeof e?this._config[e]:this._config;if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var t in e){if("storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),"version"===t&&"number"!=typeof e[t])return new Error("Database version must be a number.");this._config[t]=e[t]}return!("driver"in e&&e.driver)||this.setDriver(this._config.driver)},R.prototype.defineDriver=function(d,e,t){var n=new h(function(t,n){try{var r=d._driver,e=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!d._driver)return void n(e);for(var o=T.concat("_initStorage"),i=0,a=o.length;i<a;i++){var u=o[i];if((!Z(F,u)||d[u])&&"function"!=typeof d[u])return void n(e)}for(var s=0,c=F.length;s<c;s++){var l=F[s];d[l]||(d[l]=function(t){return function(){var e=new Error("Method "+t+" is not implemented by the current driver"),e=h.reject(e);return p(e,arguments[arguments.length-1]),e}}(l))}var f=function(e){C[r]&&console.info("Redefining LocalForage driver: "+r),C[r]=d,ne[r]=e,t()};"_support"in d?d._support&&"function"==typeof d._support?d._support().then(f,n):f(!!d._support):f(!0)}catch(e){n(e)}});return s(n,e,t),n},R.prototype.driver=function(){return this._driver||null},R.prototype.getDriver=function(e,t,n){e=C[e]?h.resolve(C[e]):h.reject(new Error("Driver not found."));return s(e,t,n),e},R.prototype.getSerializer=function(e){var t=h.resolve(A);return s(t,e),t},R.prototype.ready=function(e){var t=this,n=t._driverSet.then(function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready});return s(n,e,e),n},R.prototype.setDriver=function(e,t,n){var i=this,r=(te(e)||(e=[e]),this._getSupportedDrivers(e));function a(){i._config.driver=i.driver()}function u(e){return i._extend(e),a(),i._ready=i._initStorage(i._config),i._ready}function o(o){return function(){var r=0;return function e(){for(;r<o.length;){var t=o[r];return r++,i._dbInfo=null,i._ready=null,i.getDriver(t).then(u).catch(e)}a();var n=new Error("No available storage method found.");return i._driverSet=h.reject(n),i._driverSet}()}}e=null!==this._driverSet?this._driverSet.catch(function(){return h.resolve()}):h.resolve();return this._driverSet=e.then(function(){var e=r[0];return i._dbInfo=null,i._ready=null,i.getDriver(e).then(function(e){i._driver=e._driver,a(),i._wrapLibraryMethodsWithReady(),i._initDriver=o(r)})}).catch(function(){a();var e=new Error("No available storage method found.");return i._driverSet=h.reject(e),i._driverSet}),s(this._driverSet,t,n),this._driverSet},R.prototype.supports=function(e){return!!ne[e]},R.prototype._extend=function(e){L(this,e)},R.prototype._getSupportedDrivers=function(e){for(var t=[],n=0,r=e.length;n<r;n++){var o=e[n];this.supports(o)&&t.push(o)}return t},R.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0,t=T.length;e<t;e++)!function(t,n){t[n]=function(){var e=arguments;return t.ready().then(function(){return t[n].apply(t,e)})}}(this,T[e])},R.prototype.createInstance=function(e){return new R(e)};o=new R;D.exports=o},{3:3}]},{},[4])(4)})}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],57:[function(e,t,n){var r,o;r=this,o=function(){"use strict";var l=function(){return(l=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function c(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&r>=e.length?void 0:e)&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function h(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}function a(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||((r=r||Array.prototype.slice.call(t,0,o))[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}t.prototype.next=function(){var e=this.dive();return this.backtrack(),e},t.prototype.dive=function(){if(0===this._path.length)return{done:!0,value:void 0};var e=r(this._path),t=e.node,e=e.keys;return""===r(e)?{done:!1,value:this.result()}:(this._path.push({node:t[r(e)],keys:Object.keys(t[r(e)])}),this.dive())},t.prototype.backtrack=function(){0!==this._path.length&&(r(this._path).keys.pop(),0<r(this._path).keys.length||(this._path.pop(),this.backtrack()))},t.prototype.key=function(){return this.set._prefix+this._path.map(function(e){e=e.keys;return r(e)}).filter(function(e){return""!==e}).join("")},t.prototype.value=function(){return r(this._path).node[""]},t.prototype.result=function(){return"VALUES"===this._type?this.value():"KEYS"===this._type?this.key():[this.key(),this.value()]},t.prototype[Symbol.iterator]=function(){return this};var e=t;function t(e,t){var n=e._tree,r=Object.keys(n);this.set=e,this._type=t,this._path=0<r.length?[{node:n,keys:r}]:[]}function n(e,s,c){for(var l=[{distance:0,i:0,key:"",node:e}],f={},d=[],t=function(){var e=l.pop(),o=e.node,i=e.distance,a=e.key,n=e.i,u=e.edit;Object.keys(o).forEach(function(r){var e,t;""===r?(e=i+(s.length-n),t=h(f[a]||[null,1/0],2)[1],e<=c&&e<t&&(f[a]=[o[r],e])):function(e,t,n,r,o,i){i.push({distance:0,ia:r,ib:0,edit:o});var a=[];while(i.length>0){var u=i.pop(),s=u.distance,c=u.ia,l=u.ib,f=u.edit;if(l===t.length){a.push({distance:s,i:c,edit:f});continue}if(e[c]===t[l])i.push({distance:s,ia:c+1,ib:l+1,edit:p});else{if(s>=n)continue;if(f!==v)i.push({distance:s+1,ia:c,ib:l+1,edit:m});if(c<e.length){if(f!==m)i.push({distance:s+1,ia:c+1,ib:l,edit:v});if(f!==m&&f!==v)i.push({distance:s+1,ia:c+1,ib:l+1,edit:g})}}}return a}(s,r,c-i,n,u,d).forEach(function(e){var t=e.distance,n=e.i,e=e.edit;l.push({node:o[r],distance:i+t,key:a+r,i:n,edit:e})})})};0<l.length;)t();return f}var r=function(e){return e[e.length-1]},p=0,g=1,v=2,m=3,f=(d.prototype.atPrefix=function(e){var t;if(!e.startsWith(this._prefix))throw new Error("Mismatched prefix");var n=h(u(this._tree,e.slice(this._prefix.length)),2),r=n[0],n=n[1];if(void 0===r){var n=h(k(n),2),o=n[0],i=n[1],n=Object.keys(o).find(function(e){return""!==e&&e.startsWith(i)});if(void 0!==n)return new d(((t={})[n.slice(i.length)]=o[n],t),e)}return new d(r||{},e)},d.prototype.clear=function(){delete this._size,this._tree={}},d.prototype.delete=function(e){return delete this._size,b(this._tree,e)},d.prototype.entries=function(){return new e(this,"ENTRIES")},d.prototype.forEach=function(e){var t,n;try{for(var r=c(this),o=r.next();!o.done;o=r.next()){var i=h(o.value,2);e(i[0],i[1],this)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}},d.prototype.fuzzyGet=function(e,t){return n(this._tree,e,t)},d.prototype.get=function(e){e=i(this._tree,e);return void 0!==e?e[""]:void 0},d.prototype.has=function(e){e=i(this._tree,e);return void 0!==e&&e.hasOwnProperty("")},d.prototype.keys=function(){return new e(this,"KEYS")},d.prototype.set=function(e,t){if("string"!=typeof e)throw new Error("key must be a string");return delete this._size,s(this._tree,e)[""]=t,this},Object.defineProperty(d.prototype,"size",{get:function(){var e=this;return this._size||(this._size=0,this.forEach(function(){e._size+=1}),this._size)},enumerable:!1,configurable:!0}),d.prototype.update=function(e,t){if("string"!=typeof e)throw new Error("key must be a string");delete this._size;e=s(this._tree,e);return e[""]=t(e[""]),this},d.prototype.values=function(){return new e(this,"VALUES")},d.prototype[Symbol.iterator]=function(){return this.entries()},d.from=function(e){var t,n,r=new d;try{for(var o=c(e),i=o.next();!i.done;i=o.next()){var a=h(i.value,2),u=a[0],s=a[1];r.set(u,s)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return r},d.fromObject=function(e){return d.from(Object.entries(e))},d);function d(e,t){void 0===t&&(t=""),this._tree=e=void 0===e?{}:e,this._prefix=t}var o,u=function(e,t,n){if(void 0===n&&(n=[]),0===t.length||null==e)return[e,n];var r=Object.keys(e).find(function(e){return""!==e&&t.startsWith(e)});return void 0===r?(n.push([e,t]),u(void 0,"",n)):(n.push([e,r]),u(e[r],t.slice(r.length),n))},i=function(e,t){if(0===t.length||null==e)return e;var n=Object.keys(e).find(function(e){return""!==e&&t.startsWith(e)});return void 0!==n?i(e[n],t.slice(n.length)):void 0},s=function(e,t){var n;if(0===t.length||null==e)return e;var r,o,i=Object.keys(e).find(function(e){return""!==e&&t.startsWith(e)});return void 0===i?void 0!==(r=Object.keys(e).find(function(e){return""!==e&&e.startsWith(t[0])}))?(e[o=y(t,r)]=((n={})[r.slice(o.length)]=e[r],n),delete e[r],s(e[o],t.slice(o.length))):(e[t]={},e[t]):s(e[i],t.slice(i.length))},y=function(e,t,n,r,o){return void 0===n&&(n=0),void 0===o&&(o=""),(r=void 0===r?Math.min(e.length,t.length):r)<=n||e[n]!==t[n]?o:y(e,t,n+1,r,o+e[n])},b=function(e,t){var n,e=h(u(e,t),2),t=e[0],e=e[1];void 0!==t&&(delete t[""],0===(n=Object.keys(t)).length&&w(e),1===n.length&&x(e,n[0],t[n[0]]))},w=function(e){var t,n;0!==e.length&&(delete(t=(n=h(k(e),2))[0])[n[1]],0===(n=Object.keys(t)).length&&w(e.slice(0,-1)),1===n.length&&""!==n[0]&&x(e.slice(0,-1),n[0],t[n[0]]))},x=function(e,t,n){var r;0!==e.length&&((r=(e=h(k(e),2))[0])[(e=e[1])+t]=n,delete r[e])},k=function(e){return e[e.length-1]},_=(j.prototype.add=function(n){var r=this,e=this._options,o=e.extractField,i=e.tokenize,a=e.processTerm,t=e.fields,e=e.idField,u=o(n,e);if(null==u)throw new Error('MiniSearch: document does not have ID field "'.concat(e,'"'));var s=this.addDocumentId(u);this.saveStoredFields(s,n),t.forEach(function(t){var e=o(n,t);null!=e&&(e=i(e.toString(),t),r.addFieldLength(s,r._fieldIds[t],r.documentCount-1,e.length),e.forEach(function(e){e=a(e,t);e&&r.addTerm(r._fieldIds[t],s,e)}))})},j.prototype.addAll=function(e){var t=this;e.forEach(function(e){return t.add(e)})},j.prototype.addAllAsync=function(e,t){var o=this,t=(t=void 0===t?{}:t).chunkSize,i=void 0===t?10:t,t={chunk:[],promise:Promise.resolve()},e=e.reduce(function(e,t,n){var r=e.chunk,e=e.promise;return r.push(t),(n+1)%i==0?{chunk:[],promise:e.then(function(){return new Promise(function(e){return setTimeout(e,0)})}).then(function(){return o.addAll(r)})}:{chunk:r,promise:e}},t),n=e.chunk;return e.promise.then(function(){return o.addAll(n)})},j.prototype.remove=function(n){var r=this,e=this._options,o=e.tokenize,i=e.processTerm,a=e.extractField,t=e.fields,e=e.idField,u=a(n,e);if(null==u)throw new Error('MiniSearch: document does not have ID field "'.concat(e,'"'));var s=h(Object.entries(this._documentIds).find(function(e){e=h(e,2),e[0],e=e[1];return u===e})||[],1)[0];if(null==s)throw new Error("MiniSearch: cannot remove document with ID ".concat(u,": it is not in the index"));t.forEach(function(t){var e=a(n,t);null!=e&&((e=o(e.toString(),t)).forEach(function(e){e=i(e,t);e&&r.removeTerm(r._fieldIds[t],s,e)}),r.removeFieldLength(s,r._fieldIds[t],r.documentCount,e.length))}),delete this._storedFields[s],delete this._documentIds[s],delete this._fieldLength[s],--this._documentCount},j.prototype.removeAll=function(e){var t=this;if(e)e.forEach(function(e){return t.remove(e)});else{if(0<arguments.length)throw new Error("Expected documents to be present. Omit the argument to remove all documents.");this._index=new f,this._documentCount=0,this._documentIds={},this._fieldLength={},this._averageFieldLength={},this._storedFields={},this._nextId=0}},j.prototype.search=function(e,i){var a=this,e=(void 0===i&&(i={}),this.executeQuery(e,i));return Object.entries(e).reduce(function(e,t){var t=h(t,2),n=t[0],t=t[1],r=t.score,o=t.match,t=t.terms,t={id:a._documentIds[n],terms:$(t),score:r,match:o};return Object.assign(t,a._storedFields[n]),null!=i.filter&&!i.filter(t)||e.push(t),e},[]).sort(function(e,t){return e.score<t.score?1:-1})},j.prototype.autoSuggest=function(e,t){void 0===t&&(t={}),t=l(l({},F),t);e=this.search(e,t).reduce(function(e,t){var n=t.score,t=t.terms,r=t.join(" ");return null==e[r]?e[r]={score:n,terms:t,count:1}:(e[r].score+=n,e[r].count+=1),e},{});return Object.entries(e).map(function(e){var e=h(e,2),t=e[0],e=e[1],n=e.score;return{suggestion:t,terms:e.terms,score:n/e.count}}).sort(function(e,t){return e.score<t.score?1:-1})},Object.defineProperty(j.prototype,"documentCount",{get:function(){return this._documentCount},enumerable:!1,configurable:!0}),j.loadJSON=function(e,t){if(null==t)throw new Error("MiniSearch: loadJSON should be given the same options used when serializing the index");return j.loadJS(JSON.parse(e),t)},j.getDefault=function(e){if(C.hasOwnProperty(e))return I(C,e);throw new Error('MiniSearch: unknown option "'.concat(e,'"'))},j.loadJS=function(e,t){var n=e.index,r=e.documentCount,o=e.nextId,i=e.documentIds,a=e.fieldIds,u=e.fieldLength,s=e.averageFieldLength,e=e.storedFields,t=new j(t);return t._index=new f(n._tree,n._prefix),t._documentCount=r,t._nextId=o,t._documentIds=i,t._fieldIds=a,t._fieldLength=u,t._averageFieldLength=s,t._fieldIds=a,t._storedFields=e||{},t},j.prototype.executeQuery=function(n,r){var e,o=this;return void 0===r&&(r={}),"string"==typeof n?this.executeSearch(n,r):(e=n.queries.map(function(e){var t=l(l(l({},r),n),{queries:void 0});return o.executeQuery(e,t)}),this.combineResults(e,n.combineWith))},j.prototype.executeSearch=function(e,t){var n=this,r=(void 0===t&&(t={}),this._options),o=r.tokenize,i=r.processTerm,r=r.searchOptions,a=l(l({tokenize:o,processTerm:i},r),t),o=a.tokenize,u=a.processTerm,i=o(e).map(function(e){return u(e)}).filter(function(e){return!!e}).map(A(a)).map(function(e){return n.executeQuerySpec(e,a)});return this.combineResults(i,a.combineWith)},j.prototype.executeQuerySpec=function(r,e){var o=this,e=l(l({},this._options.searchOptions),e),i=(e.fields||this._options.fields).reduce(function(e,t){var n;return l(l({},e),((n={})[t]=I(e,t)||1,n))},e.boost||{}),a=e.boostDocument,t=e.weights,e=e.maxFuzzy,t=l(l({},O.weights),t),u=t.fuzzy,s=t.prefix,t=this.termResults(r.term,i,a,this._index.get(r.term));if(!r.fuzzy&&!r.prefix)return t;var c=[t];return r.prefix&&this._index.atPrefix(r.term).forEach(function(e,t){var n=.3*(e.length-r.term.length)/e.length;c.push(o.termResults(e,i,a,t,s,n))}),r.fuzzy&&(e=(t=!0===r.fuzzy?.2:r.fuzzy)<1?Math.min(e,Math.round(r.term.length*t)):t,Object.entries(this._index.fuzzyGet(r.term,e)).forEach(function(e){var e=h(e,2),t=e[0],e=h(e[1],2),n=e[0],e=e[1]/t.length;c.push(o.termResults(t,i,a,n,u,e))})),c.reduce(S.or)},j.prototype.combineResults=function(e,t){if(0===e.length)return{};t=(t=void 0===t?"or":t).toLowerCase();return e.reduce(S[t])||{}},j.prototype.toJSON=function(){return{index:this._index,documentCount:this._documentCount,nextId:this._nextId,documentIds:this._documentIds,fieldIds:this._fieldIds,fieldLength:this._fieldLength,averageFieldLength:this._averageFieldLength,storedFields:this._storedFields}},j.prototype.termResults=function(c,e,l,t,n,f){var d=this;return void 0===f&&(f=0),null==t?{}:Object.entries(e).reduce(function(o,e){var e=h(e,2),i=e[0],a=e[1],u=d._fieldIds[i],e=t[u]||{ds:{}},s=e.df,e=e.ds;return Object.entries(e).forEach(function(e){var t,e=h(e,2),n=e[0],e=e[1],r=l?l(d._documentIds[n],c):1;r&&(t=d._fieldLength[n][u]/d._averageFieldLength[u],o[n]=o[n]||{score:0,match:{},terms:[]},o[n].terms.push(c),o[n].match[c]=I(o[n].match,c)||[],o[n].score+=r*E(e,s,d._documentCount,t,a,f),o[n].match[c].push(i))}),o},{})},j.prototype.addTerm=function(n,r,e){this._index.update(e,function(e){var t=(e=e||{})[n]||{df:0,ds:{}};return null==t.ds[r]&&(t.df+=1),t.ds[r]=(t.ds[r]||0)+1,l(l({},e),((e={})[n]=t,e))})},j.prototype.removeTerm=function(n,r,o){var i=this;this._index.has(o)?(this._index.update(o,function(e){var t=e[n];if(null==t||null==t.ds[r])return i.warnDocumentChanged(r,n,o),e;if(t.ds[r]<=1){if(t.df<=1)return delete e[n],e;--t.df}return t.ds[r]<=1?(delete t.ds[r],e):(--t.ds[r],l(l({},e),((e={})[n]=t,e)))}),0===Object.keys(this._index.get(o)).length&&this._index.delete(o)):this.warnDocumentChanged(r,n,o)},j.prototype.warnDocumentChanged=function(e,t,n){var r;null!=console&&null!=console.warn&&(r=Object.entries(this._fieldIds).find(function(e){e=h(e,2);return e[0],e[1]===t})[0],console.warn("MiniSearch: document with ID ".concat(this._documentIds[e],' has changed before removal: term "').concat(n,'" was not present in field "').concat(r,'". Removing a document after it has changed can corrupt the index!')))},j.prototype.addDocumentId=function(e){var t=this._nextId.toString(36);return this._documentIds[t]=e,this._documentCount+=1,this._nextId+=1,t},j.prototype.addFields=function(e){var n=this;e.forEach(function(e,t){n._fieldIds[e]=t})},j.prototype.addFieldLength=function(e,t,n,r){this._averageFieldLength[t]=this._averageFieldLength[t]||0;var o=this._averageFieldLength[t]*n+r;this._fieldLength[e]=this._fieldLength[e]||{},this._fieldLength[e][t]=r,this._averageFieldLength[t]=o/(n+1)},j.prototype.removeFieldLength=function(e,t,n,r){r=this._averageFieldLength[t]*n-r;this._averageFieldLength[t]=r/(n-1)},j.prototype.saveStoredFields=function(n,r){var o=this,e=this._options,t=e.storeFields,i=e.extractField;null!=t&&0!==t.length&&(this._storedFields[n]=this._storedFields[n]||{},t.forEach(function(e){var t=i(r,e);void 0!==t&&(o._storedFields[n][e]=t)}))},j);function j(e){if(null==(null==e?void 0:e.fields))throw new Error('MiniSearch: option "fields" must be provided');this._options=l(l(l({},C),e),{searchOptions:l(l({},O),e.searchOptions||{})}),this._index=new f,this._documentCount=0,this._documentIds={},this._fieldIds={},this._fieldLength={},this._averageFieldLength={},this._nextId=0,this._storedFields={},this.addFields(this._options.fields)}var I=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0},S=((o={}).or=function(e,t){return Object.entries(t).reduce(function(e,t){var t=h(t,2),n=t[0],t=t[1],r=t.score,o=t.match,t=t.terms;return null==e[n]?e[n]={score:r,match:o,terms:t}:(e[n].score+=r,e[n].score*=1.5,(r=e[n].terms).push.apply(r,a([],h(t),!1)),Object.assign(e[n].match,o)),e},e||{})},o.and=function(i,e){return Object.entries(e).reduce(function(e,t){var t=h(t,2),n=t[0],t=t[1],r=t.score,o=t.match,t=t.terms;return void 0===i[n]||(e[n]=e[n]||{},e[n].score=i[n].score+r,e[n].match=l(l({},i[n].match),o),e[n].terms=a(a([],h(i[n].terms),!1),h(t),!1)),e},{})},o.and_not=function(e,t){return Object.entries(t).reduce(function(e,t){var t=h(t,2),n=t[0],t=t[1];return t.score,t.match,t.terms,delete e[n],e},e||{})},o),E=function(e,t,n,r,o,i){return o/(1+.333*o*i)*(e*Math.log(n/t))/r},A=function(r){return function(e,t,n){return{term:e,fuzzy:"function"==typeof r.fuzzy?r.fuzzy(e,t,n):r.fuzzy||!1,prefix:"function"==typeof r.prefix?r.prefix(e,t,n):!0===r.prefix}}},$=function(e){return e.filter(function(e,t,n){return n.indexOf(e)===t})},C={idField:"id",extractField:function(e,t){return e[t]},tokenize:function(e,t){return e.split(T)},processTerm:function(e,t){return e.toLowerCase()},fields:void 0,searchOptions:void 0,storeFields:[]},O={combineWith:"or",prefix:!1,fuzzy:!1,maxFuzzy:6,boost:{},weights:{fuzzy:.9,prefix:.75}},F={prefix:function(e,t,n){return t===n.length-1}},T=/[\n\r -#%-*,-/:;?@[-\]_{}\u00A0\u00A1\u00A7\u00AB\u00B6\u00B7\u00BB\u00BF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u1680\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2000-\u200A\u2010-\u2029\u202F-\u2043\u2045-\u2051\u2053-\u205F\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u3000-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]+/u;return _},"object"==typeof n&&void 0!==t?t.exports=o():"function"==typeof define&&define.amd?define(o):(r="undefined"!=typeof globalThis?globalThis:r||self).MiniSearch=o()},{}],58:[function(e,o,i){!function(Dt){!function(){var e,t,n,r;e=this,t=function(){var e="object"==typeof self&&self.self===self&&self||"object"==typeof Dt&&Dt.global===Dt&&Dt||Function("return this")()||{},r=Array.prototype,D=Object.prototype,P="undefined"!=typeof Symbol?Symbol.prototype:null,N=r.push,s=r.slice,f=D.toString,M=D.hasOwnProperty,t="undefined"!=typeof ArrayBuffer,n="undefined"!=typeof DataView,B=Array.isArray,z=Object.keys,U=Object.create,q=t&&ArrayBuffer.isView,K=isNaN,W=isFinite,H=!{toString:null}.propertyIsEnumerable("toString"),J=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],G=Math.pow(2,53)-1;function l(o,i){return i=null==i?o.length-1:+i,function(){for(var e=Math.max(arguments.length-i,0),t=Array(e),n=0;n<e;n++)t[n]=arguments[n+i];switch(i){case 0:return o.call(this,t);case 1:return o.call(this,arguments[0],t);case 2:return o.call(this,arguments[0],arguments[1],t)}for(var r=Array(i+1),n=0;n<i;n++)r[n]=arguments[n];return r[i]=t,o.apply(this,r)}}function i(e){var t=typeof e;return"function"==t||"object"==t&&!!e}function V(e){return void 0===e}function Y(e){return!0===e||!1===e||"[object Boolean]"===f.call(e)}function o(e){var t="[object "+e+"]";return function(e){return f.call(e)===t}}var Q=o("String"),X=o("Number"),a=o("Date"),Z=o("RegExp"),ee=o("Error"),te=o("Symbol"),ne=o("ArrayBuffer"),u=o("Function"),e=e.document&&e.document.childNodes,d=u="function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof e?function(e){return"function"==typeof e||!1}:u,e=o("Object"),re=n&&e(new DataView(new ArrayBuffer(8))),u="undefined"!=typeof Map&&e(new Map),n=o("DataView");var h=re?function(e){return null!=e&&d(e.getInt8)&&ne(e.buffer)}:n,p=B||o("Array");function g(e,t){return null!=e&&M.call(e,t)}var oe=o("Arguments"),ie=(!function(){oe(arguments)||(oe=function(e){return g(e,"callee")})}(),oe);function ae(e){return X(e)&&K(e)}function ue(e){return function(){return e}}function se(t){return function(e){e=t(e);return"number"==typeof e&&0<=e&&e<=G}}function ce(t){return function(e){return null==e?void 0:e[t]}}var v=ce("byteLength"),le=se(v),fe=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/;var de=t?function(e){return q?q(e)&&!h(e):le(e)&&fe.test(f.call(e))}:ue(!1),m=ce("length");function he(e,t){t=function(t){for(var n={},e=t.length,r=0;r<e;++r)n[t[r]]=!0;return{contains:function(e){return!0===n[e]},push:function(e){return n[e]=!0,t.push(e)}}}(t);var n=J.length,r=e.constructor,o=d(r)&&r.prototype||D,i="constructor";for(g(e,i)&&!t.contains(i)&&t.push(i);n--;)(i=J[n])in e&&e[i]!==o[i]&&!t.contains(i)&&t.push(i)}function y(e){if(!i(e))return[];if(z)return z(e);var t,n=[];for(t in e)g(e,t)&&n.push(t);return H&&he(e,n),n}function pe(e,t){var n=y(t),r=n.length;if(null==e)return!r;for(var o=Object(e),i=0;i<r;i++){var a=n[i];if(t[a]!==o[a]||!(a in o))return!1}return!0}function b(e){return e instanceof b?e:this instanceof b?void(this._wrapped=e):new b(e)}function ge(e){return new Uint8Array(e.buffer||e,e.byteOffset||0,v(e))}b.VERSION="1.13.2",b.prototype.valueOf=b.prototype.toJSON=b.prototype.value=function(){return this._wrapped},b.prototype.toString=function(){return String(this._wrapped)};var ve="[object DataView]";function me(e,t,n,r){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return!1;if(e!=e)return t!=t;var o=typeof e;return("function"==o||"object"==o||"object"==typeof t)&&function e(t,n,r,o){t instanceof b&&(t=t._wrapped);n instanceof b&&(n=n._wrapped);var i=f.call(t);if(i!==f.call(n))return!1;if(re&&"[object Object]"==i&&h(t)){if(!h(n))return!1;i=ve}switch(i){case"[object RegExp]":case"[object String]":return""+t==""+n;case"[object Number]":return+t!=+t?+n!=+n:0==+t?1/+t==1/n:+t==+n;case"[object Date]":case"[object Boolean]":return+t==+n;case"[object Symbol]":return P.valueOf.call(t)===P.valueOf.call(n);case"[object ArrayBuffer]":case ve:return e(ge(t),ge(n),r,o)}i="[object Array]"===i;if(!i&&de(t)){var a=v(t);if(a!==v(n))return!1;if(t.buffer===n.buffer&&t.byteOffset===n.byteOffset)return!0;i=!0}if(!i){if("object"!=typeof t||"object"!=typeof n)return!1;var a=t.constructor,u=n.constructor;if(a!==u&&!(d(a)&&a instanceof a&&d(u)&&u instanceof u)&&"constructor"in t&&"constructor"in n)return!1}r=r||[];o=o||[];var s=r.length;for(;s--;)if(r[s]===t)return o[s]===n;r.push(t);o.push(n);if(i){if((s=t.length)!==n.length)return!1;for(;s--;)if(!me(t[s],n[s],r,o))return!1}else{var c,l=y(t);if(s=l.length,y(n).length!==s)return!1;for(;s--;)if(c=l[s],!g(n,c)||!me(t[c],n[c],r,o))return!1}r.pop();o.pop();return!0}(e,t,n,r)}function c(e){if(!i(e))return[];var t,n=[];for(t in e)n.push(t);return H&&he(e,n),n}function ye(r){var o=m(r);return function(e){if(null==e)return!1;var t=c(e);if(m(t))return!1;for(var n=0;n<o;n++)if(!d(e[r[n]]))return!1;return r!==we||!d(e[be])}}var be="forEach",e=["clear","delete"],n=["get","has","set"],B=e.concat(be,n),we=e.concat(n),t=["add"].concat(e,be,"has"),n=u?ye(B):o("Map"),e=u?ye(we):o("WeakMap"),B=u?ye(t):o("Set"),u=o("WeakSet");function w(e){for(var t=y(e),n=t.length,r=Array(n),o=0;o<n;o++)r[o]=e[t[o]];return r}function xe(e){for(var t={},n=y(e),r=0,o=n.length;r<o;r++)t[e[n[r]]]=n[r];return t}function ke(e){var t,n=[];for(t in e)d(e[t])&&n.push(t);return n.sort()}function _e(s,c){return function(e){var t=arguments.length;if(c&&(e=Object(e)),t<2||null==e)return e;for(var n=1;n<t;n++)for(var r=arguments[n],o=s(r),i=o.length,a=0;a<i;a++){var u=o[a];c&&void 0!==e[u]||(e[u]=r[u])}return e}}var je=_e(c),x=_e(y),Ie=_e(c,!0);function Se(e){if(!i(e))return{};if(U)return U(e);var t=function(){},e=(t.prototype=e,new t);return t.prototype=null,e}function Ee(e){return p(e)?e:[e]}function k(e){return b.toPath(e)}function Ae(e,t){for(var n=t.length,r=0;r<n;r++){if(null==e)return;e=e[t[r]]}return n?e:void 0}function $e(e,t,n){e=Ae(e,k(t));return V(e)?n:e}function Ce(e){return e}function _(t){return t=x({},t),function(e){return pe(e,t)}}function Oe(t){return t=k(t),function(e){return Ae(e,t)}}function j(o,i,e){if(void 0===i)return o;switch(null==e?3:e){case 1:return function(e){return o.call(i,e)};case 3:return function(e,t,n){return o.call(i,e,t,n)};case 4:return function(e,t,n,r){return o.call(i,e,t,n,r)}}return function(){return o.apply(i,arguments)}}function Fe(e,t,n){return null==e?Ce:d(e)?j(e,t,n):(i(e)&&!p(e)?_:Oe)(e)}function Te(e,t){return Fe(e,t,1/0)}function I(e,t,n){return b.iteratee!==Te?b.iteratee(e,t):Fe(e,t,n)}function Le(){}function Re(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))}b.toPath=Ee,b.iteratee=Te;var S=Date.now||function(){return(new Date).getTime()};function De(t){function n(e){return t[e]}var e="(?:"+y(t).join("|")+")",r=RegExp(e),o=RegExp(e,"g");return function(e){return r.test(e=null==e?"":""+e)?e.replace(o,n):e}}var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},Pe=De(t),t=De(xe(t)),Ne=b.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},Me=/(.)^/,Be={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},ze=/\\|'|\r|\n|\u2028|\u2029/g;function Ue(e){return"\\"+Be[e]}var qe=/^\s*(\w|\$)+\s*$/;var Ke=0;function We(e,t,n,r,o){if(!(r instanceof t))return e.apply(n,o);r=Se(e.prototype),t=e.apply(r,o);return i(t)?t:r}var E=l(function(o,i){function a(){for(var e=0,t=i.length,n=Array(t),r=0;r<t;r++)n[r]=i[r]===u?arguments[e++]:i[r];for(;e<arguments.length;)n.push(arguments[e++]);return We(o,a,this,this,n)}var u=E.placeholder;return a}),He=(E.placeholder=b,l(function(t,n,r){if(!d(t))throw new TypeError("Bind must be called on a function");var o=l(function(e){return We(t,o,n,this,r.concat(e))});return o})),A=se(m);function $(e,t,n,r){if(r=r||[],t||0===t){if(t<=0)return r.concat(e)}else t=1/0;for(var o=r.length,i=0,a=m(e);i<a;i++){var u=e[i];if(A(u)&&(p(u)||ie(u)))if(1<t)$(u,t-1,n,r),o=r.length;else for(var s=0,c=u.length;s<c;)r[o++]=u[s++];else n||(r[o++]=u)}return r}var Je=l(function(e,t){var n=(t=$(t,!1,!1)).length;if(n<1)throw new Error("bindAll must be passed function names");for(;n--;){var r=t[n];e[r]=He(e[r],e)}return e});var Ge=l(function(e,t,n){return setTimeout(function(){return e.apply(null,n)},t)}),Ve=E(Ge,b,1);function Ye(e){return function(){return!e.apply(this,arguments)}}function Qe(e,t){var n;return function(){return 0<--e&&(n=t.apply(this,arguments)),e<=1&&(t=null),n}}var Xe=E(Qe,2);function Ze(e,t,n){t=I(t,n);for(var r,o=y(e),i=0,a=o.length;i<a;i++)if(t(e[r=o[i]],r,e))return r}function et(i){return function(e,t,n){t=I(t,n);for(var r=m(e),o=0<i?0:r-1;0<=o&&o<r;o+=i)if(t(e[o],o,e))return o;return-1}}var tt=et(1),nt=et(-1);function rt(e,t,n,r){for(var o=(n=I(n,r,1))(t),i=0,a=m(e);i<a;){var u=Math.floor((i+a)/2);n(e[u])<o?i=u+1:a=u}return i}function ot(i,a,u){return function(e,t,n){var r=0,o=m(e);if("number"==typeof n)0<i?r=0<=n?n:Math.max(n+o,r):o=0<=n?Math.min(n+1,o):n+o+1;else if(u&&n&&o)return e[n=u(e,t)]===t?n:-1;if(t!=t)return 0<=(n=a(s.call(e,r,o),ae))?n+r:-1;for(n=0<i?r:o-1;0<=n&&n<o;n+=i)if(e[n]===t)return n;return-1}}var it=ot(1,tt,rt),at=ot(-1,nt);function ut(e,t,n){t=(A(e)?tt:Ze)(e,t,n);if(void 0!==t&&-1!==t)return e[t]}function C(e,t,n){if(t=j(t,n),A(e))for(o=0,i=e.length;o<i;o++)t(e[o],o,e);else for(var r=y(e),o=0,i=r.length;o<i;o++)t(e[r[o]],r[o],e);return e}function O(e,t,n){t=I(t,n);for(var r=!A(e)&&y(e),o=(r||e).length,i=Array(o),a=0;a<o;a++){var u=r?r[a]:a;i[a]=t(e[u],u,e)}return i}function st(d){return function(e,t,n,r){var o=3<=arguments.length,i=e,a=j(t,r,4),u=n,s=!A(i)&&y(i),c=(s||i).length,l=0<d?0:c-1;for(o||(u=i[s?s[l]:l],l+=d);0<=l&&l<c;l+=d){var f=s?s[l]:l;u=a(u,i[f],f,i)}return u}}var ct=st(1),lt=st(-1);function F(e,r,t){var o=[];return r=I(r,t),C(e,function(e,t,n){r(e,t,n)&&o.push(e)}),o}function ft(e,t,n){t=I(t,n);for(var r=!A(e)&&y(e),o=(r||e).length,i=0;i<o;i++){var a=r?r[i]:i;if(!t(e[a],a,e))return!1}return!0}function dt(e,t,n){t=I(t,n);for(var r=!A(e)&&y(e),o=(r||e).length,i=0;i<o;i++){var a=r?r[i]:i;if(t(e[a],a,e))return!0}return!1}function T(e,t,n,r){return A(e)||(e=w(e)),0<=it(e,t,n="number"==typeof n&&!r?n:0)}var ht=l(function(e,n,r){var o,i;return d(n)?i=n:(n=k(n),o=n.slice(0,-1),n=n[n.length-1]),O(e,function(e){var t=i;if(!t){if(null==(e=o&&o.length?Ae(e,o):e))return;t=e[n]}return null==t?t:t.apply(e,r)})});function pt(e,t){return O(e,Oe(t))}function gt(e,r,t){var n,o,i=-1/0,a=-1/0;if(null==r||"number"==typeof r&&"object"!=typeof e[0]&&null!=e)for(var u=0,s=(e=A(e)?e:w(e)).length;u<s;u++)null!=(n=e[u])&&i<n&&(i=n);else r=I(r,t),C(e,function(e,t,n){o=r(e,t,n),(a<o||o===-1/0&&i===-1/0)&&(i=e,a=o)});return i}var vt=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function mt(e){return e?p(e)?s.call(e):Q(e)?e.match(vt):A(e)?O(e,Ce):w(e):[]}function yt(e,t,n){if(null==t||n)return(e=A(e)?e:w(e))[Re(e.length-1)];for(var r=mt(e),n=m(r),o=(t=Math.max(Math.min(t,n),0),n-1),i=0;i<t;i++){var a=Re(i,o),u=r[i];r[i]=r[a],r[a]=u}return r.slice(0,t)}function L(i,t){return function(n,r,e){var o=t?[[],[]]:{};return r=I(r,e),C(n,function(e,t){t=r(e,t,n);i(o,e,t)}),o}}var bt=L(function(e,t,n){g(e,n)?e[n].push(t):e[n]=[t]}),wt=L(function(e,t,n){e[n]=t}),xt=L(function(e,t,n){g(e,n)?e[n]++:e[n]=1}),kt=L(function(e,t,n){e[n?0:1].push(t)},!0);function _t(e,t,n){return t in n}var jt=l(function(e,t){var n={},r=t[0];if(null==e)return n;d(r)?(1<t.length&&(r=j(r,t[1])),t=c(e)):(r=_t,t=$(t,!1,!1),e=Object(e));for(var o=0,i=t.length;o<i;o++){var a=t[o],u=e[a];r(u,a,e)&&(n[a]=u)}return n}),It=l(function(e,n){var t,r=n[0];return d(r)?(r=Ye(r),1<n.length&&(t=n[1])):(n=O($(n,!1,!1),String),r=function(e,t){return!T(n,t)}),jt(e,r,t)});function St(e,t,n){return s.call(e,0,Math.max(0,e.length-(null==t||n?1:t)))}function Et(e,t,n){return null==e||e.length<1?null==t||n?void 0:[]:null==t||n?e[0]:St(e,e.length-t)}function R(e,t,n){return s.call(e,null==t||n?1:t)}var At=l(function(e,t){return t=$(t,!0,!0),F(e,function(e){return!T(t,e)})}),$t=l(function(e,t){return At(e,t)});function Ct(e,t,n,r){Y(t)||(r=n,n=t,t=!1),null!=n&&(n=I(n,r));for(var o=[],i=[],a=0,u=m(e);a<u;a++){var s=e[a],c=n?n(s,a,e):s;t&&!n?(a&&i===c||o.push(s),i=c):n?T(i,c)||(i.push(c),o.push(s)):T(o,s)||o.push(s)}return o}var Ot=l(function(e){return Ct($(e,!0,!0))});function Ft(e){for(var t=e&&gt(e,m).length||0,n=Array(t),r=0;r<t;r++)n[r]=pt(e,r);return n}var Tt=l(Ft);function Lt(e,t){return e._chain?b(t).chain():t}function Rt(n){return C(ke(n),function(e){var t=b[e]=n[e];b.prototype[e]=function(){var e=[this._wrapped];return N.apply(e,arguments),Lt(this,t.apply(b,e))}}),b}C(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var n=r[t];b.prototype[t]=function(){var e=this._wrapped;return null!=e&&(n.apply(e,arguments),"shift"!==t&&"splice"!==t||0!==e.length||delete e[0]),Lt(this,e)}}),C(["concat","join","slice"],function(e){var t=r[e];b.prototype[e]=function(){var e=this._wrapped;return Lt(this,e=null!=e?t.apply(e,arguments):e)}});a=Rt({__proto__:null,VERSION:"1.13.2",restArguments:l,isObject:i,isNull:function(e){return null===e},isUndefined:V,isBoolean:Y,isElement:function(e){return!(!e||1!==e.nodeType)},isString:Q,isNumber:X,isDate:a,isRegExp:Z,isError:ee,isSymbol:te,isArrayBuffer:ne,isDataView:h,isArray:p,isFunction:d,isArguments:ie,isFinite:function(e){return!te(e)&&W(e)&&!isNaN(parseFloat(e))},isNaN:ae,isTypedArray:de,isEmpty:function(e){if(null==e)return!0;var t=m(e);return"number"==typeof t&&(p(e)||Q(e)||ie(e))?0===t:0===m(y(e))},isMatch:pe,isEqual:function(e,t){return me(e,t)},isMap:n,isWeakMap:e,isSet:B,isWeakSet:u,keys:y,allKeys:c,values:w,pairs:function(e){for(var t=y(e),n=t.length,r=Array(n),o=0;o<n;o++)r[o]=[t[o],e[t[o]]];return r},invert:xe,functions:ke,methods:ke,extend:je,extendOwn:x,assign:x,defaults:Ie,create:function(e,t){return e=Se(e),t&&x(e,t),e},clone:function(e){return i(e)?p(e)?e.slice():je({},e):e},tap:function(e,t){return t(e),e},get:$e,has:function(e,t){for(var n=(t=k(t)).length,r=0;r<n;r++){var o=t[r];if(!g(e,o))return!1;e=e[o]}return!!n},mapObject:function(e,t,n){t=I(t,n);for(var r=y(e),o=r.length,i={},a=0;a<o;a++){var u=r[a];i[u]=t(e[u],u,e)}return i},identity:Ce,constant:ue,noop:Le,toPath:Ee,property:Oe,propertyOf:function(t){return null==t?Le:function(e){return $e(t,e)}},matcher:_,matches:_,times:function(e,t,n){var r=Array(Math.max(0,e));t=j(t,n,1);for(var o=0;o<e;o++)r[o]=t(o);return r},random:Re,now:S,escape:Pe,unescape:t,templateSettings:Ne,template:function(i,e,t){e=Ie({},e=!e&&t?t:e,b.templateSettings);var n,t=RegExp([(e.escape||Me).source,(e.interpolate||Me).source,(e.evaluate||Me).source].join("|")+"|$","g"),a=0,u="__p+='";if(i.replace(t,function(e,t,n,r,o){return u+=i.slice(a,o).replace(ze,Ue),a=o+e.length,t?u+="'+\n((__t=("+t+"))==null?'':_.escape(__t))+\n'":n?u+="'+\n((__t=("+n+"))==null?'':__t)+\n'":r&&(u+="';\n"+r+"\n__p+='"),e}),u+="';\n",t=e.variable){if(!qe.test(t))throw new Error("variable is not a bare identifier: "+t)}else u="with(obj||{}){\n"+u+"}\n",t="obj";u="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+u+"return __p;\n";try{n=new Function(t,"_",u)}catch(e){throw e.source=u,e}function r(e){return n.call(this,e,b)}return r.source="function("+t+"){\n"+u+"}",r},result:function(e,t,n){var r=(t=k(t)).length;if(!r)return d(n)?n.call(e):n;for(var o=0;o<r;o++){var i=null==e?void 0:e[t[o]];void 0===i&&(i=n,o=r),e=d(i)?i.call(e):i}return e},uniqueId:function(e){var t=++Ke+"";return e?e+t:t},chain:function(e){return(e=b(e))._chain=!0,e},iteratee:Te,partial:E,bind:He,bindAll:Je,memoize:function(r,o){function i(e){var t=i.cache,n=""+(o?o.apply(this,arguments):e);return g(t,n)||(t[n]=r.apply(this,arguments)),t[n]}return i.cache={},i},delay:Ge,defer:Ve,throttle:function(n,r,o){function i(){l=!1===o.leading?0:S(),a=null,c=n.apply(u,s),a||(u=s=null)}function e(){var e=S(),t=(l||!1!==o.leading||(l=e),r-(e-l));return u=this,s=arguments,t<=0||r<t?(a&&(clearTimeout(a),a=null),l=e,c=n.apply(u,s),a||(u=s=null)):a||!1===o.trailing||(a=setTimeout(i,t)),c}var a,u,s,c,l=0;return o=o||{},e.cancel=function(){clearTimeout(a),l=0,a=u=s=null},e},debounce:function(t,n,r){function o(){var e=S()-a;e<n?i=setTimeout(o,n-e):(i=null,r||(s=t.apply(c,u)),i||(u=c=null))}var i,a,u,s,c,e=l(function(e){return c=this,u=e,a=S(),i||(i=setTimeout(o,n),r&&(s=t.apply(c,u))),s});return e.cancel=function(){clearTimeout(i),i=u=c=null},e},wrap:function(e,t){return E(t,e)},negate:Ye,compose:function(){var n=arguments,r=n.length-1;return function(){for(var e=r,t=n[r].apply(this,arguments);e--;)t=n[e].call(this,t);return t}},after:function(e,t){return function(){if(--e<1)return t.apply(this,arguments)}},before:Qe,once:Xe,findKey:Ze,findIndex:tt,findLastIndex:nt,sortedIndex:rt,indexOf:it,lastIndexOf:at,find:ut,detect:ut,findWhere:function(e,t){return ut(e,_(t))},each:C,forEach:C,map:O,collect:O,reduce:ct,foldl:ct,inject:ct,reduceRight:lt,foldr:lt,filter:F,select:F,reject:function(e,t,n){return F(e,Ye(I(t)),n)},every:ft,all:ft,some:dt,any:dt,contains:T,includes:T,include:T,invoke:ht,pluck:pt,where:function(e,t){return F(e,_(t))},max:gt,min:function(e,r,t){var n,o,i=1/0,a=1/0;if(null==r||"number"==typeof r&&"object"!=typeof e[0]&&null!=e)for(var u=0,s=(e=A(e)?e:w(e)).length;u<s;u++)null!=(n=e[u])&&n<i&&(i=n);else r=I(r,t),C(e,function(e,t,n){((o=r(e,t,n))<a||o===1/0&&i===1/0)&&(i=e,a=o)});return i},shuffle:function(e){return yt(e,1/0)},sample:yt,sortBy:function(e,r,t){var o=0;return r=I(r,t),pt(O(e,function(e,t,n){return{value:e,index:o++,criteria:r(e,t,n)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(r<n||void 0===n)return 1;if(n<r||void 0===r)return-1}return e.index-t.index}),"value")},groupBy:bt,indexBy:wt,countBy:xt,partition:kt,toArray:mt,size:function(e){return null==e?0:(A(e)?e:y(e)).length},pick:jt,omit:It,first:Et,head:Et,take:Et,initial:St,last:function(e,t,n){return null==e||e.length<1?null==t||n?void 0:[]:null==t||n?e[e.length-1]:R(e,Math.max(0,e.length-t))},rest:R,tail:R,drop:R,compact:function(e){return F(e,Boolean)},flatten:function(e,t){return $(e,t,!1)},without:$t,uniq:Ct,unique:Ct,union:Ot,intersection:function(e){for(var t=[],n=arguments.length,r=0,o=m(e);r<o;r++){var i=e[r];if(!T(t,i)){for(var a=1;a<n&&T(arguments[a],i);a++);a===n&&t.push(i)}}return t},difference:At,unzip:Ft,transpose:Ft,zip:Tt,object:function(e,t){for(var n={},r=0,o=m(e);r<o;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},range:function(e,t,n){null==t&&(t=e||0,e=0),n=n||(t<e?-1:1);for(var r=Math.max(Math.ceil((t-e)/n),0),o=Array(r),i=0;i<r;i++,e+=n)o[i]=e;return o},chunk:function(e,t){if(null==t||t<1)return[];for(var n=[],r=0,o=e.length;r<o;)n.push(s.call(e,r,r+=t));return n},mixin:Rt,default:b});return a._=a},"object"==typeof i&&void 0!==o?o.exports=t():"function"==typeof define&&define.amd?define("underscore",t):(e="undefined"!=typeof globalThis?globalThis:e||self,n=e._,(r=e._=t()).noConflict=function(){return e._=n,r})}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1]);
//# sourceMappingURL=client.map